!function(r,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var n=e();for(var t in n)("object"==typeof exports?exports:r)[t]=n[t]}}(self,(function(){return(()=>{var __webpack_modules__={144:(r,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>o});var t=n(477),i=n.n(t);function o(){return i()('(()=>{var __webpack_modules__={523:(r,n,e)=>{var t=e(38),i=e(359),o=e(482),u=e(746);r.exports=function(r){var n,e,c=r.lowChannel,a=r.heightChannel,f=r.wmBoolList,s=r.addHeight,m=r.addWidth,h=r.blockShape,l=f.length;(c=c.map((function(r){var t=o.strided4(r,h);return n=t.fullRowNun,e=t.fullColumnNun,t.result}))).forEach((function(r){for(var t=0,o=0;o<n;o++)for(var u=0;u<e;u++){var c=r[o][u],a=f[t%l];t++,r[o][u]=i.encode(c,a)}}));var p=c.map((function(r,n){var e=o.spreadStrided4(r),t=u.idwt(e,a[n]);return s&&t.pop(),m&&t.forEach((function(r){return r.pop()})),t})),d=t(p,3),g=d[0],v=d[1],y=d[2];return Promise.resolve([g,v,y])}},295:(r,n,e)=>{var t=e(319);r.exports=function(){for(var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0,e=t(r),i=[],o=0,u=e.length;o<u;o+=n){var c=r.slice(o,o+n);c.length&&i.push(c)}return i}},473:(r,n,e)=>{var t=e(319);r.exports={transform:function(r){if(!r||!r[0]||void 0===r[0][0])return Promise.reject("二维矩阵不合法");for(var n=r.length,e=r[0].length,t=[],i=0;i<n;i++)for(var o=0;o<e;o++)t[o]||(t[o]=[]),t[o][i]=r[i][o];return t},diag:function(r){var n=r.length,e=new Array(n).fill(0),i=[];return r.forEach((function(r,n){var o=t(e);o[n]=r,i.push(o)})),i},dot:function(r,n){if(r[0].length!==n.length)return Promise.reject("矩阵不匹配，无法点乘");for(var e=r.length,t=r[0].length,i=n[0].length,o=new Array(e).fill(0).map((function(r){return new Array(i).fill(0)})),u=0;u<e;u++)for(var c=0;c<i;c++)for(var a=0;a<t;a++)o[u][c]+=r[u][a]*n[a][c];return o}}},359:(r,n,e)=>{var t=e(32),i=e(473),o=i.diag,u=i.dot,c=i.transform,a=function(r,n,e){return(Math.floor(r/n)+.25+.5*Number(e))*n},f=function(r){var n=0;return function r(e){e.forEach((function(e){Array.isArray(e)?r(e):n+=e}))}(r),n},s=function(r){for(var n=t.svd(r),e=n.U,i=n.S,o=n.V,u=r.length,c=r[0].length,a=0,f=0,s=function(){if(++f>=c&&(f=0,a++),a>=u)return Promise.reject("bad matrix case")};i.includes(NaN);){r[a][f]=Math.round(r[a][f]);var m=t.svd(r);e=m.U,i=m.S,o=m.V,s()}return{U:e,S:i,V:o}};r.exports={encode:function(r){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],e=s(r),t=e.U,i=e.S,f=e.V;return i[0]=a(i[0],20,n),i[1]=a(i[1],6,n),u(t,u(o(i),c(f)))},decode:function(r){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5,e=f(r)/(r.length*r[0].length);if(e>360)return n;var t=s(r),i=t.S,o=Number(i[0]%20>10),u=Number(i[1]%6>3);return(3*o+u)/4}}},746:(r,n,e)=>{var t=e(38),i=e(627);r.exports={dwt:function(r){if(!r||void 0===r[0]||void 0===r[0][0])return Promise.reject("private wt need 2d array");var n=[],e=[];return r.forEach((function(r){var o,u,c,a,f,s;i.dwt?(o=i.dwt(r,"haar"),f=(u=t(o,2))[0],s=u[1]):(c=i.default.dwt(r,"haar"),f=(a=t(c,2))[0],s=a[1]),n.push(f),e.push(s)})),[n,e]},idwt:function(r,n){return r&&n?r.length!==n.length?Promise.reject("请输入长度相同且合法的低频、高频分量"):r.map((function(r,e){return i.idwt?i.idwt(r,n[e],"haar"):i.default.idwt(r,n[e],"haar")})):Promise.reject("请输入低频、高频分量")}}},482:(r,n,e)=>{var t=e(319),i=e(295);r.exports={strided4:function(r){for(var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,e=r[0].length,t=r.length,o=(Math.ceil(e/n),Math.ceil(t/n)),u=Math.floor(e/n),c=Math.floor(t/n),a=[],f=function(e){for(var t=[],o=n*e,u=0;u<n;u++)r[o+u]&&i(r[o+u],n).forEach((function(r,n){t[n]||(t[n]=[]),t[n].push(r)}));a.push(t)},s=0;s<o;s++)f(s);return{fullRowNun:c,fullColumnNun:u,result:a}},spreadStrided4:function(r){var n=[];return r.forEach((function(r,e){var i=[];r.forEach((function(r,n){r.forEach((function(r,n){i[n]||(i[n]=[]),i[n]=[].concat(t(i[n]),t(r))}))})),n=[].concat(t(n),i)})),n}}},311:(r,n,e)=>{var t=e(523);onmessage=function(r){var n=r.data;t(n).then((function(r){postMessage(r)}))},r.exports=onmessage},228:r=>{r.exports=function(r,n){(null==n||n>r.length)&&(n=r.length);for(var e=0,t=new Array(n);e<n;e++)t[e]=r[e];return t},r.exports.default=r.exports,r.exports.__esModule=!0},858:r=>{r.exports=function(r){if(Array.isArray(r))return r},r.exports.default=r.exports,r.exports.__esModule=!0},646:(r,n,e)=>{var t=e(228);r.exports=function(r){if(Array.isArray(r))return t(r)},r.exports.default=r.exports,r.exports.__esModule=!0},860:r=>{r.exports=function(r){if("undefined"!=typeof Symbol&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r)},r.exports.default=r.exports,r.exports.__esModule=!0},884:r=>{r.exports=function(r,n){var e=r&&("undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"]);if(null!=e){var t,i,o=[],u=!0,c=!1;try{for(e=e.call(r);!(u=(t=e.next()).done)&&(o.push(t.value),!n||o.length!==n);u=!0);}catch(r){c=!0,i=r}finally{try{u||null==e.return||e.return()}finally{if(c)throw i}}return o}},r.exports.default=r.exports,r.exports.__esModule=!0},521:r=>{r.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},r.exports.default=r.exports,r.exports.__esModule=!0},206:r=>{r.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},r.exports.default=r.exports,r.exports.__esModule=!0},38:(r,n,e)=>{var t=e(858),i=e(884),o=e(379),u=e(521);r.exports=function(r,n){return t(r)||i(r,n)||o(r,n)||u()},r.exports.default=r.exports,r.exports.__esModule=!0},319:(r,n,e)=>{var t=e(646),i=e(860),o=e(379),u=e(206);r.exports=function(r){return t(r)||i(r)||o(r)||u()},r.exports.default=r.exports,r.exports.__esModule=!0},379:(r,n,e)=>{var t=e(228);r.exports=function(r,n){if(r){if("string"==typeof r)return t(r,n);var e=Object.prototype.toString.call(r).slice(8,-1);return"Object"===e&&r.constructor&&(e=r.constructor.name),"Map"===e||"Set"===e?Array.from(r):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?t(r,n):void 0}},r.exports.default=r.exports,r.exports.__esModule=!0},627:(r,n,e)=>{"use strict";e.r(n),e.d(n,{default:()=>V});var t="symmetric";function i(r,n,e){if(void 0===e&&(e=!1),0===r.length)throw new Error("Cannot determine symmetric padding for data of zero length.");var t=Math.floor(n/r.length);return(e?t:t+1)%2==0?r[n%r.length]:r[r.length-1-n%r.length]}var o="antisymmetric",u="constant",c="periodic",a="reflect",f="smooth",s="zero",m={antisymmetric:o,constant:u,periodic:c,reflect:a,smooth:f,symmetric:t,zero:s,modes:[s,u,t,c,f,a,o]},h=[1/Math.SQRT2,1/Math.SQRT2],l=[(1+Math.sqrt(3))/(4*Math.SQRT2),(3+Math.sqrt(3))/(4*Math.SQRT2),(3-Math.sqrt(3))/(4*Math.SQRT2),(1-Math.sqrt(3))/(4*Math.SQRT2)],p=[.33267055295008263,.8068915093110925,.45987750211849154,-.13501102001025458,-.08544127388202666,.03522629188570953],d=[.2303778133088965,.7148465705529157,.6308807679298589,-.027983769416859854,-.18703481171909309,.030841381835560764,.0328830116668852,-.010597401785069032],g=[.16010239797419293,.6038292697971896,.7243085284377729,.13842814590132074,-.24229488706638203,-.032244869584638375,.07757149384004572,-.006241490212798274,-.012580751999081999,.0033357252854737712],v=[.11154074335010947,.49462389039845306,.7511339080210954,.31525035170919763,-.22626469396543983,-.12976686756726194,.09750160558732304,.027522865530305727,-.03158203931748603,.0005538422011614961,.004777257510945511,-.0010773010853084796],y=[.07785205408500918,.3965393194819173,.7291320908462351,.4697822874051931,-.14390600392856498,-.22403618499387498,.07130921926683026,.08061260915108308,-.03802993693501441,-.01657454163066688,.01255099855609984,.0004295779729213665,-.0018016407040474908,.00035371379997452024],x=[.05441584224310401,.31287159091429995,.6756307362972898,.5853546836542067,-.015829105256349306,-.2840155429615469,.0004724845739132828,.12874742662047847,-.017369301001807547,-.044088253930794755,.013981027917398282,.008746094047405777,-.004870352993451574,-.00039174037337694705,.0006754494064505693,-.00011747678412476953],w=[.038077947363878345,.24383467461259034,.6048231236901112,.6572880780513005,.13319738582500756,-.2932737832791749,-.09684078322297646,.14854074933810638,.03072568147933338,-.06763282906132997,.00025094711483145197,.022361662123679096,-.004723204757751397,-.00428150368246343,.0018476468830562265,.00023038576352319597,-.0002519631889427101,393473203162716e-19],b=[.026670057900555554,.1881768000776915,.5272011889317256,.6884590394536035,.2811723436605775,-.24984642432731538,-.19594627437737705,.12736934033579325,.09305736460357235,-.07139414716639708,-.029457536821875813,.033212674059341,.0036065535669561697,-.010733175483330575,.001395351747052901,.001992405295185056,-.0006858566949597116,-.00011646685512928545,9358867032006959e-20,-13264202894521244e-21],_={db1:h,db2:l,db3:p,db4:d,db5:g,db6:v,db7:y,db8:x,db9:w,db10:b,D2:h,D4:l,D6:p,D8:d,D10:g,D12:v,D14:y,D16:x,D18:w,D20:b,haar:h};function M(r,n){if(r.length!==n.length)throw new Error("Both arrays have to have the same length.");return r.map((function(r,e){return r+n[e]}))}function k(r){if(r.high.length!==r.low.length)throw new Error("High-pass and low-pass filters have to have equal length.");if(r.low.length<2)throw new Error("Wavelet filter length has to be larger than or equal to two.");return!0}function A(r){return"string"!=typeof r?r:function(r){if(r.length<2)throw new Error("Scaling numbers length has to be larger than or equal to two.");var n=r.slice().reverse().map((function(r,n){return n%2==0?r:-r}));return{dec:{low:r.slice(),high:n.slice()},rec:{low:r.slice(),high:n.slice()}}}(_[r])}function j(r,n){if(void 0===n&&(n=0),!Number.isInteger(r))throw new Error("Length has to be an integer.");if(r<0)throw new Error("Length must not be smaller than zero.");return Array.apply(null,Array(r)).map((function(r,e){return"function"==typeof n?n(e):n}))}function T(r,n){if(r.length!==n.length)throw new Error("Both arrays have to have the same length.");return r.reduce((function(r,e,t){return r+e*n[t]}),0)}function S(r,n){return n.map((function(n){return r*n}))}function q(r,n,e,t){switch(t){case m.antisymmetric:return function(r,n,e){return void 0===e&&(e=!1),(Math.floor(n/r.length)%2==0?-1:1)*i(r,n,e)}(r,n,e);case m.constant:return function(r,n){if(void 0===n&&(n=!1),0===r.length)throw new Error("Cannot determine constant padding for data of zero length.");return n?r[0]:r[r.length-1]}(r,e);case m.periodic:return function(r,n,e){if(void 0===e&&(e=!1),0===r.length)throw new Error("Cannot determine periodic padding for data of zero length.");return e?r[r.length-1-n%r.length]:r[n%r.length]}(r,n,e);case m.reflect:return function(r,n,e){if(void 0===e&&(e=!1),0===r.length)throw new Error("Cannot determine reflect padding for data of zero length.");if(1===r.length)return r[0];var t=Math.floor(n/(r.length-1));return(e?t:t+1)%2==0?r[n%(r.length-1)+1]:r[r.length-2-n%(r.length-1)]}(r,n,e);case m.smooth:return function(r,n,e){if(void 0===e&&(e=!1),0===r.length)throw new Error("Cannot determine smooth padding for data of zero length.");var t=r.length-1;return(e?r[0]:r[t])+(n+1)*(e?1===r.length?r[0]:r[0]-r[1]:1===r.length?-r[0]:r[t]-r[t-1])}(r,n,e);case m.symmetric:return i(r,n,e);case m.zero:return 0;default:throw new Error(\'Unknown signal extension mode: "\'+t+\'"\')}}var P=m.symmetric;const V=function(){function r(){}return r.dwt=function(r,n,e){void 0===e&&(e=P);var t=A(n).dec;k(t);var i=t.low.length;r=this.pad(r,function(r,n){if(r<=0)throw new Error("Cannot determine padding widths for data of length less than or equal to zero.");if(n<2)throw new Error("Cannot determine padding widths for filter of length less than two.");return[n-2,(r+n)%2==0?n-2:n-1]}(r.length,i),e);for(var o=[],u=[],c=0;c+i<=r.length;c+=2){var a=r.slice(c,c+i);o.push(T(a,t.low)),u.push(T(a,t.high))}return[o,u]},r.energy=function(r){for(var n=0,e=0,t=r;e<t.length;e++){var i=t[e];n+="number"==typeof i?Math.pow(i,2):this.energy(i)}return n},r.idwt=function(r,n,e){if(void 0===r&&void 0!==n&&(r=j(n.length,0)),void 0===n&&void 0!==r&&(n=j(r.length,0)),void 0===r||void 0===n)throw new Error("Coefficients must not be undefined.");!function(r,n){if(r.length!==n.length)throw new Error("Approximation and detail coefficients must have equal length.");if(0===r.length)throw new Error("Approximation and detail coefficients must not have zero length.")}(r,n);var t=A(e).rec;k(t);for(var i=t.low.length,o=r.length,u=j(i+2*(o-1),0),c=0;c<o;c++){var a=2*c,f=u.slice(a,a+i);f=M(f,S(r[c],t.low)),f=M(f,S(n[c],t.high)),u=u.slice(0,a).concat(f).concat(u.slice(a+f.length))}return u.slice(i-2,u.length-(i-2))},r.maxLevel=function(r,n){if(!Number.isInteger(r))throw new Error("Length of data is not an integer. This is not allowed.");if(r<0)throw new Error("Data length cannot be less than zero.");if(0===r)return 0;var e=A(n).dec.low.length;return Math.max(0,Math.floor(Math.log2(r/(e-1))))},r.pad=function(r,n,e){if(!r)throw new Error("Cannot add padding to empty data.");var t=n[0],i=n[1];return j(t,(function(n){return q(r,t-1-n,!0,e)})).concat(r).concat(j(i,(function(n){return q(r,n,!1,e)})))},r.wavedec=function(r,n,e,t){if(void 0===e&&(e=P),void 0===t&&(t=this.maxLevel(r.length,n)),t<0)throw new Error("Decomposition level must not be less than zero");for(var i=[],o=r.slice(),u=1;u<=t;u++){var c=this.dwt(o,n,e);o=c[0];var a=c[1];i.unshift(a.slice())}return i.unshift(o.slice()),i},r.waverec=function(r,n){!function(r){if(r.length<1)throw new Error("Invalid coefficients. Array length must not be zero.")}(r),n=A(n);for(var e=r[0],t=1;t<r.length;t++){var i=r[t];e.length===i.length+1&&(e=e.slice(0,e.length-1)),e=this.idwt(e,i,n)}return e.slice()},r.Modes=m,r}()},32:(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";var numeric=exports;void 0!==__webpack_require__.g&&(__webpack_require__.g.numeric=numeric),numeric.version="1.2.6",numeric.bench=function(r,n){var e,t,i;for(void 0===n&&(n=15),t=.5,e=new Date;;){for(i=t*=2;i>3;i-=4)r(),r(),r(),r();for(;i>0;)r(),i--;if(new Date-e>n)break}for(i=t;i>3;i-=4)r(),r(),r(),r();for(;i>0;)r(),i--;return 1e3*(3*t-1)/(new Date-e)},numeric._myIndexOf=function(r){var n,e=this.length;for(n=0;n<e;++n)if(this[n]===r)return n;return-1},numeric.myIndexOf=Array.prototype.indexOf?Array.prototype.indexOf:numeric._myIndexOf,numeric.Function=Function,numeric.precision=4,numeric.largeArray=50,numeric.prettyPrint=function(r){function n(r){if(0===r)return"0";if(isNaN(r))return"NaN";if(r<0)return"-"+n(-r);if(isFinite(r)){var e=Math.floor(Math.log(r)/Math.log(10)),t=r/Math.pow(10,e),i=t.toPrecision(numeric.precision);return 10===parseFloat(i)&&(e++,i=(t=1).toPrecision(numeric.precision)),parseFloat(i).toString()+"e"+e.toString()}return"Infinity"}var e=[];return function r(t){var i;if(void 0===t)return e.push(Array(numeric.precision+8).join(" ")),!1;if("string"==typeof t)return e.push(\'"\'+t+\'"\'),!1;if("boolean"==typeof t)return e.push(t.toString()),!1;if("number"==typeof t){var o=n(t),u=t.toPrecision(numeric.precision),c=parseFloat(t.toString()).toString(),a=[o,u,c,parseFloat(u).toString(),parseFloat(c).toString()];for(i=1;i<a.length;i++)a[i].length<o.length&&(o=a[i]);return e.push(Array(numeric.precision+8-o.length).join(" ")+o),!1}if(null===t)return e.push("null"),!1;if("function"==typeof t){e.push(t.toString());var f=!1;for(i in t)t.hasOwnProperty(i)&&(f?e.push(",\\n"):e.push("\\n{"),f=!0,e.push(i),e.push(": \\n"),r(t[i]));return f&&e.push("}\\n"),!0}if(t instanceof Array){if(t.length>numeric.largeArray)return e.push("...Large Array..."),!0;for(f=!1,e.push("["),i=0;i<t.length;i++)i>0&&(e.push(","),f&&e.push("\\n ")),f=r(t[i]);return e.push("]"),!0}for(i in e.push("{"),f=!1,t)t.hasOwnProperty(i)&&(f&&e.push(",\\n"),f=!0,e.push(i),e.push(": \\n"),r(t[i]));return e.push("}"),!0}(r),e.join("")},numeric.parseDate=function(r){return function r(n){if("string"==typeof n)return Date.parse(n.replace(/-/g,"/"));if(!(n instanceof Array))throw new Error("parseDate: parameter must be arrays of strings");var e,t=[];for(e=0;e<n.length;e++)t[e]=r(n[e]);return t}(r)},numeric.parseFloat=function(r){return function r(n){if("string"==typeof n)return parseFloat(n);if(!(n instanceof Array))throw new Error("parseFloat: parameter must be arrays of strings");var e,t=[];for(e=0;e<n.length;e++)t[e]=r(n[e]);return t}(r)},numeric.parseCSV=function(r){var n,e,t,i=r.split("\\n"),o=[],u=/(([^\'",]*)|(\'[^\']*\')|("[^"]*")),/g,c=/^\\s*(([+-]?[0-9]+(\\.[0-9]*)?(e[+-]?[0-9]+)?)|([+-]?[0-9]*(\\.[0-9]+)?(e[+-]?[0-9]+)?))\\s*$/,a=0;for(e=0;e<i.length;e++){var f,s=(i[e]+",").match(u);if(s.length>0){for(o[a]=[],n=0;n<s.length;n++)f=(t=s[n]).substr(0,t.length-1),c.test(f)?o[a][n]=parseFloat(f):o[a][n]=f;a++}}return o},numeric.toCSV=function(r){var n,e,t,i,o,u=numeric.dim(r);for(t=u[0],u[1],o=[],n=0;n<t;n++){for(i=[],e=0;e<t;e++)i[e]=r[n][e].toString();o[n]=i.join(", ")}return o.join("\\n")+"\\n"},numeric.getURL=function(r){var n=new XMLHttpRequest;return n.open("GET",r,!1),n.send(),n},numeric.imageURL=function(r){function n(r,n,e){void 0===n&&(n=0),void 0===e&&(e=r.length);var t,i=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],o=-1;for(r.length,t=n;t<e;t++)o=o>>>8^i[255&(o^r[t])];return-1^o}var e,t,i,o,u,c,a,f,s,m,h=r[0].length,l=r[0][0].length,p=[137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,l>>24&255,l>>16&255,l>>8&255,255&l,h>>24&255,h>>16&255,h>>8&255,255&h,8,2,0,0,0,-1,-2,-3,-4,-5,-6,-7,-8,73,68,65,84,8,29];for(m=n(p,12,29),p[29]=m>>24&255,p[30]=m>>16&255,p[31]=m>>8&255,p[32]=255&m,e=1,t=0,a=0;a<h;a++){for(a<h-1?p.push(0):p.push(1),u=3*l+1+(0===a)&255,c=3*l+1+(0===a)>>8&255,p.push(u),p.push(c),p.push(255&~u),p.push(255&~c),0===a&&p.push(0),f=0;f<l;f++)for(i=0;i<3;i++)t=(t+(e=(e+(u=(u=r[i][a][f])>255?255:u<0?0:Math.round(u)))%65521))%65521,p.push(u);p.push(0)}return s=(t<<16)+e,p.push(s>>24&255),p.push(s>>16&255),p.push(s>>8&255),p.push(255&s),o=p.length-41,p[33]=o>>24&255,p[34]=o>>16&255,p[35]=o>>8&255,p[36]=255&o,m=n(p,37),p.push(m>>24&255),p.push(m>>16&255),p.push(m>>8&255),p.push(255&m),p.push(0),p.push(0),p.push(0),p.push(0),p.push(73),p.push(69),p.push(78),p.push(68),p.push(174),p.push(66),p.push(96),p.push(130),"data:image/png;base64,"+function(r){var n,e,t,i,o,u,c,a=r.length,f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",s="";for(n=0;n<a;n+=3)o=((3&(e=r[n]))<<4)+((t=r[n+1])>>4),u=((15&t)<<2)+((i=r[n+2])>>6),c=63&i,n+1>=a?u=c=64:n+2>=a&&(c=64),s+=f.charAt(e>>2)+f.charAt(o)+f.charAt(u)+f.charAt(c);return s}(p)},numeric._dim=function(r){for(var n=[];"object"==typeof r;)n.push(r.length),r=r[0];return n},numeric.dim=function(r){var n;return"object"==typeof r?"object"==typeof(n=r[0])?"object"==typeof n[0]?numeric._dim(r):[r.length,n.length]:[r.length]:[]},numeric.mapreduce=function(r,n){return Function("x","accum","_s","_k",\'if(typeof accum === "undefined") accum = \'+n+\';\\nif(typeof x === "number") { var xi = x; \'+r+\'; return accum; }\\nif(typeof _s === "undefined") _s = numeric.dim(x);\\nif(typeof _k === "undefined") _k = 0;\\nvar _n = _s[_k];\\nvar i,xi;\\nif(_k < _s.length-1) {\\n    for(i=_n-1;i>=0;i--) {\\n        accum = arguments.callee(x[i],accum,_s,_k+1);\\n    }    return accum;\\n}\\nfor(i=_n-1;i>=1;i-=2) { \\n    xi = x[i];\\n    \'+r+";\\n    xi = x[i-1];\\n    "+r+";\\n}\\nif(i === 0) {\\n    xi = x[i];\\n    "+r+"\\n}\\nreturn accum;")},numeric.mapreduce2=function(r,n){return Function("x","var n = x.length;\\nvar i,xi;\\n"+n+";\\nfor(i=n-1;i!==-1;--i) { \\n    xi = x[i];\\n    "+r+";\\n}\\nreturn accum;")},numeric.same=function r(n,e){var t,i;if(!(n instanceof Array&&e instanceof Array))return!1;if((i=n.length)!==e.length)return!1;for(t=0;t<i;t++)if(n[t]!==e[t]){if("object"!=typeof n[t])return!1;if(!r(n[t],e[t]))return!1}return!0},numeric.rep=function(r,n,e){void 0===e&&(e=0);var t,i=r[e],o=Array(i);if(e===r.length-1){for(t=i-2;t>=0;t-=2)o[t+1]=n,o[t]=n;return-1===t&&(o[0]=n),o}for(t=i-1;t>=0;t--)o[t]=numeric.rep(r,n,e+1);return o},numeric.dotMMsmall=function(r,n){var e,t,i,o,u,c,a,f,s,m,h;for(o=r.length,u=n.length,c=n[0].length,a=Array(o),e=o-1;e>=0;e--){for(f=Array(c),s=r[e],i=c-1;i>=0;i--){for(m=s[u-1]*n[u-1][i],t=u-2;t>=1;t-=2)h=t-1,m+=s[t]*n[t][i]+s[h]*n[h][i];0===t&&(m+=s[0]*n[0][i]),f[i]=m}a[e]=f}return a},numeric._getCol=function(r,n,e){var t;for(t=r.length-1;t>0;--t)e[t]=r[t][n],e[--t]=r[t][n];0===t&&(e[0]=r[0][n])},numeric.dotMMbig=function(r,n){var e,t,i,o=numeric._getCol,u=n.length,c=Array(u),a=r.length,f=n[0].length,s=new Array(a),m=numeric.dotVV;for(--u,t=--a;-1!==t;--t)s[t]=Array(f);for(t=--f;-1!==t;--t)for(o(n,t,c),i=a;-1!==i;--i)e=r[i],s[i][t]=m(e,c);return s},numeric.dotMV=function(r,n){var e,t=r.length,i=(n.length,Array(t)),o=numeric.dotVV;for(e=t-1;e>=0;e--)i[e]=o(r[e],n);return i},numeric.dotVM=function(r,n){var e,t,i,o,u,c,a;for(i=r.length,o=n[0].length,u=Array(o),t=o-1;t>=0;t--){for(c=r[i-1]*n[i-1][t],e=i-2;e>=1;e-=2)a=e-1,c+=r[e]*n[e][t]+r[a]*n[a][t];0===e&&(c+=r[0]*n[0][t]),u[t]=c}return u},numeric.dotVV=function(r,n){var e,t,i=r.length,o=r[i-1]*n[i-1];for(e=i-2;e>=1;e-=2)t=e-1,o+=r[e]*n[e]+r[t]*n[t];return 0===e&&(o+=r[0]*n[0]),o},numeric.dot=function(r,n){var e=numeric.dim;switch(1e3*e(r).length+e(n).length){case 2002:return n.length<10?numeric.dotMMsmall(r,n):numeric.dotMMbig(r,n);case 2001:return numeric.dotMV(r,n);case 1002:return numeric.dotVM(r,n);case 1001:return numeric.dotVV(r,n);case 1e3:return numeric.mulVS(r,n);case 1:return numeric.mulSV(r,n);case 0:return r*n;default:throw new Error("numeric.dot only works on vectors and matrices")}},numeric.diag=function(r){var n,e,t,i,o=r.length,u=Array(o);for(n=o-1;n>=0;n--){for(i=Array(o),e=n+2,t=o-1;t>=e;t-=2)i[t]=0,i[t-1]=0;for(t>n&&(i[t]=0),i[n]=r[n],t=n-1;t>=1;t-=2)i[t]=0,i[t-1]=0;0===t&&(i[0]=0),u[n]=i}return u},numeric.getDiag=function(r){var n,e=Math.min(r.length,r[0].length),t=Array(e);for(n=e-1;n>=1;--n)t[n]=r[n][n],t[--n]=r[n][n];return 0===n&&(t[0]=r[0][0]),t},numeric.identity=function(r){return numeric.diag(numeric.rep([r],1))},numeric.pointwise=function(r,n,e){void 0===e&&(e="");var t,i,o=[],u=/\\[i\\]$/,c="",a=!1;for(t=0;t<r.length;t++)u.test(r[t])?c=i=r[t].substring(0,r[t].length-3):i=r[t],"ret"===i&&(a=!0),o.push(i);return o[r.length]="_s",o[r.length+1]="_k",o[r.length+2]=\'if(typeof _s === "undefined") _s = numeric.dim(\'+c+\');\\nif(typeof _k === "undefined") _k = 0;\\nvar _n = _s[_k];\\nvar i\'+(a?"":", ret = Array(_n)")+";\\nif(_k < _s.length-1) {\\n    for(i=_n-1;i>=0;i--) ret[i] = arguments.callee("+r.join(",")+",_s,_k+1);\\n    return ret;\\n}\\n"+e+"\\nfor(i=_n-1;i!==-1;--i) {\\n    "+n+"\\n}\\nreturn ret;",Function.apply(null,o)},numeric.pointwise2=function(r,n,e){void 0===e&&(e="");var t,i,o=[],u=/\\[i\\]$/,c="",a=!1;for(t=0;t<r.length;t++)u.test(r[t])?c=i=r[t].substring(0,r[t].length-3):i=r[t],"ret"===i&&(a=!0),o.push(i);return o[r.length]="var _n = "+c+".length;\\nvar i"+(a?"":", ret = Array(_n)")+";\\n"+e+"\\nfor(i=_n-1;i!==-1;--i) {\\n"+n+"\\n}\\nreturn ret;",Function.apply(null,o)},numeric._biforeach=function r(n,e,t,i,o){var u;if(i!==t.length-1)for(u=t[i]-1;u>=0;u--)r("object"==typeof n?n[u]:n,"object"==typeof e?e[u]:e,t,i+1,o);else o(n,e)},numeric._biforeach2=function r(n,e,t,i,o){if(i===t.length-1)return o(n,e);var u,c=t[i],a=Array(c);for(u=c-1;u>=0;--u)a[u]=r("object"==typeof n?n[u]:n,"object"==typeof e?e[u]:e,t,i+1,o);return a},numeric._foreach=function r(n,e,t,i){var o;if(t!==e.length-1)for(o=e[t]-1;o>=0;o--)r(n[o],e,t+1,i);else i(n)},numeric._foreach2=function r(n,e,t,i){if(t===e.length-1)return i(n);var o,u=e[t],c=Array(u);for(o=u-1;o>=0;o--)c[o]=r(n[o],e,t+1,i);return c},numeric.ops2={add:"+",sub:"-",mul:"*",div:"/",mod:"%",and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">=",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"},numeric.opseq={addeq:"+=",subeq:"-=",muleq:"*=",diveq:"/=",modeq:"%=",lshifteq:"<<=",rshifteq:">>=",rrshifteq:">>>=",bandeq:"&=",boreq:"|=",bxoreq:"^="},numeric.mathfuns=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","isNaN","isFinite"],numeric.mathfuns2=["atan2","pow","max","min"],numeric.ops1={neg:"-",not:"!",bnot:"~",clone:""},numeric.mapreducers={any:["if(xi) return true;","var accum = false;"],all:["if(!xi) return false;","var accum = true;"],sum:["accum += xi;","var accum = 0;"],prod:["accum *= xi;","var accum = 1;"],norm2Squared:["accum += xi*xi;","var accum = 0;"],norminf:["accum = max(accum,abs(xi));","var accum = 0, max = Math.max, abs = Math.abs;"],norm1:["accum += abs(xi)","var accum = 0, abs = Math.abs;"],sup:["accum = max(accum,xi);","var accum = -Infinity, max = Math.max;"],inf:["accum = min(accum,xi);","var accum = Infinity, min = Math.min;"]},function(){var r,n;for(r=0;r<numeric.mathfuns2.length;++r)n=numeric.mathfuns2[r],numeric.ops2[n]=n;for(r in numeric.ops2)if(numeric.ops2.hasOwnProperty(r)){n=numeric.ops2[r];var e,t,i="";-1!==numeric.myIndexOf.call(numeric.mathfuns2,r)?(i="var "+n+" = Math."+n+";\\n",e=function(r,e,t){return r+" = "+n+"("+e+","+t+")"},t=function(r,e){return r+" = "+n+"("+r+","+e+")"}):(e=function(r,e,t){return r+" = "+e+" "+n+" "+t},t=numeric.opseq.hasOwnProperty(r+"eq")?function(r,e){return r+" "+n+"= "+e}:function(r,e){return r+" = "+r+" "+n+" "+e}),numeric[r+"VV"]=numeric.pointwise2(["x[i]","y[i]"],e("ret[i]","x[i]","y[i]"),i),numeric[r+"SV"]=numeric.pointwise2(["x","y[i]"],e("ret[i]","x","y[i]"),i),numeric[r+"VS"]=numeric.pointwise2(["x[i]","y"],e("ret[i]","x[i]","y"),i),numeric[r]=Function("var n = arguments.length, i, x = arguments[0], y;\\nvar VV = numeric."+r+"VV, VS = numeric."+r+"VS, SV = numeric."+r+\'SV;\\nvar dim = numeric.dim;\\nfor(i=1;i!==n;++i) { \\n  y = arguments[i];\\n  if(typeof x === "object") {\\n      if(typeof y === "object") x = numeric._biforeach2(x,y,dim(x),0,VV);\\n      else x = numeric._biforeach2(x,y,dim(x),0,VS);\\n  } else if(typeof y === "object") x = numeric._biforeach2(x,y,dim(y),0,SV);\\n  else \'+t("x","y")+"\\n}\\nreturn x;\\n"),numeric[n]=numeric[r],numeric[r+"eqV"]=numeric.pointwise2(["ret[i]","x[i]"],t("ret[i]","x[i]"),i),numeric[r+"eqS"]=numeric.pointwise2(["ret[i]","x"],t("ret[i]","x"),i),numeric[r+"eq"]=Function("var n = arguments.length, i, x = arguments[0], y;\\nvar V = numeric."+r+"eqV, S = numeric."+r+\'eqS\\nvar s = numeric.dim(x);\\nfor(i=1;i!==n;++i) { \\n  y = arguments[i];\\n  if(typeof y === "object") numeric._biforeach(x,y,s,0,V);\\n  else numeric._biforeach(x,y,s,0,S);\\n}\\nreturn x;\\n\')}for(r=0;r<numeric.mathfuns2.length;++r)n=numeric.mathfuns2[r],delete numeric.ops2[n];for(r=0;r<numeric.mathfuns.length;++r)n=numeric.mathfuns[r],numeric.ops1[n]=n;for(r in numeric.ops1)numeric.ops1.hasOwnProperty(r)&&(i="",n=numeric.ops1[r],-1!==numeric.myIndexOf.call(numeric.mathfuns,r)&&Math.hasOwnProperty(n)&&(i="var "+n+" = Math."+n+";\\n"),numeric[r+"eqV"]=numeric.pointwise2(["ret[i]"],"ret[i] = "+n+"(ret[i]);",i),numeric[r+"eq"]=Function("x",\'if(typeof x !== "object") return \'+n+"x\\nvar i;\\nvar V = numeric."+r+"eqV;\\nvar s = numeric.dim(x);\\nnumeric._foreach(x,s,0,V);\\nreturn x;\\n"),numeric[r+"V"]=numeric.pointwise2(["x[i]"],"ret[i] = "+n+"(x[i]);",i),numeric[r]=Function("x",\'if(typeof x !== "object") return \'+n+"(x)\\nvar i;\\nvar V = numeric."+r+"V;\\nvar s = numeric.dim(x);\\nreturn numeric._foreach2(x,s,0,V);\\n"));for(r=0;r<numeric.mathfuns.length;++r)n=numeric.mathfuns[r],delete numeric.ops1[n];for(r in numeric.mapreducers)numeric.mapreducers.hasOwnProperty(r)&&(n=numeric.mapreducers[r],numeric[r+"V"]=numeric.mapreduce2(n[0],n[1]),numeric[r]=Function("x","s","k",n[1]+\'if(typeof x !== "object") {    xi = x;\\n\'+n[0]+\';\\n    return accum;\\n}if(typeof s === "undefined") s = numeric.dim(x);\\nif(typeof k === "undefined") k = 0;\\nif(k === s.length-1) return numeric.\'+r+"V(x);\\nvar xi;\\nvar n = x.length, i;\\nfor(i=n-1;i!==-1;--i) {\\n   xi = arguments.callee(x[i]);\\n"+n[0]+";\\n}\\nreturn accum;\\n"))}(),numeric.truncVV=numeric.pointwise(["x[i]","y[i]"],"ret[i] = round(x[i]/y[i])*y[i];","var round = Math.round;"),numeric.truncVS=numeric.pointwise(["x[i]","y"],"ret[i] = round(x[i]/y)*y;","var round = Math.round;"),numeric.truncSV=numeric.pointwise(["x","y[i]"],"ret[i] = round(x/y[i])*y[i];","var round = Math.round;"),numeric.trunc=function(r,n){return"object"==typeof r?"object"==typeof n?numeric.truncVV(r,n):numeric.truncVS(r,n):"object"==typeof n?numeric.truncSV(r,n):Math.round(r/n)*n},numeric.inv=function(r){var n,e,t,i,o,u,c,a=numeric.dim(r),f=Math.abs,s=a[0],m=a[1],h=numeric.clone(r),l=numeric.identity(s);for(u=0;u<m;++u){var p=-1,d=-1;for(o=u;o!==s;++o)(c=f(h[o][u]))>d&&(p=o,d=c);for(e=h[p],h[p]=h[u],h[u]=e,i=l[p],l[p]=l[u],l[u]=i,r=e[u],c=u;c!==m;++c)e[c]/=r;for(c=m-1;-1!==c;--c)i[c]/=r;for(o=s-1;-1!==o;--o)if(o!==u){for(n=h[o],t=l[o],r=n[u],c=u+1;c!==m;++c)n[c]-=e[c]*r;for(c=m-1;c>0;--c)t[c]-=i[c]*r,t[--c]-=i[c]*r;0===c&&(t[0]-=i[0]*r)}}return l},numeric.det=function(r){var n=numeric.dim(r);if(2!==n.length||n[0]!==n[1])throw new Error("numeric: det() only works on square matrices");var e,t,i,o,u,c,a,f,s=n[0],m=1,h=numeric.clone(r);for(t=0;t<s-1;t++){for(i=t,e=t+1;e<s;e++)Math.abs(h[e][t])>Math.abs(h[i][t])&&(i=e);for(i!==t&&(a=h[i],h[i]=h[t],h[t]=a,m*=-1),o=h[t],e=t+1;e<s;e++){for(c=(u=h[e])[t]/o[t],i=t+1;i<s-1;i+=2)f=i+1,u[i]-=o[i]*c,u[f]-=o[f]*c;i!==s&&(u[i]-=o[i]*c)}if(0===o[t])return 0;m*=o[t]}return m*h[t][t]},numeric.transpose=function(r){var n,e,t,i,o,u=r.length,c=r[0].length,a=Array(c);for(e=0;e<c;e++)a[e]=Array(u);for(n=u-1;n>=1;n-=2){for(i=r[n],t=r[n-1],e=c-1;e>=1;--e)(o=a[e])[n]=i[e],o[n-1]=t[e],(o=a[--e])[n]=i[e],o[n-1]=t[e];0===e&&((o=a[0])[n]=i[0],o[n-1]=t[0])}if(0===n){for(t=r[0],e=c-1;e>=1;--e)a[e][0]=t[e],a[--e][0]=t[e];0===e&&(a[0][0]=t[0])}return a},numeric.negtranspose=function(r){var n,e,t,i,o,u=r.length,c=r[0].length,a=Array(c);for(e=0;e<c;e++)a[e]=Array(u);for(n=u-1;n>=1;n-=2){for(i=r[n],t=r[n-1],e=c-1;e>=1;--e)(o=a[e])[n]=-i[e],o[n-1]=-t[e],(o=a[--e])[n]=-i[e],o[n-1]=-t[e];0===e&&((o=a[0])[n]=-i[0],o[n-1]=-t[0])}if(0===n){for(t=r[0],e=c-1;e>=1;--e)a[e][0]=-t[e],a[--e][0]=-t[e];0===e&&(a[0][0]=-t[0])}return a},numeric._random=function r(n,e){var t,i,o=n[e],u=Array(o);if(e===n.length-1){for(i=Math.random,t=o-1;t>=1;t-=2)u[t]=i(),u[t-1]=i();return 0===t&&(u[0]=i()),u}for(t=o-1;t>=0;t--)u[t]=r(n,e+1);return u},numeric.random=function(r){return numeric._random(r,0)},numeric.norm2=function(r){return Math.sqrt(numeric.norm2Squared(r))},numeric.linspace=function(r,n,e){if(void 0===e&&(e=Math.max(Math.round(n-r)+1,1)),e<2)return 1===e?[r]:[];var t,i=Array(e);for(t=--e;t>=0;t--)i[t]=(t*n+(e-t)*r)/e;return i},numeric.getBlock=function(r,n,e){var t=numeric.dim(r);return function r(i,o){var u,c=n[o],a=e[o]-c,f=Array(a);if(o===t.length-1){for(u=a;u>=0;u--)f[u]=i[u+c];return f}for(u=a;u>=0;u--)f[u]=r(i[u+c],o+1);return f}(r,0)},numeric.setBlock=function(r,n,e,t){var i=numeric.dim(r);return function r(t,o,u){var c,a=n[u],f=e[u]-a;if(u===i.length-1)for(c=f;c>=0;c--)t[c+a]=o[c];for(c=f;c>=0;c--)r(t[c+a],o[c],u+1)}(r,t,0),r},numeric.getRange=function(r,n,e){var t,i,o,u,c=n.length,a=e.length,f=Array(c);for(t=c-1;-1!==t;--t)for(f[t]=Array(a),o=f[t],u=r[n[t]],i=a-1;-1!==i;--i)o[i]=u[e[i]];return f},numeric.blockMatrix=function(r){var n=numeric.dim(r);if(n.length<4)return numeric.blockMatrix([r]);var e,t,i,o,u,c=n[0],a=n[1];for(e=0,t=0,i=0;i<c;++i)e+=r[i][0].length;for(o=0;o<a;++o)t+=r[0][o][0].length;var f=Array(e);for(i=0;i<e;++i)f[i]=Array(t);var s,m,h,l,p,d=0;for(i=0;i<c;++i){for(s=t,o=a-1;-1!==o;--o)for(s-=(u=r[i][o])[0].length,h=u.length-1;-1!==h;--h)for(p=u[h],m=f[d+h],l=p.length-1;-1!==l;--l)m[s+l]=p[l];d+=r[i][0].length}return f},numeric.tensor=function(r,n){if("number"==typeof r||"number"==typeof n)return numeric.mul(r,n);var e=numeric.dim(r),t=numeric.dim(n);if(1!==e.length||1!==t.length)throw new Error("numeric: tensor product is only defined for vectors");var i,o,u,c,a=e[0],f=t[0],s=Array(a);for(o=a-1;o>=0;o--){for(i=Array(f),c=r[o],u=f-1;u>=3;--u)i[u]=c*n[u],i[--u]=c*n[u],i[--u]=c*n[u],i[--u]=c*n[u];for(;u>=0;)i[u]=c*n[u],--u;s[o]=i}return s},numeric.T=function(r,n){this.x=r,this.y=n},numeric.t=function(r,n){return new numeric.T(r,n)},numeric.Tbinop=function(r,n,e,t,i){var o;if(numeric.indexOf,"string"!=typeof i)for(o in i="",numeric)numeric.hasOwnProperty(o)&&(r.indexOf(o)>=0||n.indexOf(o)>=0||e.indexOf(o)>=0||t.indexOf(o)>=0)&&o.length>1&&(i+="var "+o+" = numeric."+o+";\\n");return Function(["y"],"var x = this;\\nif(!(y instanceof numeric.T)) { y = new numeric.T(y); }\\n"+i+"\\nif(x.y) {  if(y.y) {    return new numeric.T("+t+");\\n  }\\n  return new numeric.T("+e+");\\n}\\nif(y.y) {\\n  return new numeric.T("+n+");\\n}\\nreturn new numeric.T("+r+");\\n")},numeric.T.prototype.add=numeric.Tbinop("add(x.x,y.x)","add(x.x,y.x),y.y","add(x.x,y.x),x.y","add(x.x,y.x),add(x.y,y.y)"),numeric.T.prototype.sub=numeric.Tbinop("sub(x.x,y.x)","sub(x.x,y.x),neg(y.y)","sub(x.x,y.x),x.y","sub(x.x,y.x),sub(x.y,y.y)"),numeric.T.prototype.mul=numeric.Tbinop("mul(x.x,y.x)","mul(x.x,y.x),mul(x.x,y.y)","mul(x.x,y.x),mul(x.y,y.x)","sub(mul(x.x,y.x),mul(x.y,y.y)),add(mul(x.x,y.y),mul(x.y,y.x))"),numeric.T.prototype.reciprocal=function(){var r=numeric.mul,n=numeric.div;if(this.y){var e=numeric.add(r(this.x,this.x),r(this.y,this.y));return new numeric.T(n(this.x,e),n(numeric.neg(this.y),e))}return new T(n(1,this.x))},numeric.T.prototype.div=function(r){if(r instanceof numeric.T||(r=new numeric.T(r)),r.y)return this.mul(r.reciprocal());var n=numeric.div;return this.y?new numeric.T(n(this.x,r.x),n(this.y,r.x)):new numeric.T(n(this.x,r.x))},numeric.T.prototype.dot=numeric.Tbinop("dot(x.x,y.x)","dot(x.x,y.x),dot(x.x,y.y)","dot(x.x,y.x),dot(x.y,y.x)","sub(dot(x.x,y.x),dot(x.y,y.y)),add(dot(x.x,y.y),dot(x.y,y.x))"),numeric.T.prototype.transpose=function(){var r=numeric.transpose,n=this.x,e=this.y;return e?new numeric.T(r(n),r(e)):new numeric.T(r(n))},numeric.T.prototype.transjugate=function(){var r=numeric.transpose,n=this.x,e=this.y;return e?new numeric.T(r(n),numeric.negtranspose(e)):new numeric.T(r(n))},numeric.Tunop=function(r,n,e){return"string"!=typeof e&&(e=""),Function("var x = this;\\n"+e+"\\nif(x.y) {  "+n+";\\n}\\n"+r+";\\n")},numeric.T.prototype.exp=numeric.Tunop("return new numeric.T(ex)","return new numeric.T(mul(cos(x.y),ex),mul(sin(x.y),ex))","var ex = numeric.exp(x.x), cos = numeric.cos, sin = numeric.sin, mul = numeric.mul;"),numeric.T.prototype.conj=numeric.Tunop("return new numeric.T(x.x);","return new numeric.T(x.x,numeric.neg(x.y));"),numeric.T.prototype.neg=numeric.Tunop("return new numeric.T(neg(x.x));","return new numeric.T(neg(x.x),neg(x.y));","var neg = numeric.neg;"),numeric.T.prototype.sin=numeric.Tunop("return new numeric.T(numeric.sin(x.x))","return x.exp().sub(x.neg().exp()).div(new numeric.T(0,2));"),numeric.T.prototype.cos=numeric.Tunop("return new numeric.T(numeric.cos(x.x))","return x.exp().add(x.neg().exp()).div(2);"),numeric.T.prototype.abs=numeric.Tunop("return new numeric.T(numeric.abs(x.x));","return new numeric.T(numeric.sqrt(numeric.add(mul(x.x,x.x),mul(x.y,x.y))));","var mul = numeric.mul;"),numeric.T.prototype.log=numeric.Tunop("return new numeric.T(numeric.log(x.x));","var theta = new numeric.T(numeric.atan2(x.y,x.x)), r = x.abs();\\nreturn new numeric.T(numeric.log(r.x),theta.x);"),numeric.T.prototype.norm2=numeric.Tunop("return numeric.norm2(x.x);","var f = numeric.norm2Squared;\\nreturn Math.sqrt(f(x.x)+f(x.y));"),numeric.T.prototype.inv=function(){var r=this;if(void 0===r.y)return new numeric.T(numeric.inv(r.x));var n,e,t,i,o,u,c,a,f,s,m,h,l,p,d,g,v,y,x=r.x.length,w=numeric.identity(x),b=numeric.rep([x,x],0),_=numeric.clone(r.x),M=numeric.clone(r.y);for(f=0;f<x;f++){for(h=(p=_[f][f])*p+(d=M[f][f])*d,m=f,s=f+1;s<x;s++)(l=(p=_[s][f])*p+(d=M[s][f])*d)>h&&(m=s,h=l);for(m!==f&&(y=_[f],_[f]=_[m],_[m]=y,y=M[f],M[f]=M[m],M[m]=y,y=w[f],w[f]=w[m],w[m]=y,y=b[f],b[f]=b[m],b[m]=y),n=_[f],e=M[f],o=w[f],u=b[f],p=n[f],d=e[f],s=f+1;s<x;s++)g=n[s],v=e[s],n[s]=(g*p+v*d)/h,e[s]=(v*p-g*d)/h;for(s=0;s<x;s++)g=o[s],v=u[s],o[s]=(g*p+v*d)/h,u[s]=(v*p-g*d)/h;for(s=f+1;s<x;s++){for(t=_[s],i=M[s],c=w[s],a=b[s],p=t[f],d=i[f],m=f+1;m<x;m++)g=n[m],v=e[m],t[m]-=g*p-v*d,i[m]-=v*p+g*d;for(m=0;m<x;m++)g=o[m],v=u[m],c[m]-=g*p-v*d,a[m]-=v*p+g*d}}for(f=x-1;f>0;f--)for(o=w[f],u=b[f],s=f-1;s>=0;s--)for(c=w[s],a=b[s],p=_[s][f],d=M[s][f],m=x-1;m>=0;m--)g=o[m],v=u[m],c[m]-=p*g-d*v,a[m]-=p*v+d*g;return new numeric.T(w,b)},numeric.T.prototype.get=function(r){var n,e=this.x,t=this.y,i=0,o=r.length;if(t){for(;i<o;)e=e[n=r[i]],t=t[n],i++;return new numeric.T(e,t)}for(;i<o;)e=e[n=r[i]],i++;return new numeric.T(e)},numeric.T.prototype.set=function(r,n){var e,t=this.x,i=this.y,o=0,u=r.length,c=n.x,a=n.y;if(0===u)return a?this.y=a:i&&(this.y=void 0),this.x=t,this;if(a){for(i||(i=numeric.rep(numeric.dim(t),0),this.y=i);o<u-1;)t=t[e=r[o]],i=i[e],o++;return t[e=r[o]]=c,i[e]=a,this}if(i){for(;o<u-1;)t=t[e=r[o]],i=i[e],o++;return t[e=r[o]]=c,i[e]=c instanceof Array?numeric.rep(numeric.dim(c),0):0,this}for(;o<u-1;)t=t[e=r[o]],o++;return t[e=r[o]]=c,this},numeric.T.prototype.getRows=function(r,n){var e,t,i=n-r+1,o=Array(i),u=this.x,c=this.y;for(e=r;e<=n;e++)o[e-r]=u[e];if(c){for(t=Array(i),e=r;e<=n;e++)t[e-r]=c[e];return new numeric.T(o,t)}return new numeric.T(o)},numeric.T.prototype.setRows=function(r,n,e){var t,i=this.x,o=this.y,u=e.x,c=e.y;for(t=r;t<=n;t++)i[t]=u[t-r];if(c)for(o||(o=numeric.rep(numeric.dim(i),0),this.y=o),t=r;t<=n;t++)o[t]=c[t-r];else if(o)for(t=r;t<=n;t++)o[t]=numeric.rep([u[t-r].length],0);return this},numeric.T.prototype.getRow=function(r){var n=this.x,e=this.y;return e?new numeric.T(n[r],e[r]):new numeric.T(n[r])},numeric.T.prototype.setRow=function(r,n){var e=this.x,t=this.y,i=n.x,o=n.y;return e[r]=i,o?(t||(t=numeric.rep(numeric.dim(e),0),this.y=t),t[r]=o):t&&(t=numeric.rep([i.length],0)),this},numeric.T.prototype.getBlock=function(r,n){var e=this.x,t=this.y,i=numeric.getBlock;return t?new numeric.T(i(e,r,n),i(t,r,n)):new numeric.T(i(e,r,n))},numeric.T.prototype.setBlock=function(r,n,e){e instanceof numeric.T||(e=new numeric.T(e));var t=this.x,i=this.y,o=numeric.setBlock,u=e.x,c=e.y;if(c)return i||(this.y=numeric.rep(numeric.dim(this),0),i=this.y),o(t,r,n,u),o(i,r,n,c),this;o(t,r,n,u),i&&o(i,r,n,numeric.rep(numeric.dim(u),0))},numeric.T.rep=function(r,n){var e=numeric.T;n instanceof e||(n=new e(n));var t=n.x,i=n.y,o=numeric.rep;return i?new e(o(r,t),o(r,i)):new e(o(r,t))},numeric.T.diag=function(r){r instanceof numeric.T||(r=new numeric.T(r));var n=r.x,e=r.y,t=numeric.diag;return e?new numeric.T(t(n),t(e)):new numeric.T(t(n))},numeric.T.eig=function(){if(this.y)throw new Error("eig: not implemented for complex matrices.");return numeric.eig(this.x)},numeric.T.identity=function(r){return new numeric.T(numeric.identity(r))},numeric.T.prototype.getDiag=function(){var r=numeric,n=this.x,e=this.y;return e?new r.T(r.getDiag(n),r.getDiag(e)):new r.T(r.getDiag(n))},numeric.house=function(r){var n=numeric.clone(r),e=(r[0]>=0?1:-1)*numeric.norm2(r);n[0]+=e;var t=numeric.norm2(n);if(0===t)throw new Error("eig: internal error");return numeric.div(n,t)},numeric.toUpperHessenberg=function(r){var n=numeric.dim(r);if(2!==n.length||n[0]!==n[1])throw new Error("numeric: toUpperHessenberg() only works on square matrices");var e,t,i,o,u,c,a,f,s,m,h=n[0],l=numeric.clone(r),p=numeric.identity(h);for(t=0;t<h-2;t++){for(o=Array(h-t-1),e=t+1;e<h;e++)o[e-t-1]=l[e][t];if(numeric.norm2(o)>0){for(u=numeric.house(o),c=numeric.getBlock(l,[t+1,t],[h-1,h-1]),a=numeric.tensor(u,numeric.dot(u,c)),e=t+1;e<h;e++)for(f=l[e],s=a[e-t-1],i=t;i<h;i++)f[i]-=2*s[i-t];for(c=numeric.getBlock(l,[0,t+1],[h-1,h-1]),a=numeric.tensor(numeric.dot(c,u),u),e=0;e<h;e++)for(f=l[e],s=a[e],i=t+1;i<h;i++)f[i]-=2*s[i-t-1];for(c=Array(h-t-1),e=t+1;e<h;e++)c[e-t-1]=p[e];for(a=numeric.tensor(u,numeric.dot(u,c)),e=t+1;e<h;e++)for(m=p[e],s=a[e-t-1],i=0;i<h;i++)m[i]-=2*s[i]}}return{H:l,Q:p}},numeric.epsilon=2220446049250313e-31,numeric.QRFrancis=function(r,n){void 0===n&&(n=1e4),r=numeric.clone(r),numeric.clone(r);var e,t,i,o,u,c,a,f,s,m,h,l,p,d,g,v,y,x,w=numeric.dim(r)[0],b=numeric.identity(w);if(w<3)return{Q:b,B:[[0,w-1]]};var _=numeric.epsilon;for(x=0;x<n;x++){for(v=0;v<w-1;v++)if(Math.abs(r[v+1][v])<_*(Math.abs(r[v][v])+Math.abs(r[v+1][v+1]))){var M=numeric.QRFrancis(numeric.getBlock(r,[0,0],[v,v]),n),k=numeric.QRFrancis(numeric.getBlock(r,[v+1,v+1],[w-1,w-1]),n);for(l=Array(v+1),g=0;g<=v;g++)l[g]=b[g];for(p=numeric.dot(M.Q,l),g=0;g<=v;g++)b[g]=p[g];for(l=Array(w-v-1),g=v+1;g<w;g++)l[g-v-1]=b[g];for(p=numeric.dot(k.Q,l),g=v+1;g<w;g++)b[g]=p[g-v-1];return{Q:b,B:M.B.concat(numeric.add(k.B,v+1))}}var A,j,T;for(i=r[w-2][w-2],o=r[w-2][w-1],u=r[w-1][w-2],f=i+(c=r[w-1][w-1]),a=i*c-o*u,s=numeric.getBlock(r,[0,0],[2,2]),f*f>=4*a?(A=.5*(f+Math.sqrt(f*f-4*a)),j=.5*(f-Math.sqrt(f*f-4*a)),s=numeric.add(numeric.sub(numeric.dot(s,s),numeric.mul(s,A+j)),numeric.diag(numeric.rep([3],A*j)))):s=numeric.add(numeric.sub(numeric.dot(s,s),numeric.mul(s,f)),numeric.diag(numeric.rep([3],a))),e=[s[0][0],s[1][0],s[2][0]],t=numeric.house(e),l=[r[0],r[1],r[2]],p=numeric.tensor(t,numeric.dot(t,l)),g=0;g<3;g++)for(h=r[g],d=p[g],y=0;y<w;y++)h[y]-=2*d[y];for(l=numeric.getBlock(r,[0,0],[w-1,2]),p=numeric.tensor(numeric.dot(l,t),t),g=0;g<w;g++)for(h=r[g],d=p[g],y=0;y<3;y++)h[y]-=2*d[y];for(l=[b[0],b[1],b[2]],p=numeric.tensor(t,numeric.dot(t,l)),g=0;g<3;g++)for(m=b[g],d=p[g],y=0;y<w;y++)m[y]-=2*d[y];for(v=0;v<w-2;v++){for(y=v;y<=v+1;y++)if(Math.abs(r[y+1][y])<_*(Math.abs(r[y][y])+Math.abs(r[y+1][y+1]))){for(M=numeric.QRFrancis(numeric.getBlock(r,[0,0],[y,y]),n),k=numeric.QRFrancis(numeric.getBlock(r,[y+1,y+1],[w-1,w-1]),n),l=Array(y+1),g=0;g<=y;g++)l[g]=b[g];for(p=numeric.dot(M.Q,l),g=0;g<=y;g++)b[g]=p[g];for(l=Array(w-y-1),g=y+1;g<w;g++)l[g-y-1]=b[g];for(p=numeric.dot(k.Q,l),g=y+1;g<w;g++)b[g]=p[g-y-1];return{Q:b,B:M.B.concat(numeric.add(k.B,y+1))}}for(T=Math.min(w-1,v+3),e=Array(T-v),g=v+1;g<=T;g++)e[g-v-1]=r[g][v];for(t=numeric.house(e),l=numeric.getBlock(r,[v+1,v],[T,w-1]),p=numeric.tensor(t,numeric.dot(t,l)),g=v+1;g<=T;g++)for(h=r[g],d=p[g-v-1],y=v;y<w;y++)h[y]-=2*d[y-v];for(l=numeric.getBlock(r,[0,v+1],[w-1,T]),p=numeric.tensor(numeric.dot(l,t),t),g=0;g<w;g++)for(h=r[g],d=p[g],y=v+1;y<=T;y++)h[y]-=2*d[y-v-1];for(l=Array(T-v),g=v+1;g<=T;g++)l[g-v-1]=b[g];for(p=numeric.tensor(t,numeric.dot(t,l)),g=v+1;g<=T;g++)for(m=b[g],d=p[g-v-1],y=0;y<w;y++)m[y]-=2*d[y]}}throw new Error("numeric: eigenvalue iteration does not converge -- increase maxiter?")},numeric.eig=function(r,n){var e,t,i,o,u,c,a,f,s,m,h,l,p,d,g,v,y=numeric.toUpperHessenberg(r),x=numeric.QRFrancis(y.H,n),w=numeric.T,b=r.length,_=x.B,M=numeric.dot(x.Q,numeric.dot(y.H,numeric.transpose(x.Q))),k=new w(numeric.dot(x.Q,y.Q)),A=_.length,j=Math.sqrt;for(t=0;t<A;t++)if((e=_[t][0])===_[t][1]);else{if(o=e+1,u=M[e][e],c=M[e][o],a=M[o][e],f=M[o][o],0===c&&0===a)continue;(m=(s=-u-f)*s-4*(u*f-c*a))>=0?((g=(u-(h=s<0?-.5*(s-j(m)):-.5*(s+j(m))))*(u-h)+c*c)>(v=a*a+(f-h)*(f-h))?(p=(u-h)/(g=j(g)),d=c/g):(p=a/(v=j(v)),d=(f-h)/v),i=new w([[d,-p],[p,d]]),k.setRows(e,o,i.dot(k.getRows(e,o)))):(h=-.5*s,l=.5*j(-m),(g=(u-h)*(u-h)+c*c)>(v=a*a+(f-h)*(f-h))?(p=(u-h)/(g=j(g+l*l)),d=c/g,h=0,l/=g):(p=a/(v=j(v+l*l)),d=(f-h)/v,h=l/v,l=0),i=new w([[d,-p],[p,d]],[[h,l],[l,-h]]),k.setRows(e,o,i.dot(k.getRows(e,o))))}var T=k.dot(r).dot(k.transjugate()),S=(b=r.length,numeric.T.identity(b));for(o=0;o<b;o++)if(o>0)for(t=o-1;t>=0;t--){var q=T.get([t,t]),P=T.get([o,o]);numeric.neq(q.x,P.x)||numeric.neq(q.y,P.y)?(h=T.getRow(t).getBlock([t],[o-1]),l=S.getRow(o).getBlock([t],[o-1]),S.set([o,t],T.get([t,o]).neg().sub(h.dot(l)).div(q.sub(P)))):S.setRow(o,S.getRow(t))}for(o=0;o<b;o++)h=S.getRow(o),S.setRow(o,h.div(h.norm2()));return S=S.transpose(),S=k.transjugate().dot(S),{lambda:T.getDiag(),E:S}},numeric.ccsSparse=function(r){var n,e,t,i=r.length,o=[];for(e=i-1;-1!==e;--e)for(t in n=r[e]){for(t=parseInt(t);t>=o.length;)o[o.length]=0;0!==n[t]&&o[t]++}var u=o.length,c=Array(u+1);for(c[0]=0,e=0;e<u;++e)c[e+1]=c[e]+o[e];var a=Array(c[u]),f=Array(c[u]);for(e=i-1;-1!==e;--e)for(t in n=r[e])0!==n[t]&&(o[t]--,a[c[t]+o[t]]=e,f[c[t]+o[t]]=n[t]);return[c,a,f]},numeric.ccsFull=function(r){var n,e,t,i,o=r[0],u=r[1],c=r[2],a=numeric.ccsDim(r),f=a[0],s=a[1],m=numeric.rep([f,s],0);for(n=0;n<s;n++)for(t=o[n],i=o[n+1],e=t;e<i;++e)m[u[e]][n]=c[e];return m},numeric.ccsTSolve=function(r,n,e,t,i){var o,u,c,a,f,s,m,h=r[0],l=r[1],p=r[2],d=h.length-1,g=Math.max,v=0;function y(r){var n;if(0===e[r]){for(e[r]=1,n=h[r];n<h[r+1];++n)y(l[n]);i[v]=r,++v}}for(void 0===t&&(e=numeric.rep([d],0)),void 0===t&&(t=numeric.linspace(0,e.length-1)),void 0===i&&(i=[]),o=t.length-1;-1!==o;--o)y(t[o]);for(i.length=v,o=i.length-1;-1!==o;--o)e[i[o]]=0;for(o=t.length-1;-1!==o;--o)u=t[o],e[u]=n[u];for(o=i.length-1;-1!==o;--o){for(u=i[o],c=h[u],a=g(h[u+1],c),f=c;f!==a;++f)if(l[f]===u){e[u]/=p[f];break}for(m=e[u],f=c;f!==a;++f)(s=l[f])!==u&&(e[s]-=m*p[f])}return e},numeric.ccsDFS=function(r){this.k=Array(r),this.k1=Array(r),this.j=Array(r)},numeric.ccsDFS.prototype.dfs=function(r,n,e,t,i,o){var u,c,a,f=0,s=i.length,m=this.k,h=this.k1,l=this.j;if(0===t[r])for(t[r]=1,l[0]=r,m[0]=c=n[r],h[0]=a=n[r+1];;)if(c>=a){if(i[s]=l[f],0===f)return;++s,c=m[--f],a=h[f]}else 0===t[u=o[e[c]]]?(t[u]=1,m[f]=c,l[++f]=u,c=n[u],h[f]=a=n[u+1]):++c},numeric.ccsLPSolve=function(r,n,e,t,i,o,u){var c,a,f,s,m,h,l,p,d,g=r[0],v=r[1],y=r[2],x=(g.length,n[0]),w=n[1],b=n[2];for(a=x[i],f=x[i+1],t.length=0,c=a;c<f;++c)u.dfs(o[w[c]],g,v,e,t,o);for(c=t.length-1;-1!==c;--c)e[t[c]]=0;for(c=a;c!==f;++c)e[s=o[w[c]]]=b[c];for(c=t.length-1;-1!==c;--c){for(m=g[s=t[c]],h=g[s+1],l=m;l<h;++l)if(o[v[l]]===s){e[s]/=y[l];break}for(d=e[s],l=m;l<h;++l)(p=o[v[l]])!==s&&(e[p]-=d*y[l])}return e},numeric.ccsLUP1=function(r,n){var e,t,i,o,u,c,a,f=r[0].length-1,s=[numeric.rep([f+1],0),[],[]],m=[numeric.rep([f+1],0),[],[]],h=s[0],l=s[1],p=s[2],d=m[0],g=m[1],v=m[2],y=numeric.rep([f],0),x=numeric.rep([f],0),w=numeric.ccsLPSolve,b=(Math.max,Math.abs),_=numeric.linspace(0,f-1),M=numeric.linspace(0,f-1),k=new numeric.ccsDFS(f);for(void 0===n&&(n=1),e=0;e<f;++e){for(w(s,r,y,x,e,M,k),o=-1,u=-1,t=x.length-1;-1!==t;--t)(i=x[t])<=e||(c=b(y[i]))>o&&(u=i,o=c);for(b(y[e])<n*o&&(t=_[e],o=_[u],_[e]=o,M[o]=e,_[u]=t,M[t]=u,o=y[e],y[e]=y[u],y[u]=o),o=h[e],u=d[e],a=y[e],l[o]=_[e],p[o]=1,++o,t=x.length-1;-1!==t;--t)c=y[i=x[t]],x[t]=0,y[i]=0,i<=e?(g[u]=i,v[u]=c,++u):(l[o]=_[i],p[o]=c/a,++o);h[e+1]=o,d[e+1]=u}for(t=l.length-1;-1!==t;--t)l[t]=M[l[t]];return{L:s,U:m,P:_,Pinv:M}},numeric.ccsDFS0=function(r){this.k=Array(r),this.k1=Array(r),this.j=Array(r)},numeric.ccsDFS0.prototype.dfs=function(r,n,e,t,i,o,u){var c,a,f,s=0,m=i.length,h=this.k,l=this.k1,p=this.j;if(0===t[r])for(t[r]=1,p[0]=r,h[0]=a=n[o[r]],l[0]=f=n[o[r]+1];;){if(isNaN(a))throw new Error("Ow!");if(a>=f){if(i[m]=o[p[s]],0===s)return;++m,a=h[--s],f=l[s]}else 0===t[c=e[a]]?(t[c]=1,h[s]=a,p[++s]=c,a=n[c=o[c]],l[s]=f=n[c+1]):++a}},numeric.ccsLPSolve0=function(r,n,e,t,i,o,u,c){var a,f,s,m,h,l,p,d,g,v=r[0],y=r[1],x=r[2],w=(v.length,n[0]),b=n[1],_=n[2];for(f=w[i],s=w[i+1],t.length=0,a=f;a<s;++a)c.dfs(b[a],v,y,e,t,o,u);for(a=t.length-1;-1!==a;--a)e[u[m=t[a]]]=0;for(a=f;a!==s;++a)e[m=b[a]]=_[a];for(a=t.length-1;-1!==a;--a){for(d=u[m=t[a]],h=v[m],l=v[m+1],p=h;p<l;++p)if(y[p]===d){e[d]/=x[p];break}for(g=e[d],p=h;p<l;++p)e[y[p]]-=g*x[p];e[d]=g}},numeric.ccsLUP0=function(r,n){var e,t,i,o,u,c,a,f=r[0].length-1,s=[numeric.rep([f+1],0),[],[]],m=[numeric.rep([f+1],0),[],[]],h=s[0],l=s[1],p=s[2],d=m[0],g=m[1],v=m[2],y=numeric.rep([f],0),x=numeric.rep([f],0),w=numeric.ccsLPSolve0,b=(Math.max,Math.abs),_=numeric.linspace(0,f-1),M=numeric.linspace(0,f-1),k=new numeric.ccsDFS0(f);for(void 0===n&&(n=1),e=0;e<f;++e){for(w(s,r,y,x,e,M,_,k),o=-1,u=-1,t=x.length-1;-1!==t;--t)(i=x[t])<=e||(c=b(y[_[i]]))>o&&(u=i,o=c);for(b(y[_[e]])<n*o&&(t=_[e],o=_[u],_[e]=o,M[o]=e,_[u]=t,M[t]=u),o=h[e],u=d[e],a=y[_[e]],l[o]=_[e],p[o]=1,++o,t=x.length-1;-1!==t;--t)c=y[_[i=x[t]]],x[t]=0,y[_[i]]=0,i<=e?(g[u]=i,v[u]=c,++u):(l[o]=_[i],p[o]=c/a,++o);h[e+1]=o,d[e+1]=u}for(t=l.length-1;-1!==t;--t)l[t]=M[l[t]];return{L:s,U:m,P:_,Pinv:M}},numeric.ccsLUP=numeric.ccsLUP0,numeric.ccsDim=function(r){return[numeric.sup(r[1])+1,r[0].length-1]},numeric.ccsGetBlock=function(r,n,e){var t=numeric.ccsDim(r),i=t[0],o=t[1];void 0===n?n=numeric.linspace(0,i-1):"number"==typeof n&&(n=[n]),void 0===e?e=numeric.linspace(0,o-1):"number"==typeof e&&(e=[e]);var u,c,a,f,s=n.length,m=e.length,h=numeric.rep([o],0),l=[],p=[],d=[h,l,p],g=r[0],v=r[1],y=r[2],x=numeric.rep([i],0),w=0,b=numeric.rep([i],0);for(c=0;c<m;++c){var _=g[f=e[c]],M=g[f+1];for(u=_;u<M;++u)b[a=v[u]]=1,x[a]=y[u];for(u=0;u<s;++u)b[n[u]]&&(l[w]=u,p[w]=x[n[u]],++w);for(u=_;u<M;++u)b[a=v[u]]=0;h[c+1]=w}return d},numeric.ccsDot=function(r,n){var e,t,i,o,u,c,a,f,s,m,h,l=r[0],p=r[1],d=r[2],g=n[0],v=n[1],y=n[2],x=numeric.ccsDim(r),w=numeric.ccsDim(n),b=x[0],_=(x[1],w[1]),M=numeric.rep([b],0),k=numeric.rep([b],0),A=Array(b),j=numeric.rep([_],0),T=[],S=[],q=[j,T,S];for(i=0;i!==_;++i){for(o=g[i],u=g[i+1],s=0,t=o;t<u;++t)for(m=v[t],h=y[t],c=l[m],a=l[m+1],e=c;e<a;++e)0===k[f=p[e]]&&(A[s]=f,k[f]=1,s+=1),M[f]=M[f]+d[e]*h;for(u=(o=j[i])+s,j[i+1]=u,t=s-1;-1!==t;--t)h=o+t,e=A[t],T[h]=e,S[h]=M[e],k[e]=0,M[e]=0;j[i+1]=j[i]+s}return q},numeric.ccsLUPSolve=function(r,n){var e=r.L,t=r.U,i=(r.P,n[0]),o=!1;"object"!=typeof i&&(i=(n=[[0,n.length],numeric.linspace(0,n.length-1),n])[0],o=!0);var u,c,a,f,s,m,h=n[1],l=n[2],p=e[0].length-1,d=i.length-1,g=numeric.rep([p],0),v=Array(p),y=numeric.rep([p],0),x=Array(p),w=numeric.rep([d+1],0),b=[],_=[],M=numeric.ccsTSolve,k=0;for(u=0;u<d;++u){for(s=0,a=i[u],f=i[u+1],c=a;c<f;++c)m=r.Pinv[h[c]],x[s]=m,y[m]=l[c],++s;for(x.length=s,M(e,y,g,x,v),c=x.length-1;-1!==c;--c)y[x[c]]=0;if(M(t,g,y,v,x),o)return y;for(c=v.length-1;-1!==c;--c)g[v[c]]=0;for(c=x.length-1;-1!==c;--c)m=x[c],b[k]=m,_[k]=y[m],y[m]=0,++k;w[u+1]=k}return[w,b,_]},numeric.ccsbinop=function(r,n){return void 0===n&&(n=""),Function("X","Y","var Xi = X[0], Xj = X[1], Xv = X[2];\\nvar Yi = Y[0], Yj = Y[1], Yv = Y[2];\\nvar n = Xi.length-1,m = Math.max(numeric.sup(Xj),numeric.sup(Yj))+1;\\nvar Zi = numeric.rep([n+1],0), Zj = [], Zv = [];\\nvar x = numeric.rep([m],0),y = numeric.rep([m],0);\\nvar xk,yk,zk;\\nvar i,j,j0,j1,k,p=0;\\n"+n+"for(i=0;i<n;++i) {\\n  j0 = Xi[i]; j1 = Xi[i+1];\\n  for(j=j0;j!==j1;++j) {\\n    k = Xj[j];\\n    x[k] = 1;\\n    Zj[p] = k;\\n    ++p;\\n  }\\n  j0 = Yi[i]; j1 = Yi[i+1];\\n  for(j=j0;j!==j1;++j) {\\n    k = Yj[j];\\n    y[k] = Yv[j];\\n    if(x[k] === 0) {\\n      Zj[p] = k;\\n      ++p;\\n    }\\n  }\\n  Zi[i+1] = p;\\n  j0 = Xi[i]; j1 = Xi[i+1];\\n  for(j=j0;j!==j1;++j) x[Xj[j]] = Xv[j];\\n  j0 = Zi[i]; j1 = Zi[i+1];\\n  for(j=j0;j!==j1;++j) {\\n    k = Zj[j];\\n    xk = x[k];\\n    yk = y[k];\\n"+r+"\\n    Zv[j] = zk;\\n  }\\n  j0 = Xi[i]; j1 = Xi[i+1];\\n  for(j=j0;j!==j1;++j) x[Xj[j]] = 0;\\n  j0 = Yi[i]; j1 = Yi[i+1];\\n  for(j=j0;j!==j1;++j) y[Yj[j]] = 0;\\n}\\nreturn [Zi,Zj,Zv];")},function(){var k,A,B,C;for(k in numeric.ops2)A=isFinite(eval("1"+numeric.ops2[k]+"0"))?"[Y[0],Y[1],numeric."+k+"(X,Y[2])]":"NaN",B=isFinite(eval("0"+numeric.ops2[k]+"1"))?"[X[0],X[1],numeric."+k+"(X[2],Y)]":"NaN",C=isFinite(eval("1"+numeric.ops2[k]+"0"))&&isFinite(eval("0"+numeric.ops2[k]+"1"))?"numeric.ccs"+k+"MM(X,Y)":"NaN",numeric["ccs"+k+"MM"]=numeric.ccsbinop("zk = xk "+numeric.ops2[k]+"yk;"),numeric["ccs"+k]=Function("X","Y",\'if(typeof X === "number") return \'+A+\';\\nif(typeof Y === "number") return \'+B+";\\nreturn "+C+";\\n")}(),numeric.ccsScatter=function(r){var n,e=r[0],t=r[1],i=r[2],o=numeric.sup(t)+1,u=e.length,c=numeric.rep([o],0),a=Array(u),f=Array(u),s=numeric.rep([o],0);for(n=0;n<u;++n)s[t[n]]++;for(n=0;n<o;++n)c[n+1]=c[n]+s[n];var m,h,l=c.slice(0);for(n=0;n<u;++n)a[m=l[h=t[n]]]=e[n],f[m]=i[n],l[h]=l[h]+1;return[c,a,f]},numeric.ccsGather=function(r){var n,e,t,i,o,u=r[0],c=r[1],a=r[2],f=u.length-1,s=c.length,m=Array(s),h=Array(s),l=Array(s);for(o=0,n=0;n<f;++n)for(t=u[n],i=u[n+1],e=t;e!==i;++e)h[o]=n,m[o]=c[e],l[o]=a[e],++o;return[m,h,l]},numeric.sdim=function r(n,e,t){if(void 0===e&&(e=[]),"object"!=typeof n)return e;var i;for(i in void 0===t&&(t=0),t in e||(e[t]=0),n.length>e[t]&&(e[t]=n.length),n)n.hasOwnProperty(i)&&r(n[i],e,t+1);return e},numeric.sclone=function r(n,e,t){void 0===e&&(e=0),void 0===t&&(t=numeric.sdim(n).length);var i,o=Array(n.length);if(e===t-1){for(i in n)n.hasOwnProperty(i)&&(o[i]=n[i]);return o}for(i in n)n.hasOwnProperty(i)&&(o[i]=r(n[i],e+1,t));return o},numeric.sdiag=function(r){var n,e,t=r.length,i=Array(t);for(n=t-1;n>=1;n-=2)e=n-1,i[n]=[],i[n][n]=r[n],i[e]=[],i[e][e]=r[e];return 0===n&&(i[0]=[],i[0][0]=r[n]),i},numeric.sidentity=function(r){return numeric.sdiag(numeric.rep([r],1))},numeric.stranspose=function(r){var n,e,t,i=[];for(n in r.length,r)if(r.hasOwnProperty(n))for(e in t=r[n])t.hasOwnProperty(e)&&("object"!=typeof i[e]&&(i[e]=[]),i[e][n]=t[e]);return i},numeric.sLUP=function(r,n){throw new Error("The function numeric.sLUP had a bug in it and has been removed. Please use the new numeric.ccsLUP function instead.")},numeric.sdotMM=function(r,n){var e,t,i,o,u,c,a,f=r.length,s=(n.length,numeric.stranspose(n)),m=s.length,h=Array(f);for(i=f-1;i>=0;i--){for(a=[],e=r[i],u=m-1;u>=0;u--){for(o in c=0,t=s[u],e)e.hasOwnProperty(o)&&o in t&&(c+=e[o]*t[o]);c&&(a[u]=c)}h[i]=a}return h},numeric.sdotMV=function(r,n){var e,t,i,o,u=r.length,c=Array(u);for(t=u-1;t>=0;t--){for(i in o=0,e=r[t])e.hasOwnProperty(i)&&n[i]&&(o+=e[i]*n[i]);o&&(c[t]=o)}return c},numeric.sdotVM=function(r,n){var e,t,i,o,u=[];for(e in r)if(r.hasOwnProperty(e))for(t in i=n[e],o=r[e],i)i.hasOwnProperty(t)&&(u[t]||(u[t]=0),u[t]+=o*i[t]);return u},numeric.sdotVV=function(r,n){var e,t=0;for(e in r)r[e]&&n[e]&&(t+=r[e]*n[e]);return t},numeric.sdot=function(r,n){var e=numeric.sdim(r).length,t=numeric.sdim(n).length;switch(1e3*e+t){case 0:return r*n;case 1001:return numeric.sdotVV(r,n);case 2001:return numeric.sdotMV(r,n);case 1002:return numeric.sdotVM(r,n);case 2002:return numeric.sdotMM(r,n);default:throw new Error("numeric.sdot not implemented for tensors of order "+e+" and "+t)}},numeric.sscatter=function(r){var n,e,t,i,o=r[0].length,u=r.length,c=[];for(e=o-1;e>=0;--e)if(r[u-1][e]){for(i=c,t=0;t<u-2;t++)i[n=r[t][e]]||(i[n]=[]),i=i[n];i[r[t][e]]=r[t+1][e]}return c},numeric.sgather=function r(n,e,t){var i,o,u;for(o in void 0===e&&(e=[]),void 0===t&&(t=[]),i=t.length,n)if(n.hasOwnProperty(o))if(t[i]=parseInt(o),"number"==typeof(u=n[o])){if(u){if(0===e.length)for(o=i+1;o>=0;--o)e[o]=[];for(o=i;o>=0;--o)e[o].push(t[o]);e[i+1].push(u)}}else r(u,e,t);return t.length>i&&t.pop(),e},numeric.cLU=function(r){var n,e,t,i,o,u,c=r[0],a=r[1],f=r[2],s=c.length,m=0;for(n=0;n<s;n++)c[n]>m&&(m=c[n]);m++;var h,l=Array(m),p=Array(m),d=numeric.rep([m],1/0),g=numeric.rep([m],-1/0);for(t=0;t<s;t++)n=c[t],(e=a[t])<d[n]&&(d[n]=e),e>g[n]&&(g[n]=e);for(n=0;n<m-1;n++)g[n]>g[n+1]&&(g[n+1]=g[n]);for(n=m-1;n>=1;n--)d[n]<d[n-1]&&(d[n-1]=d[n]);for(n=0;n<m;n++)p[n]=numeric.rep([g[n]-d[n]+1],0),l[n]=numeric.rep([n-d[n]],0),d[n],g[n];for(t=0;t<s;t++)p[n=c[t]][a[t]-d[n]]=f[t];for(n=0;n<m-1;n++)for(i=n-d[n],x=p[n],e=n+1;d[e]<=n&&e<m;e++)if(o=n-d[e],u=g[n]-n,h=(w=p[e])[o]/x[i]){for(t=1;t<=u;t++)w[t+o]-=h*x[t+i];l[e][n-d[e]]=h}var v,y,x=[],w=[],b=[],_=[],M=[],k=[];for(s=0,v=0,n=0;n<m;n++){for(i=d[n],o=g[n],y=p[n],e=n;e<=o;e++)y[e-i]&&(x[s]=n,w[s]=e,b[s]=y[e-i],s++);for(y=l[n],e=i;e<n;e++)y[e-i]&&(_[v]=n,M[v]=e,k[v]=y[e-i],v++);_[v]=n,M[v]=n,k[v]=1,v++}return{U:[x,w,b],L:[_,M,k]}},numeric.cLUsolve=function(r,n){var e,t,i=r.L,o=r.U,u=numeric.clone(n),c=i[0],a=i[1],f=i[2],s=o[0],m=o[1],h=o[2],l=s.length,p=(c.length,u.length);for(t=0,e=0;e<p;e++){for(;a[t]<e;)u[e]-=f[t]*u[a[t]],t++;t++}for(t=l-1,e=p-1;e>=0;e--){for(;m[t]>e;)u[e]-=h[t]*u[m[t]],t--;u[e]/=h[t],t--}return u},numeric.cgrid=function(r,n){"number"==typeof r&&(r=[r,r]);var e,t,i,o=numeric.rep(r,-1);if("function"!=typeof n)switch(n){case"L":n=function(n,e){return n>=r[0]/2||e<r[1]/2};break;default:n=function(r,n){return!0}}for(i=0,e=1;e<r[0]-1;e++)for(t=1;t<r[1]-1;t++)n(e,t)&&(o[e][t]=i,i++);return o},numeric.cdelsq=function(r){var n,e,t,i,o,u=[[-1,0],[0,-1],[0,1],[1,0]],c=numeric.dim(r),a=c[0],f=c[1],s=[],m=[],h=[];for(n=1;n<a-1;n++)for(e=1;e<f-1;e++)if(!(r[n][e]<0)){for(t=0;t<4;t++)i=n+u[t][0],o=e+u[t][1],r[i][o]<0||(s.push(r[n][e]),m.push(r[i][o]),h.push(-1));s.push(r[n][e]),m.push(r[n][e]),h.push(4)}return[s,m,h]},numeric.cdotMV=function(r,n){var e,t,i,o=r[0],u=r[1],c=r[2],a=o.length;for(i=0,t=0;t<a;t++)o[t]>i&&(i=o[t]);for(i++,e=numeric.rep([i],0),t=0;t<a;t++)e[o[t]]+=c[t]*n[u[t]];return e},numeric.Spline=function(r,n,e,t,i){this.x=r,this.yl=n,this.yr=e,this.kl=t,this.kr=i},numeric.Spline.prototype._at=function(r,n){var e,t,i,o=this.x,u=this.yl,c=this.yr,a=this.kl,f=this.kr,s=numeric.add,m=numeric.sub,h=numeric.mul;e=m(h(a[n],o[n+1]-o[n]),m(c[n+1],u[n])),t=s(h(f[n+1],o[n]-o[n+1]),m(c[n+1],u[n]));var l=(i=(r-o[n])/(o[n+1]-o[n]))*(1-i);return s(s(s(h(1-i,u[n]),h(i,c[n+1])),h(e,l*(1-i))),h(t,l*i))},numeric.Spline.prototype.at=function(r){if("number"==typeof r){var n,e,t,i=this.x,o=i.length,u=Math.floor;for(n=0,e=o-1;e-n>1;)i[t=u((n+e)/2)]<=r?n=t:e=t;return this._at(r,n)}o=r.length;var c,a=Array(o);for(c=o-1;-1!==c;--c)a[c]=this.at(r[c]);return a},numeric.Spline.prototype.diff=function(){var r,n,e,t=this.x,i=this.yl,o=this.yr,u=this.kl,c=this.kr,a=i.length,f=u,s=c,m=Array(a),h=Array(a),l=numeric.add,p=numeric.mul,d=numeric.div,g=numeric.sub;for(r=a-1;-1!==r;--r)n=t[r+1]-t[r],e=g(o[r+1],i[r]),m[r]=d(l(p(e,6),p(u[r],-4*n),p(c[r+1],-2*n)),n*n),h[r+1]=d(l(p(e,-6),p(u[r],2*n),p(c[r+1],4*n)),n*n);return new numeric.Spline(t,f,s,m,h)},numeric.Spline.prototype.roots=function(){function r(r){return r*r}var n=[],e=this.x,t=this.yl,i=this.yr,o=this.kl,u=this.kr;"number"==typeof t[0]&&(t=[t],i=[i],o=[o],u=[u]);var c,a,f,s,m,h,l,p,d,g,v,y,x,w,b,_,M,k,A,j,T,S,q,P=t.length,V=e.length-1,E=(n=Array(P),Math.sqrt);for(c=0;c!==P;++c){for(s=t[c],m=i[c],h=o[c],l=u[c],p=[],a=0;a!==V;a++){for(a>0&&m[a]*s[a]<0&&p.push(e[a]),_=e[a+1]-e[a],e[a],v=s[a],y=m[a+1],d=h[a]/_,x=(g=l[a+1]/_)+3*v+2*d-3*y,w=3*(g+d+2*(v-y)),(b=r(d-g+3*(v-y))+12*g*v)<=0?M=(k=x/w)>e[a]&&k<e[a+1]?[e[a],k,e[a+1]]:[e[a],e[a+1]]:(k=(x-E(b))/w,A=(x+E(b))/w,M=[e[a]],k>e[a]&&k<e[a+1]&&M.push(k),A>e[a]&&A<e[a+1]&&M.push(A),M.push(e[a+1])),T=M[0],k=this._at(T,a),f=0;f<M.length-1;f++)if(S=M[f+1],A=this._at(S,a),0!==k)if(0===A||k*A>0)T=S,k=A;else{for(var N=0;!((q=(k*S-A*T)/(k-A))<=T||q>=S);)if((j=this._at(q,a))*A>0)S=q,A=j,-1===N&&(k*=.5),N=-1;else{if(!(j*k>0))break;T=q,k=j,1===N&&(A*=.5),N=1}p.push(q),T=M[f+1],k=this._at(T,a)}else p.push(T),T=S,k=A;0===A&&p.push(S)}n[c]=p}return"number"==typeof this.yl[0]?n[0]:n},numeric.spline=function(r,n,e,t){var i,o=r.length,u=[],c=[],a=[],f=numeric.sub,s=numeric.mul,m=numeric.add;for(i=o-2;i>=0;i--)c[i]=r[i+1]-r[i],a[i]=f(n[i+1],n[i]);"string"!=typeof e&&"string"!=typeof t||(e=t="periodic");var h=[[],[],[]];switch(typeof e){case"undefined":u[0]=s(3/(c[0]*c[0]),a[0]),h[0].push(0,0),h[1].push(0,1),h[2].push(2/c[0],1/c[0]);break;case"string":u[0]=m(s(3/(c[o-2]*c[o-2]),a[o-2]),s(3/(c[0]*c[0]),a[0])),h[0].push(0,0,0),h[1].push(o-2,0,1),h[2].push(1/c[o-2],2/c[o-2]+2/c[0],1/c[0]);break;default:u[0]=e,h[0].push(0),h[1].push(0),h[2].push(1)}for(i=1;i<o-1;i++)u[i]=m(s(3/(c[i-1]*c[i-1]),a[i-1]),s(3/(c[i]*c[i]),a[i])),h[0].push(i,i,i),h[1].push(i-1,i,i+1),h[2].push(1/c[i-1],2/c[i-1]+2/c[i],1/c[i]);switch(typeof t){case"undefined":u[o-1]=s(3/(c[o-2]*c[o-2]),a[o-2]),h[0].push(o-1,o-1),h[1].push(o-2,o-1),h[2].push(1/c[o-2],2/c[o-2]);break;case"string":h[1][h[1].length-1]=0;break;default:u[o-1]=t,h[0].push(o-1),h[1].push(o-1),h[2].push(1)}u="number"!=typeof u[0]?numeric.transpose(u):[u];var l=Array(u.length);if("string"==typeof e)for(i=l.length-1;-1!==i;--i)l[i]=numeric.ccsLUPSolve(numeric.ccsLUP(numeric.ccsScatter(h)),u[i]),l[i][o-1]=l[i][0];else for(i=l.length-1;-1!==i;--i)l[i]=numeric.cLUsolve(numeric.cLU(h),u[i]);return l="number"==typeof n[0]?l[0]:numeric.transpose(l),new numeric.Spline(r,n,n,l,l)},numeric.fftpow2=function r(n,e){var t=n.length;if(1!==t){var i,o,u=Math.cos,c=Math.sin,a=Array(t/2),f=Array(t/2),s=Array(t/2),m=Array(t/2);for(o=t/2,i=t-1;-1!==i;--i)s[--o]=n[i],m[o]=e[i],--i,a[o]=n[i],f[o]=e[i];r(a,f),r(s,m),o=t/2;var h,l,p,d=-6.283185307179586/t;for(i=t-1;-1!==i;--i)-1==--o&&(o=t/2-1),l=u(h=d*i),p=c(h),n[i]=a[o]+l*s[o]-p*m[o],e[i]=f[o]+l*m[o]+p*s[o]}},numeric._ifftpow2=function r(n,e){var t=n.length;if(1!==t){var i,o,u=Math.cos,c=Math.sin,a=Array(t/2),f=Array(t/2),s=Array(t/2),m=Array(t/2);for(o=t/2,i=t-1;-1!==i;--i)s[--o]=n[i],m[o]=e[i],--i,a[o]=n[i],f[o]=e[i];r(a,f),r(s,m),o=t/2;var h,l,p,d=6.283185307179586/t;for(i=t-1;-1!==i;--i)-1==--o&&(o=t/2-1),l=u(h=d*i),p=c(h),n[i]=a[o]+l*s[o]-p*m[o],e[i]=f[o]+l*m[o]+p*s[o]}},numeric.ifftpow2=function(r,n){numeric._ifftpow2(r,n),numeric.diveq(r,r.length),numeric.diveq(n,n.length)},numeric.convpow2=function(r,n,e,t){var i,o,u,c,a;for(numeric.fftpow2(r,n),numeric.fftpow2(e,t),i=r.length-1;-1!==i;--i)o=r[i],c=n[i],u=e[i],a=t[i],r[i]=o*u-c*a,n[i]=o*a+c*u;numeric.ifftpow2(r,n)},numeric.T.prototype.fft=function(){var r,n,e=this.x,t=this.y,i=e.length,o=Math.log,u=o(2),c=Math.ceil(o(2*i-1)/u),a=Math.pow(2,c),f=numeric.rep([a],0),s=numeric.rep([a],0),m=Math.cos,h=Math.sin,l=-3.141592653589793/i,p=numeric.rep([a],0),d=numeric.rep([a],0);for(Math.floor(i/2),r=0;r<i;r++)p[r]=e[r];if(void 0!==t)for(r=0;r<i;r++)d[r]=t[r];for(f[0]=1,r=1;r<=a/2;r++)n=l*r*r,f[r]=m(n),s[r]=h(n),f[a-r]=m(n),s[a-r]=h(n);var g=new numeric.T(p,d),v=new numeric.T(f,s);return g=g.mul(v),numeric.convpow2(g.x,g.y,numeric.clone(v.x),numeric.neg(v.y)),(g=g.mul(v)).x.length=i,g.y.length=i,g},numeric.T.prototype.ifft=function(){var r,n,e=this.x,t=this.y,i=e.length,o=Math.log,u=o(2),c=Math.ceil(o(2*i-1)/u),a=Math.pow(2,c),f=numeric.rep([a],0),s=numeric.rep([a],0),m=Math.cos,h=Math.sin,l=3.141592653589793/i,p=numeric.rep([a],0),d=numeric.rep([a],0);for(Math.floor(i/2),r=0;r<i;r++)p[r]=e[r];if(void 0!==t)for(r=0;r<i;r++)d[r]=t[r];for(f[0]=1,r=1;r<=a/2;r++)n=l*r*r,f[r]=m(n),s[r]=h(n),f[a-r]=m(n),s[a-r]=h(n);var g=new numeric.T(p,d),v=new numeric.T(f,s);return g=g.mul(v),numeric.convpow2(g.x,g.y,numeric.clone(v.x),numeric.neg(v.y)),(g=g.mul(v)).x.length=i,g.y.length=i,g.div(i)},numeric.gradient=function(r,n){var e=n.length,t=r(n);if(isNaN(t))throw new Error("gradient: f(x) is a NaN!");var i,o,u,c,a,f,s,m,h,l=Math.max,p=numeric.clone(n),d=Array(e),g=(numeric.div,numeric.sub,l=Math.max,Math.abs),v=Math.min,y=0;for(i=0;i<e;i++)for(var x=l(1e-6*t,1e-8);;){if(++y>20)throw new Error("Numerical gradient fails");if(p[i]=n[i]+x,o=r(p),p[i]=n[i]-x,u=r(p),p[i]=n[i],isNaN(o)||isNaN(u))x/=16;else{if(d[i]=(o-u)/(2*x),c=n[i]-x,a=n[i],f=n[i]+x,s=(o-t)/x,m=(t-u)/x,h=l(g(d[i]),g(t),g(o),g(u),g(c),g(a),g(f),1e-8),!(v(l(g(s-d[i]),g(m-d[i]),g(s-m))/h,x/h)>.001))break;x/=16}}return d},numeric.uncmin=function(r,n,e,t,i,o,u){var c=numeric.gradient;void 0===u&&(u={}),void 0===e&&(e=1e-8),void 0===t&&(t=function(n){return c(r,n)}),void 0===i&&(i=1e3);var a,f,s=(n=numeric.clone(n)).length,m=r(n);if(isNaN(m))throw new Error("uncmin: f(x0) is a NaN!");var h=Math.max,l=numeric.norm2;e=h(e,numeric.epsilon);var p,d,g,v,y,x,w,b,_,M,k=u.Hinv||numeric.identity(s),A=numeric.dot,j=(numeric.inv,numeric.sub),T=numeric.add,S=numeric.tensor,q=numeric.div,P=numeric.mul,V=numeric.all,E=numeric.isFinite,N=numeric.neg,L=0,F="";for(d=t(n);L<i;){if("function"==typeof o&&o(L,n,m,d,k)){F="Callback returned true";break}if(!V(E(d))){F="Gradient has Infinity or NaN";break}if(!V(E(p=N(A(k,d))))){F="Search direction has Infinity or NaN";break}if((M=l(p))<e){F="Newton step smaller than tol";break}for(_=1,f=A(d,p),y=n;L<i&&!(_*M<e)&&(y=T(n,v=P(p,_)),(a=r(y))-m>=.1*_*f||isNaN(a));)_*=.5,++L;if(_*M<e){F="Line search step size smaller than tol";break}if(L===i){F="maxit reached during line search";break}b=A(x=j(g=t(y),d),v),w=A(k,x),k=j(T(k,P((b+A(x,w))/(b*b),S(v,v))),q(T(S(w,v),S(v,w)),b)),n=y,m=a,d=g,++L}return{solution:n,f:m,gradient:d,invHessian:k,iterations:L,message:F}},numeric.Dopri=function(r,n,e,t,i,o,u){this.x=r,this.y=n,this.f=e,this.ymid=t,this.iterations=i,this.events=u,this.message=o},numeric.Dopri.prototype._at=function(r,n){function e(r){return r*r}var t,i,o,u,c,a,f,s,m,h=this,l=h.x,p=h.y,d=h.f,g=h.ymid,v=(l.length,Math.floor,numeric.add),y=numeric.mul,x=numeric.sub;return t=l[n],i=l[n+1],u=p[n],c=p[n+1],o=t+.5*(i-t),a=g[n],f=x(d[n],y(u,1/(t-o)+2/(t-i))),s=x(d[n+1],y(c,1/(i-o)+2/(i-t))),v(v(v(v(y(u,(m=[e(r-i)*(r-o)/e(t-i)/(t-o),e(r-t)*e(r-i)/e(t-o)/e(i-o),e(r-t)*(r-o)/e(i-t)/(i-o),(r-t)*e(r-i)*(r-o)/e(t-i)/(t-o),(r-i)*e(r-t)*(r-o)/e(t-i)/(i-o)])[0]),y(a,m[1])),y(c,m[2])),y(f,m[3])),y(s,m[4]))},numeric.Dopri.prototype.at=function(r){var n,e,t,i=Math.floor;if("number"!=typeof r){var o=r.length,u=Array(o);for(n=o-1;-1!==n;--n)u[n]=this.at(r[n]);return u}var c=this.x;for(n=0,e=c.length-1;e-n>1;)c[t=i(.5*(n+e))]<=r?n=t:e=t;return this._at(r,n)},numeric.dopri=function(r,n,e,t,i,o,u){void 0===i&&(i=1e-6),void 0===o&&(o=1e3);var c,a,f,s,m,h,l,p,d,g,v,y,x,w=[r],b=[e],_=[t(r,e)],M=[],k=[3/40,9/40],A=[44/45,-56/15,32/9],j=[19372/6561,-25360/2187,64448/6561,-212/729],T=[9017/3168,-355/33,46732/5247,49/176,-5103/18656],S=[35/384,0,500/1113,125/192,-2187/6784,11/84],q=[.10013431883002395,0,.3918321794184259,-.02982460176594817,.05893268337240795,-.04497888809104361,5618549.5/235043384],P=[.2,.3,.8,8/9,1,1],V=[-71/57600,0,71/16695,-71/1920,17253/339200,-22/525,1/40],E=0,N=(n-r)/10,L=0,F=numeric.add,D=numeric.mul,O=(Math.max,Math.min),U=Math.abs,R=numeric.norminf,B=Math.pow,C=numeric.any,I=numeric.lt,X=numeric.and,Q=(numeric.sub,new numeric.Dopri(w,b,_,M,-1,""));for("function"==typeof u&&(v=u(r,e));r<n&&L<o;)if(++L,r+N>n&&(N=n-r),c=t(r+P[0]*N,F(e,D(.2*N,_[E]))),a=t(r+P[1]*N,F(F(e,D(k[0]*N,_[E])),D(k[1]*N,c))),f=t(r+P[2]*N,F(F(F(e,D(A[0]*N,_[E])),D(A[1]*N,c)),D(A[2]*N,a))),s=t(r+P[3]*N,F(F(F(F(e,D(j[0]*N,_[E])),D(j[1]*N,c)),D(j[2]*N,a)),D(j[3]*N,f))),m=t(r+P[4]*N,F(F(F(F(F(e,D(T[0]*N,_[E])),D(T[1]*N,c)),D(T[2]*N,a)),D(T[3]*N,f)),D(T[4]*N,s))),h=t(r+N,d=F(F(F(F(F(e,D(_[E],N*S[0])),D(a,N*S[2])),D(f,N*S[3])),D(s,N*S[4])),D(m,N*S[5]))),(g="number"==typeof(l=F(F(F(F(F(D(_[E],N*V[0]),D(a,N*V[2])),D(f,N*V[3])),D(s,N*V[4])),D(m,N*V[5])),D(h,N*V[6])))?U(l):R(l))>i){if(r+(N=.2*N*B(i/g,.25))===r){Q.msg="Step size became too small";break}}else{if(M[E]=F(F(F(F(F(F(e,D(_[E],N*q[0])),D(a,N*q[2])),D(f,N*q[3])),D(s,N*q[4])),D(m,N*q[5])),D(h,N*q[6])),w[++E]=r+N,b[E]=d,_[E]=h,"function"==typeof u){var Y,z,Z=r,H=r+.5*N;if(y=u(H,M[E-1]),C(x=X(I(v,0),I(0,y)))||(Z=H,v=y,y=u(H=r+N,d),x=X(I(v,0),I(0,y))),C(x)){for(var G,W,$=0,J=1,K=1;;){if("number"==typeof v)z=(K*y*Z-J*v*H)/(K*y-J*v);else for(z=H,p=v.length-1;-1!==p;--p)v[p]<0&&y[p]>0&&(z=O(z,(K*y[p]*Z-J*v[p]*H)/(K*y[p]-J*v[p])));if(z<=Z||z>=H)break;W=u(z,Y=Q._at(z,E-1)),C(G=X(I(v,0),I(0,W)))?(H=z,y=W,x=G,K=1,-1===$?J*=.5:J=1,$=-1):(Z=z,v=W,J=1,1===$?K*=.5:K=1,$=1)}return d=Q._at(.5*(r+z),E-1),Q.f[E]=t(z,Y),Q.x[E]=z,Q.y[E]=Y,Q.ymid[E-1]=d,Q.events=x,Q.iterations=L,Q}}r+=N,e=d,v=y,N=O(.8*N*B(i/g,.25),4*N)}return Q.iterations=L,Q},numeric.LU=function(r,n){n=n||!1;var e,t,i,o,u,c,a,f,s,m=Math.abs,h=r.length,l=h-1,p=new Array(h);for(n||(r=numeric.clone(r)),i=0;i<h;++i){for(a=i,s=m((c=r[i])[i]),t=i+1;t<h;++t)s<(o=m(r[t][i]))&&(s=o,a=t);for(p[i]=a,a!=i&&(r[i]=r[a],r[a]=c,c=r[i]),u=c[i],e=i+1;e<h;++e)r[e][i]/=u;for(e=i+1;e<h;++e){for(f=r[e],t=i+1;t<l;++t)f[t]-=f[i]*c[t],f[++t]-=f[i]*c[t];t===l&&(f[t]-=f[i]*c[t])}}return{LU:r,P:p}},numeric.LUsolve=function(r,n){var e,t,i,o,u,c=r.LU,a=c.length,f=numeric.clone(n),s=r.P;for(e=a-1;-1!==e;--e)f[e]=n[e];for(e=0;e<a;++e)for(i=s[e],s[e]!==e&&(u=f[e],f[e]=f[i],f[i]=u),o=c[e],t=0;t<e;++t)f[e]-=f[t]*o[t];for(e=a-1;e>=0;--e){for(o=c[e],t=e+1;t<a;++t)f[e]-=f[t]*o[t];f[e]/=o[e]}return f},numeric.solve=function(r,n,e){return numeric.LUsolve(numeric.LU(r,e),n)},numeric.echelonize=function(r){var n,e,t,i,o,u,c,a,f=numeric.dim(r),s=f[0],m=f[1],h=numeric.identity(s),l=Array(s),p=Math.abs,d=numeric.diveq;for(r=numeric.clone(r),n=0;n<s;++n){for(t=0,o=r[n],u=h[n],e=1;e<m;++e)p(o[t])<p(o[e])&&(t=e);for(l[n]=t,d(u,o[t]),d(o,o[t]),e=0;e<s;++e)if(e!==n){for(a=(c=r[e])[t],i=m-1;-1!==i;--i)c[i]-=o[i]*a;for(c=h[e],i=s-1;-1!==i;--i)c[i]-=u[i]*a}}return{I:h,A:r,P:l}},numeric.__solveLP=function(r,n,e,t,i,o,u){var c,a,f,s,m=numeric.sum,h=(numeric.log,numeric.mul),l=numeric.sub,p=numeric.dot,d=numeric.div,g=numeric.add,v=r.length,y=e.length,x=!1,w=1,b=(numeric.transpose(n),numeric.svd,numeric.transpose),_=(numeric.leq,Math.sqrt),M=Math.abs,k=(numeric.muleq,numeric.norminf,numeric.any,Math.min),A=numeric.all,j=numeric.gt,T=Array(v),S=Array(y),q=(numeric.rep([y],1),numeric.solve),P=l(e,p(n,o)),V=p(r,r);for(f=0;f<i;++f){var E,N;for(E=y-1;-1!==E;--E)S[E]=d(n[E],P[E]);var L=b(S);for(E=v-1;-1!==E;--E)T[E]=m(L[E]);w=.25*M(V/p(r,T));var F=100*_(V/p(T,T));for((!isFinite(w)||w>F)&&(w=F),s=g(r,h(w,T)),a=p(L,S),E=v-1;-1!==E;--E)a[E][E]+=1;N=q(a,d(s,w),!0);var D=d(P,p(n,N)),O=1;for(E=y-1;-1!==E;--E)D[E]<0&&(O=k(O,-.999*D[E]));if(c=l(o,h(N,O)),!A(j(P=l(e,p(n,c)),0)))return{solution:o,message:"",iterations:f};if(o=c,w<t)return{solution:c,message:"",iterations:f};if(u){var U=p(r,s),R=p(n,s);for(x=!0,E=y-1;-1!==E;--E)if(U*R[E]<0){x=!1;break}}else x=!(o[v-1]>=0);if(x)return{solution:c,message:"Unbounded",iterations:f}}return{solution:o,message:"maximum iteration count exceeded",iterations:f}},numeric._solveLP=function(r,n,e,t,i){var o=r.length,u=e.length,c=(numeric.sum,numeric.log,numeric.mul,numeric.sub),a=numeric.dot,f=(numeric.div,numeric.add,numeric.rep([o],0).concat([1])),s=numeric.rep([u,1],-1),m=numeric.blockMatrix([[n,s]]),h=e,l=numeric.rep([o],0).concat(Math.max(0,numeric.sup(numeric.neg(e)))+1),p=numeric.__solveLP(f,m,h,t,i,l,!1),d=numeric.clone(p.solution);if(d.length=o,numeric.inf(c(e,a(n,d)))<0)return{solution:NaN,message:"Infeasible",iterations:p.iterations};var g=numeric.__solveLP(r,n,e,t,i-p.iterations,d,!0);return g.iterations+=p.iterations,g},numeric.solveLP=function(r,n,e,t,i,o,u){if(void 0===u&&(u=1e3),void 0===o&&(o=numeric.epsilon),void 0===t)return numeric._solveLP(r,n,e,o,u);var c,a=t.length,f=t[0].length,s=n.length,m=numeric.echelonize(t),h=numeric.rep([f],0),l=m.P,p=[];for(c=l.length-1;-1!==c;--c)h[l[c]]=1;for(c=f-1;-1!==c;--c)0===h[c]&&p.push(c);var d=numeric.getRange,g=numeric.linspace(0,a-1),v=numeric.linspace(0,s-1),y=d(t,g,p),x=d(n,v,l),w=d(n,v,p),b=numeric.dot,_=numeric.sub,M=b(x,m.I),k=_(w,b(M,y)),A=_(e,b(M,i)),j=Array(l.length),T=Array(p.length);for(c=l.length-1;-1!==c;--c)j[c]=r[l[c]];for(c=p.length-1;-1!==c;--c)T[c]=r[p[c]];var S=_(T,b(j,b(m.I,y))),q=numeric._solveLP(S,k,A,o,u),P=q.solution;if(P!=P)return q;var V=b(m.I,_(i,b(y,P))),E=Array(r.length);for(c=l.length-1;-1!==c;--c)E[l[c]]=V[c];for(c=p.length-1;-1!==c;--c)E[p[c]]=P[c];return{solution:E,message:q.message,iterations:q.iterations}},numeric.MPStoLP=function(r){r instanceof String&&r.split("\\n");var n,e,t,i,o=0,u=["Initial state","NAME","ROWS","COLUMNS","RHS","BOUNDS","ENDATA"],c=r.length,a=0,f={},s=[],m=0,h={},l=0,p=[],d=[],g=[];function v(e){throw new Error("MPStoLP: "+e+"\\nLine "+n+": "+r[n]+"\\nCurrent state: "+u[o]+"\\n")}for(n=0;n<c;++n){var y=(t=r[n]).match(/\\S*/g),x=[];for(e=0;e<y.length;++e)""!==y[e]&&x.push(y[e]);if(0!==x.length){for(e=0;e<u.length&&t.substr(0,u[e].length)!==u[e];++e);if(e<u.length){if(o=e,1===e&&(i=x[1]),6===e)return{name:i,c:p,A:numeric.transpose(d),b:g,rows:f,vars:h}}else switch(o){case 0:case 1:v("Unexpected line");case 2:switch(x[0]){case"N":0===a?a=x[1]:v("Two or more N rows");break;case"L":f[x[1]]=m,s[m]=1,g[m]=0,++m;break;case"G":f[x[1]]=m,s[m]=-1,g[m]=0,++m;break;case"E":f[x[1]]=m,s[m]=0,g[m]=0,++m;break;default:v("Parse error "+numeric.prettyPrint(x))}break;case 3:h.hasOwnProperty(x[0])||(h[x[0]]=l,p[l]=0,d[l]=numeric.rep([m],0),++l);var w=h[x[0]];for(e=1;e<x.length;e+=2)if(x[e]!==a){var b=f[x[e]];d[w][b]=(s[b]<0?-1:1)*parseFloat(x[e+1])}else p[w]=parseFloat(x[e+1]);break;case 4:for(e=1;e<x.length;e+=2)g[f[x[e]]]=(s[f[x[e]]]<0?-1:1)*parseFloat(x[e+1]);break;case 5:break;case 6:v("Internal error")}}}v("Reached end of file without ENDATA")},numeric.seedrandom={pow:Math.pow,random:Math.random},function(r,n,e,t,i,o,u){function c(r){var n,t,i=this,o=r.length,u=0,c=i.i=i.j=i.m=0;for(i.S=[],i.c=[],o||(r=[o++]);u<e;)i.S[u]=u++;for(u=0;u<e;u++)c=s(c+(n=i.S[u])+r[u%o]),t=i.S[c],i.S[u]=t,i.S[c]=n;i.g=function(r){var n=i.S,t=s(i.i+1),o=n[t],u=s(i.j+o),c=n[u];n[t]=c,n[u]=o;for(var a=n[s(o+c)];--r;)t=s(t+1),c=n[u=s(u+(o=n[t]))],n[t]=c,n[u]=o,a=a*e+n[s(o+c)];return i.i=t,i.j=u,a},i.g(e)}function a(r,n,e,t,i){if(e=[],i=typeof r,n&&"object"==i)for(t in r)if(t.indexOf("S")<5)try{e.push(a(r[t],n-1))}catch(r){}return e.length?e:r+("string"!=i?"\\0":"")}function f(r,n,e,t){for(r+="",e=0,t=0;t<r.length;t++)n[s(t)]=s((e^=19*n[s(t)])+r.charCodeAt(t));for(t in r="",n)r+=String.fromCharCode(n[t]);return r}function s(r){return 255&r}n.seedrandom=function(t,s){var m,h=[];return t=f(a(s?[t,r]:arguments.length?t:[(new Date).getTime(),r,window],3),h),f((m=new c(h)).S,r),n.random=function(){for(var r=m.g(6),n=u,t=0;r<i;)r=(r+t)*e,n*=e,t=m.g(1);for(;r>=o;)r/=2,n/=2,t>>>=1;return(r+t)/n},t},u=n.pow(e,6),i=n.pow(2,i),o=2*i,f(n.random(),r)}([],numeric.seedrandom,256,0,52),function(r){function n(r){if("object"!=typeof r)return r;var e,t=[],i=r.length;for(e=0;e<i;e++)t[e+1]=n(r[e]);return t}function e(r){if("object"!=typeof r)return r;var n,t=[],i=r.length;for(n=1;n<i;n++)t[n-1]=e(r[n]);return t}r.solveQP=function(r,t,i,o,u,c){r=n(r),t=n(t),i=n(i);var a,f,s,m,h,l=[],p=[],d=[],g=[],v=[];if(u=u||0,c=c?n(c):[void 0,0],o=o?n(o):[],f=r.length-1,s=i[1].length-1,!o)for(a=1;a<=s;a+=1)o[a]=0;for(a=1;a<=s;a+=1)p[a]=0;for(m=Math.min(f,s),a=1;a<=f;a+=1)d[a]=0;for(l[1]=0,a=1;a<=2*f+m*(m+5)/2+2*s+1;a+=1)g[a]=0;for(a=1;a<=2;a+=1)v[a]=0;return function(r,n,e,t,i,o,u,c,a,f,s,m,h,l,p,d){var g,v,y,x,w,b,_,M,k,A,j,T,S,q,P,V,E,N,L,F,D,O,U,R,B,C,I;S=Math.min(t,f),y=2*t+S*(S+5)/2+2*f+1,R=1e-60;do{B=1+.1*(R+=R),C=1+.2*R}while(B<=1||C<=1);for(g=1;g<=t;g+=1)p[g]=n[g];for(g=t+1;g<=y;g+=1)p[g]=0;for(g=1;g<=f;g+=1)m[g]=0;if(w=[],0===d[1]){if(function(r,n,e,t){var i,o,u,c,a,f;for(o=1;o<=e;o+=1){if(t[1]=o,f=0,(u=o-1)<1){if((f=r[o][o]-f)<=0)break;r[o][o]=Math.sqrt(f)}else{for(c=1;c<=u;c+=1){for(a=r[c][o],i=1;i<c;i+=1)a-=r[i][o]*r[i][c];a/=r[c][c],r[c][o]=a,f+=a*a}if((f=r[o][o]-f)<=0)break;r[o][o]=Math.sqrt(f)}t[1]=0}}(r,0,t,w),0!==w[1])return void(d[1]=2);!function(r,n,e,t){var i,o,u,c;for(o=1;o<=e;o+=1){for(c=0,i=1;i<o;i+=1)c+=r[i][o]*t[i];t[o]=(t[o]-c)/r[o][o]}for(u=1;u<=e;u+=1)for(t[o=e+1-u]=t[o]/r[o][o],c=-t[o],i=1;i<o;i+=1)t[i]=t[i]+c*r[i][o]}(r,0,t,n),function(r,n,e){var t,i,o,u,c;for(o=1;o<=e;o+=1){for(r[o][o]=1/r[o][o],c=-r[o][o],t=1;t<o;t+=1)r[t][o]=c*r[t][o];if(e<(u=o+1))break;for(i=u;i<=e;i+=1)for(c=r[o][i],r[o][i]=0,t=1;t<=o;t+=1)r[t][i]=r[t][i]+c*r[t][o]}}(r,0,t)}else{for(v=1;v<=t;v+=1)for(i[v]=0,g=1;g<=v;g+=1)i[v]=i[v]+r[g][v]*n[g];for(v=1;v<=t;v+=1)for(n[v]=0,g=v;g<=t;g+=1)n[v]=n[v]+r[v][g]*i[g]}for(o[1]=0,v=1;v<=t;v+=1)for(i[v]=n[v],o[1]=o[1]+p[v]*i[v],p[v]=0,g=v+1;g<=t;g+=1)r[g][v]=0;for(o[1]=-o[1]/2,d[1]=0,q=(A=(k=(j=(M=(_=t)+t)+S)+S+1)+S*(S+1)/2)+f,g=1;g<=f;g+=1){for(V=0,v=1;v<=t;v+=1)V+=u[v][g]*u[v][g];p[q+g]=Math.sqrt(V)}function X(){for(l[1]=l[1]+1,y=A,g=1;g<=f;g+=1){for(y+=1,V=-c[g],v=1;v<=t;v+=1)V+=u[v][g]*i[v];if(Math.abs(V)<R&&(V=0),g>s)p[y]=V;else if(p[y]=-Math.abs(V),V>0){for(v=1;v<=t;v+=1)u[v][g]=-u[v][g];c[g]=-c[g]}}for(g=1;g<=h;g+=1)p[A+m[g]]=0;for(T=0,P=0,g=1;g<=f;g+=1)p[A+g]<P*p[q+g]&&(T=g,P=p[A+g]/p[q+g]);return 0===T?999:0}function Q(){for(g=1;g<=t;g+=1){for(V=0,v=1;v<=t;v+=1)V+=r[v][g]*u[v][T];p[g]=V}for(x=_,g=1;g<=t;g+=1)p[x+g]=0;for(v=h+1;v<=t;v+=1)for(g=1;g<=t;g+=1)p[x+g]=p[x+g]+r[g][v]*p[v];for(O=!0,g=h;g>=1;g-=1){for(V=p[g],x=(y=k+g*(g+3)/2)-g,v=g+1;v<=h;v+=1)V-=p[y]*p[M+v],y+=v;if(V/=p[x],p[M+g]=V,m[g]<s)break;if(V<0)break;O=!1,b=g}if(!O)for(E=p[j+b]/p[M+b],g=1;g<=h&&!(m[g]<s)&&!(p[M+g]<0);g+=1)(P=p[j+g]/p[M+g])<E&&(E=P,b=g);for(V=0,g=_+1;g<=_+t;g+=1)V+=p[g]*p[g];if(Math.abs(V)<=R){if(O)return d[1]=1,999;for(g=1;g<=h;g+=1)p[j+g]=p[j+g]-E*p[M+g];return p[j+h+1]=p[j+h+1]+E,700}for(V=0,g=1;g<=t;g+=1)V+=p[_+g]*u[g][T];for(N=-p[A+T]/V,U=!0,O||E<N&&(N=E,U=!1),g=1;g<=t;g+=1)i[g]=i[g]+N*p[_+g],Math.abs(i[g])<R&&(i[g]=0);for(o[1]=o[1]+N*V*(N/2+p[j+h+1]),g=1;g<=h;g+=1)p[j+g]=p[j+g]-N*p[M+g];if(p[j+h+1]=p[j+h+1]+N,!U){for(V=-c[T],v=1;v<=t;v+=1)V+=i[v]*u[v][T];if(T>s)p[A+T]=V;else if(p[A+T]=-Math.abs(V),V>0){for(v=1;v<=t;v+=1)u[v][T]=-u[v][T];c[T]=-c[T]}return 700}for(m[h+=1]=T,y=k+(h-1)*h/2+1,g=1;g<=h-1;g+=1)p[y]=p[g],y+=1;if(h===t)p[y]=p[t];else{for(g=t;g>=h+1&&0!==p[g]&&(L=Math.max(Math.abs(p[g-1]),Math.abs(p[g])),F=Math.min(Math.abs(p[g-1]),Math.abs(p[g])),P=p[g-1]>=0?Math.abs(L*Math.sqrt(1+F*F/(L*L))):-Math.abs(L*Math.sqrt(1+F*F/(L*L))),L=p[g-1]/P,F=p[g]/P,1!==L);g-=1)if(0===L)for(p[g-1]=F*P,v=1;v<=t;v+=1)P=r[v][g-1],r[v][g-1]=r[v][g],r[v][g]=P;else for(p[g-1]=P,D=F/(1+L),v=1;v<=t;v+=1)P=L*r[v][g-1]+F*r[v][g],r[v][g]=D*(r[v][g-1]+P)-r[v][g],r[v][g-1]=P;p[y]=p[h]}return 0}function Y(){if(0===p[x=(y=k+b*(b+1)/2+1)+b])return 798;if(L=Math.max(Math.abs(p[x-1]),Math.abs(p[x])),F=Math.min(Math.abs(p[x-1]),Math.abs(p[x])),P=p[x-1]>=0?Math.abs(L*Math.sqrt(1+F*F/(L*L))):-Math.abs(L*Math.sqrt(1+F*F/(L*L))),L=p[x-1]/P,F=p[x]/P,1===L)return 798;if(0===L){for(g=b+1;g<=h;g+=1)P=p[x-1],p[x-1]=p[x],p[x]=P,x+=g;for(g=1;g<=t;g+=1)P=r[g][b],r[g][b]=r[g][b+1],r[g][b+1]=P}else{for(D=F/(1+L),g=b+1;g<=h;g+=1)P=L*p[x-1]+F*p[x],p[x]=D*(p[x-1]+P)-p[x],p[x-1]=P,x+=g;for(g=1;g<=t;g+=1)P=L*r[g][b]+F*r[g][b+1],r[g][b+1]=D*(r[g][b]+P)-r[g][b+1],r[g][b]=P}return 0}function z(){for(x=y-b,g=1;g<=b;g+=1)p[x]=p[y],y+=1,x+=1;return p[j+b]=p[j+b+1],m[b]=m[b+1],(b+=1)<h?797:0}function Z(){return p[j+h]=p[j+h+1],p[j+h+1]=0,m[h]=0,h-=1,l[2]=l[2]+1,0}for(h=0,l[1]=0,l[2]=0,I=0;;){if(999===(I=X()))return;for(;0!==(I=Q());){if(999===I)return;if(700===I)if(b===h)Z();else{for(;Y(),797===(I=z()););Z()}}}}(r,t,0,f,d,l,i,o,0,s,u,p,0,v,g,c),h="",1===c[1]&&(h="constraints are inconsistent, no solution!"),2===c[1]&&(h="matrix D in quadratic function is not positive definite!"),{solution:e(d),value:e(l),unconstrained_solution:e(t),iterations:e(v),iact:e(p),message:h}}}(numeric),numeric.svd=function(r){var n,e=numeric.epsilon,t=1e-64/e,i=0,o=0,u=0,c=0,a=0,f=numeric.clone(r),s=f.length,m=f[0].length;if(s<m)throw"Need more rows than columns";var h=new Array(m),l=new Array(m);for(o=0;o<m;o++)h[o]=l[o]=0;var p=numeric.rep([m,m],0);function d(r,n){return(r=Math.abs(r))>(n=Math.abs(n))?r*Math.sqrt(1+n*n/r/r):0==n?r:n*Math.sqrt(1+r*r/n/n)}var g=0,v=0,y=0,x=0,w=0,b=0,_=0;for(o=0;o<m;o++){for(h[o]=v,_=0,a=o+1,u=o;u<s;u++)_+=f[u][o]*f[u][o];if(_<=t)v=0;else for(g=f[o][o],v=Math.sqrt(_),g>=0&&(v=-v),y=g*v-_,f[o][o]=g-v,u=a;u<m;u++){for(_=0,c=o;c<s;c++)_+=f[c][o]*f[c][u];for(g=_/y,c=o;c<s;c++)f[c][u]+=g*f[c][o]}for(l[o]=v,_=0,u=a;u<m;u++)_+=f[o][u]*f[o][u];if(_<=t)v=0;else{for(g=f[o][o+1],v=Math.sqrt(_),g>=0&&(v=-v),y=g*v-_,f[o][o+1]=g-v,u=a;u<m;u++)h[u]=f[o][u]/y;for(u=a;u<s;u++){for(_=0,c=a;c<m;c++)_+=f[u][c]*f[o][c];for(c=a;c<m;c++)f[u][c]+=_*h[c]}}(w=Math.abs(l[o])+Math.abs(h[o]))>x&&(x=w)}for(o=m-1;-1!=o;o+=-1){if(0!=v){for(y=v*f[o][o+1],u=a;u<m;u++)p[u][o]=f[o][u]/y;for(u=a;u<m;u++){for(_=0,c=a;c<m;c++)_+=f[o][c]*p[c][u];for(c=a;c<m;c++)p[c][u]+=_*p[c][o]}}for(u=a;u<m;u++)p[o][u]=0,p[u][o]=0;p[o][o]=1,v=h[o],a=o}for(o=m-1;-1!=o;o+=-1){for(a=o+1,v=l[o],u=a;u<m;u++)f[o][u]=0;if(0!=v){for(y=f[o][o]*v,u=a;u<m;u++){for(_=0,c=a;c<s;c++)_+=f[c][o]*f[c][u];for(g=_/y,c=o;c<s;c++)f[c][u]+=g*f[c][o]}for(u=o;u<s;u++)f[u][o]=f[u][o]/v}else for(u=o;u<s;u++)f[u][o]=0;f[o][o]+=1}for(e*=x,c=m-1;-1!=c;c+=-1)for(var M=0;M<50;M++){var k=!1;for(a=c;-1!=a;a+=-1){if(Math.abs(h[a])<=e){k=!0;break}if(Math.abs(l[a-1])<=e)break}if(!k){i=0,_=1;var A=a-1;for(o=a;o<c+1&&(g=_*h[o],h[o]=i*h[o],!(Math.abs(g)<=e));o++)for(y=d(g,v=l[o]),l[o]=y,i=v/y,_=-g/y,u=0;u<s;u++)w=f[u][A],b=f[u][o],f[u][A]=w*i+b*_,f[u][o]=-w*_+b*i}if(b=l[c],a==c){if(b<0)for(l[c]=-b,u=0;u<m;u++)p[u][c]=-p[u][c];break}if(M>=49)throw"Error: no convergence.";for(x=l[a],v=d(g=(((w=l[c-1])-b)*(w+b)+((v=h[c-1])-(y=h[c]))*(v+y))/(2*y*w),1),g=g<0?((x-b)*(x+b)+y*(w/(g-v)-y))/x:((x-b)*(x+b)+y*(w/(g+v)-y))/x,i=1,_=1,o=a+1;o<c+1;o++){for(v=h[o],w=l[o],y=_*v,v*=i,b=d(g,y),h[o-1]=b,g=x*(i=g/b)+v*(_=y/b),v=-x*_+v*i,y=w*_,w*=i,u=0;u<m;u++)x=p[u][o-1],b=p[u][o],p[u][o-1]=x*i+b*_,p[u][o]=-x*_+b*i;for(b=d(g,y),l[o-1]=b,g=(i=g/b)*v+(_=y/b)*w,x=-_*v+i*w,u=0;u<s;u++)w=f[u][o-1],b=f[u][o],f[u][o-1]=w*i+b*_,f[u][o]=-w*_+b*i}h[a]=0,h[c]=g,l[c]=x}for(o=0;o<l.length;o++)l[o]<e&&(l[o]=0);for(o=0;o<m;o++)for(u=o-1;u>=0;u--)if(l[u]<l[o]){for(i=l[u],l[u]=l[o],l[o]=i,c=0;c<f.length;c++)n=f[c][o],f[c][o]=f[c][u],f[c][u]=n;for(c=0;c<p.length;c++)n=p[c][o],p[c][o]=p[c][u],p[c][u]=n;o=u}return{U:f,S:l,V:p}}}},__webpack_module_cache__={};function __webpack_require__(r){var n=__webpack_module_cache__[r];if(void 0!==n)return n.exports;var e=__webpack_module_cache__[r]={exports:{}};return __webpack_modules__[r](e,e.exports,__webpack_require__),e.exports}__webpack_require__.d=(r,n)=>{for(var e in n)__webpack_require__.o(n,e)&&!__webpack_require__.o(r,e)&&Object.defineProperty(r,e,{enumerable:!0,get:n[e]})},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(r){if("object"==typeof window)return window}}(),__webpack_require__.o=(r,n)=>Object.prototype.hasOwnProperty.call(r,n),__webpack_require__.r=r=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})};var __webpack_exports__=__webpack_require__(311)})();',"Worker",void 0,void 0)}},810:(module,__unused_webpack_exports,__webpack_require__)=>{var _regeneratorRuntime=__webpack_require__(757),_slicedToArray=__webpack_require__(38),_asyncToGenerator=__webpack_require__(926),_classCallCheck=__webpack_require__(575),_createClass=__webpack_require__(913),privateWt=__webpack_require__(746),imgData=__webpack_require__(212),strided=__webpack_require__(482),matrixPassword=__webpack_require__(359),stringCode=__webpack_require__(484),mixWatermark=__webpack_require__(441),WaterMark=function(){"use strict";function WaterMark(){_classCallCheck(this,WaterMark),this.blockShape=8,this.imgHandle=imgData,this.mixWatermark=mixWatermark}var _addWm,_mixWm,_readWm,_readImg;return _createClass(WaterMark,[{key:"resetData",value:function(){this.lowChannel=[],this.heightChannel=[],this.wmBoolList=[],this.addWidth=!1,this.addHeight=!1}},{key:"readImg",value:(_readImg=_asyncToGenerator(_regeneratorRuntime.mark((function r(e){var n,t,i,o,u,c,a,f=this;return _regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.imgHandle.getData(e,!0);case 2:n=r.sent,t=n.width,i=n.height,o=n.R2d,u=n.G2d,c=n.B2d,a=n.A1d,this.A1d=a,this.width=t,this.height=i,t%2!=0&&(this.addWidth=!0,o=o.map((function(r){return r[t]=0,r})),u=u.map((function(r){return r[t]=0,r})),c=c.map((function(r){return r[t]=0,r}))),i%2!=0&&(this.addHeight=!0,o[i]=new Array(t).fill(0),u[i]=new Array(t).fill(0),c[i]=new Array(t).fill(0)),[o,u,c].forEach((function(r,e){var n=privateWt.dwt(r),t=_slicedToArray(n,2),i=t[0],o=t[1];f.lowChannel[e]=i,f.heightChannel[e]=o}));case 15:case"end":return r.stop()}}),r,this)}))),function(r){return _readImg.apply(this,arguments)})},{key:"readWm",value:(_readWm=_asyncToGenerator(_regeneratorRuntime.mark((function r(e){var n,t,i,o,u,c,a,f,s,m,h,l,p,g=arguments;return _regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=g.length>1&&void 0!==g[1]?g[1]:"bool",e){r.next=3;break}return r.abrupt("return",Promise.reject("参数错误：请输入水印"));case 3:if("bool"!==n){r.next=15;break}if(!e.find((function(r){return"boolean"!=typeof r}))){r.next=6;break}return r.abrupt("return",Promise.reject("参数错误：水印中存在非布尔值，请检查"));case 6:if(t=this.width,i=this.height,o=this.blockShape,u=Math.floor((t+1)/(2*o)),c=Math.floor((i+1)/o),a=u*c,!(e.length>a)){r.next=12;break}return r.abrupt("return",Promise.reject("最多可嵌入".concat(a/1e3,"kb信息，当前信息过大约为").concat(e.length/1e3)));case 12:return this.wmBoolList=e,this.wmLength=e.length,r.abrupt("return");case 15:if("string"!==n){r.next=19;break}return f=stringCode.str2charCode(e),s=f.split("").map((function(r){return 1==r})),r.abrupt("return",this.readWm(s,"bool"));case 19:if("img"!==n){r.next=28;break}return r.next=22,this.imgHandle.getTwoEnds(e);case 22:return m=r.sent,h=m.width,l=m.height,p=m.data,this.imgWmSize=[h,l],r.abrupt("return",this.readWm(p,"bool"));case 28:return r.abrupt("return",Promise.reject("参数错误：水印类型错误，请输入 bool | string | img, 当前为 ".concat(n)));case 29:case"end":return r.stop()}}),r,this)}))),function(r){return _readWm.apply(this,arguments)})},{key:"mixWm",value:(_mixWm=_asyncToGenerator(_regeneratorRuntime.mark((function r(e){var n,t,i,o,u,c,a,f,s,m,h,l,p,g,d,v;return _regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=e.name,t=e.download,e.outputPath,0!==this.wmBoolList.length){r.next=3;break}return r.abrupt("return");case 3:return i=this.A1d,o=this.width,u=this.height,c=this.lowChannel,a=this.heightChannel,f=this.wmBoolList,s=this.addHeight,m=this.addWidth,h=this.blockShape,r.next=6,this.mixWatermark({lowChannel:c,heightChannel:a,wmBoolList:f,addHeight:s,addWidth:m,blockShape:h});case 6:return l=r.sent,p=_slicedToArray(l,3),g=p[0],d=p[1],v=p[2],this.resetData(),r.next=14,this.imgHandle.setData({R:g,G:d,B:v,A:i,width:o,height:u,download:t,name:n});case 14:return r.abrupt("return",r.sent);case 15:case"end":return r.stop()}}),r,this)}))),function(r){return _mixWm.apply(this,arguments)})},{key:"getWmResult",value:function(r,e,n,t,i){if("bool"===e)return r;if("string"===e){var o=r.map((function(r){return Number(r)})).join("");return stringCode.charCode2str(o)}if("img"===e){var u=_slicedToArray(n,2),c=u[0],a=u[1];this.imgHandle.setTwoEnds({data:r,width:c,height:a,name:t,outputPath:i})}}},{key:"extract",value:function(){var _extract=_asyncToGenerator(_regeneratorRuntime.mark((function _callee4(_ref2){var wmImg,wmLength,wmType,name,outputPath,currentTypeWmLength,passWordList,fullRowNun,fullColumnNun,lowChannel,blockShape,channelWm,wmList,result;return _regeneratorRuntime.wrap((function _callee4$(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:if(wmImg=_ref2.wmImg,wmLength=_ref2.wmLength,wmType=_ref2.wmType,name=_ref2.name,outputPath=_ref2.outputPath,wmLength){_context4.next=3;break}return _context4.abrupt("return",Promise.reject("参数错误：请输入水印长度, 水印类型为 string bool 时，wmLength 输入数字，水印类型为 img 时，wmLength 为二维数组代表图片宽高 [width, height]"));case 3:if("string"!==wmType&&"bool"!==wmType){_context4.next=6;break}if(!isNaN(Number(wmLength))){_context4.next=6;break}return _context4.abrupt("return",Promise.reject("参数错误：wmLength 需为数字，代表水印长度"));case 6:if("img"!==wmType){_context4.next=9;break}if(Array.isArray(wmLength)&&2===wmLength.length){_context4.next=9;break}return _context4.abrupt("return",Promise.reject("参数错误：wmLength 需为数组，[width, height]"));case 9:return currentTypeWmLength=wmLength,"string"===wmType&&(currentTypeWmLength=16*wmLength),"img"===wmType&&(currentTypeWmLength=wmLength[0]*wmLength[1]),this.resetData(),_context4.next=15,this.readImg(wmImg);case 15:return passWordList=[],lowChannel=this.lowChannel,blockShape=this.blockShape,lowChannel=lowChannel.map((function(r){var e=strided.strided4(r,blockShape);return fullRowNun=e.fullRowNun,fullColumnNun=e.fullColumnNun,e.result})),channelWm=lowChannel.map((function(r){for(var e=[],n=0,t=0;t<fullRowNun;t++)for(var i=0;i<fullColumnNun;i++){var o=r[t][i],u=matrixPassword.decode(o),c=[n%currentTypeWmLength];passWordList[c]||(passWordList[c]=[]),passWordList[c].push(u),n++,e.push(u)}return e})),wmList=passWordList.map((function(arr){return eval(arr.join("+"))/arr.length>.5})),result=this.getWmResult(wmList,wmType,wmLength,name,outputPath),_context4.abrupt("return",new Promise((function(r,e){r({wm:result})})));case 22:case"end":return _context4.stop()}}),_callee4,this)})));function extract(r){return _extract.apply(this,arguments)}return extract}()},{key:"addWm",value:(_addWm=_asyncToGenerator(_regeneratorRuntime.mark((function r(e){var n,t,i,o,u,c,a=this;return _regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=e.originImg,t=e.wm,i=e.wmType,o=e.name,u=e.download,c=e.outputPath,this.resetData(),r.abrupt("return",new Promise(function(){var r=_asyncToGenerator(_regeneratorRuntime.mark((function r(e,f){return _regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:a.readImg(n).then((function(){return a.readWm(t,i)})).then((function(){return a.mixWm({name:o,download:u,outputPath:c}).catch((function(r){return f(r)}))})).then((function(r){var n=r.File,t=r.base64,o=r.filePath,u=a.wmLength;"img"===i&&(u=a.imgWmSize),e({wmLength:u,File:n,base64:t,filePath:o})})).catch((function(r){return f(r)}));case 1:case"end":return r.stop()}}),r)})));return function(e,n){return r.apply(this,arguments)}}()));case 3:case"end":return r.stop()}}),r,this)}))),function(r){return _addWm.apply(this,arguments)})}]),WaterMark}();module.exports=WaterMark},416:(r,e,n)=>{var t=new(n(810));r.exports=t},441:(r,e,n)=>{var t=n(713),i=n(38);function o(r,e){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(r);e&&(t=t.filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.push.apply(n,t)}return n}function u(r){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?o(Object(n),!0).forEach((function(e){t(r,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(n,e))}))}return r}var c=n(523),a=n(144),f=function(){var r;return[new Promise((function(e,n){r=function(r){e(r)}})),r]};r.exports=function(r){var e=r.heightChannel,n=r.lowChannel;if("node"===r.type||!window.Worker)return c(r);var t=f(),o=i(t,2),s=o[0],m=o[1],h=f(),l=i(h,2),p=l[0],g=l[1],d=f(),v=i(d,2),y=v[0],x=[m,g,v[1]];return n.forEach((function(t,i){var o=new a.default;o.postMessage(u(u({},r),{},{lowChannel:[n[i]],heightChannel:[e[i]]})),o.onmessage=function(r){x[i](r.data[0])}})),Promise.all([s,p,y])}},523:(r,e,n)=>{var t=n(38),i=n(359),o=n(482),u=n(746);r.exports=function(r){var e,n,c=r.lowChannel,a=r.heightChannel,f=r.wmBoolList,s=r.addHeight,m=r.addWidth,h=r.blockShape,l=f.length;(c=c.map((function(r){var t=o.strided4(r,h);return e=t.fullRowNun,n=t.fullColumnNun,t.result}))).forEach((function(r){for(var t=0,o=0;o<e;o++)for(var u=0;u<n;u++){var c=r[o][u],a=f[t%l];t++,r[o][u]=i.encode(c,a)}}));var p=c.map((function(r,e){var n=o.spreadStrided4(r),t=u.idwt(n,a[e]);return s&&t.pop(),m&&t.forEach((function(r){return r.pop()})),t})),g=t(p,3),d=g[0],v=g[1],y=g[2];return Promise.resolve([d,v,y])}},295:(r,e,n)=>{var t=n(319);r.exports=function(){for(var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1?arguments[1]:void 0,n=t(r),i=[],o=0,u=n.length;o<u;o+=e){var c=r.slice(o,o+e);c.length&&i.push(c)}return i}},212:(r,e,n)=>{var t=n(757),i=n(926),o=n(319),u=function(r){return r?Promise.resolve(r.flat()):[]},c=function(r){return r>255?255:r<0?0:r};function a(r){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=r.split(","),t=n[0].match(/:(.*?);/)[1],i=atob(n[1]),o=i.length,u=new Uint8Array(o);o--;)u[o]=i.charCodeAt(o);var c=new Blob([u],{type:t});return new window.File([c],e,{type:t})}var f=function(r){try{r.dispatchEvent(new MouseEvent("click"))}catch(n){var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),r.dispatchEvent(e)}},s=function(){var r="sherry-chris-b-wm-g-i-c-c",e=document.getElementById(r);if(!e){var n=document.createElement("canvas");n.style.opacity=0,n.style.position="absolute",n.style.left="-999999px",n.id=r,document.body.appendChild(n),e=n}return e},m=function(r,e){return r instanceof FileList&&(r=r[0]),r instanceof File&&r.type.includes("image")?new Promise((function(n){var t=new Image;t.onload=function(){n(h(t,e))},t.src=window.URL.createObjectURL(r)})):Promise.resolve(h(r,e))},h=function(r,e){if(!r.tagName||"img"!==r.tagName.toLowerCase())return Promise.reject("未传入图片dom");if(0===r.width||0===r.height)return Promise.reject("请输入宽高不为0的有效图片");var n=s();n.width=r.width,n.height=r.height;var t=n.getContext("2d");t.drawImage(r,0,0);var i=t.getImageData(0,0,r.width,r.height),o=i.data,u=i.width,c=i.height,a=[],f=[],m=[],h=[],l=[],p=[],g=[],d=[],v=[a,f,m,h],y=[l,p,g,d];return o.forEach((function(r,n){var t=n%4,i=Math.floor(n/4);e&&3!==t&&255==+r&&(r=254);var o=Math.floor(i/u),c=i%u;v[t][o]||(v[t][o]=[]),y[t][i]=r,v[t][o][c]=r})),{width:u,height:c,R2d:a,G2d:f,B2d:m,A2d:h,R1d:l,G1d:p,B1d:g,A1d:d}},l=function(){var r=i(t.mark((function r(e){var n,i,o,m,h,l,p,g,d,v,y,x,w,b,_,M,k,T,j,A,S,P,L,E,q,N;return t.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=e.R,i=e.G,o=e.B,m=e.A,h=void 0===m?[]:m,l=e.width,p=e.height,g=e.downLoad,d=void 0===g||g,v=e.name,y=void 0===v?"download":v,r.next=3,u(n);case 3:return x=r.sent,r.next=6,u(i);case 6:return w=r.sent,r.next=9,u(o);case 9:for(b=r.sent,_=h,(M=s()).width=l,M.height=p,k=M.getContext("2d"),T=k.createImageData(l,p),j=0;j<_.length;j++)A=4*j,S=Math.round(x[j])||0,P=Math.round(w[j])||0,L=Math.round(b[j])||0,E=Math.round(_[j])||255,T.data[A]=c(S),T.data[A+1]=c(P),T.data[A+2]=c(L),T.data[A+3]=c(E);return k.putImageData(T,0,0),q=M.toDataURL(),d&&((N=document.createElement("a")).href=q,N.download=y,setTimeout((function(){window.URL.revokeObjectURL(N.href)}),4e4),setTimeout((function(){f(N)}),0)),r.abrupt("return",{File:a(q,y),base64:q});case 21:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}(),p=function(){var r=i(t.mark((function r(e){var n,i,o,u,c,a,f,s;return t.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,m(e);case 2:return n=r.sent,i=n.width,o=n.height,u=n.R1d,c=n.G1d,a=n.B1d,f=n.A1d,s=f.map((function(r,e){return Math.max((u[e],c[e],a[e]))>127.5})),r.abrupt("return",{width:i,height:o,data:s});case 11:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}();r.exports={getData:m,setData:l,getTwoEnds:p,setTwoEnds:function(r){var e=r.data,n=r.width,t=r.height,i=r.name,u=e.map((function(r){return 255*r}));l({R:u,G:u,B:u,A:o(u).fill(255),width:n,height:t,download:!0,name:i})}}},473:(r,e,n)=>{var t=n(319);r.exports={transform:function(r){if(!r||!r[0]||void 0===r[0][0])return Promise.reject("二维矩阵不合法");for(var e=r.length,n=r[0].length,t=[],i=0;i<e;i++)for(var o=0;o<n;o++)t[o]||(t[o]=[]),t[o][i]=r[i][o];return t},diag:function(r){var e=r.length,n=new Array(e).fill(0),i=[];return r.forEach((function(r,e){var o=t(n);o[e]=r,i.push(o)})),i},dot:function(r,e){if(r[0].length!==e.length)return Promise.reject("矩阵不匹配，无法点乘");for(var n=r.length,t=r[0].length,i=e[0].length,o=new Array(n).fill(0).map((function(r){return new Array(i).fill(0)})),u=0;u<n;u++)for(var c=0;c<i;c++)for(var a=0;a<t;a++)o[u][c]+=r[u][a]*e[a][c];return o}}},359:(r,e,n)=>{var t=n(32),i=n(473),o=i.diag,u=i.dot,c=i.transform,a=function(r,e,n){return(Math.floor(r/e)+.25+.5*Number(n))*e},f=function(r){var e=0;return function r(n){n.forEach((function(n){Array.isArray(n)?r(n):e+=n}))}(r),e},s=function(r){for(var e=t.svd(r),n=e.U,i=e.S,o=e.V,u=r.length,c=r[0].length,a=0,f=0,s=function(){if(++f>=c&&(f=0,a++),a>=u)return Promise.reject("bad matrix case")};i.includes(NaN);){r[a][f]=Math.round(r[a][f]);var m=t.svd(r);n=m.U,i=m.S,o=m.V,s()}return{U:n,S:i,V:o}};r.exports={encode:function(r){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=s(r),t=n.U,i=n.S,f=n.V;return i[0]=a(i[0],20,e),i[1]=a(i[1],6,e),u(t,u(o(i),c(f)))},decode:function(r){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5,n=f(r)/(r.length*r[0].length);if(n>360)return e;var t=s(r),i=t.S,o=Number(i[0]%20>10),u=Number(i[1]%6>3);return(3*o+u)/4}}},746:(r,e,n)=>{var t=n(38),i=n(627);r.exports={dwt:function(r){if(!r||void 0===r[0]||void 0===r[0][0])return Promise.reject("private wt need 2d array");var e=[],n=[];return r.forEach((function(r){var o,u,c,a,f,s;i.dwt?(o=i.dwt(r,"haar"),f=(u=t(o,2))[0],s=u[1]):(c=i.default.dwt(r,"haar"),f=(a=t(c,2))[0],s=a[1]),e.push(f),n.push(s)})),[e,n]},idwt:function(r,e){return r&&e?r.length!==e.length?Promise.reject("请输入长度相同且合法的低频、高频分量"):r.map((function(r,n){return i.idwt?i.idwt(r,e[n],"haar"):i.default.idwt(r,e[n],"haar")})):Promise.reject("请输入低频、高频分量")}}},482:(r,e,n)=>{var t=n(319),i=n(295);r.exports={strided4:function(r){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,n=r[0].length,t=r.length,o=(Math.ceil(n/e),Math.ceil(t/e)),u=Math.floor(n/e),c=Math.floor(t/e),a=[],f=function(n){for(var t=[],o=e*n,u=0;u<e;u++)r[o+u]&&i(r[o+u],e).forEach((function(r,e){t[e]||(t[e]=[]),t[e].push(r)}));a.push(t)},s=0;s<o;s++)f(s);return{fullRowNun:c,fullColumnNun:u,result:a}},spreadStrided4:function(r){var e=[];return r.forEach((function(r,n){var i=[];r.forEach((function(r,e){r.forEach((function(r,e){i[e]||(i[e]=[]),i[e]=[].concat(t(i[e]),t(r))}))})),e=[].concat(t(e),i)})),e}}},484:(r,e,n)=>{var t=n(295);r.exports={str2charCode:function(r){return r.split("").map((function(r){return r.charCodeAt().toString(2).padStart(16,"0")})).join("")},charCode2str:function(r){return t(r,16).map((function(r){return String.fromCharCode(parseInt(r,2))})).join("")}}},228:r=>{r.exports=function(r,e){(null==e||e>r.length)&&(e=r.length);for(var n=0,t=new Array(e);n<e;n++)t[n]=r[n];return t},r.exports.default=r.exports,r.exports.__esModule=!0},858:r=>{r.exports=function(r){if(Array.isArray(r))return r},r.exports.default=r.exports,r.exports.__esModule=!0},646:(r,e,n)=>{var t=n(228);r.exports=function(r){if(Array.isArray(r))return t(r)},r.exports.default=r.exports,r.exports.__esModule=!0},926:r=>{function e(r,e,n,t,i,o,u){try{var c=r[o](u),a=c.value}catch(r){return void n(r)}c.done?e(a):Promise.resolve(a).then(t,i)}r.exports=function(r){return function(){var n=this,t=arguments;return new Promise((function(i,o){var u=r.apply(n,t);function c(r){e(u,i,o,c,a,"next",r)}function a(r){e(u,i,o,c,a,"throw",r)}c(void 0)}))}},r.exports.default=r.exports,r.exports.__esModule=!0},575:r=>{r.exports=function(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")},r.exports.default=r.exports,r.exports.__esModule=!0},913:r=>{function e(r,e){for(var n=0;n<e.length;n++){var t=e[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(r,t.key,t)}}r.exports=function(r,n,t){return n&&e(r.prototype,n),t&&e(r,t),r},r.exports.default=r.exports,r.exports.__esModule=!0},713:r=>{r.exports=function(r,e,n){return e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r},r.exports.default=r.exports,r.exports.__esModule=!0},860:r=>{r.exports=function(r){if("undefined"!=typeof Symbol&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r)},r.exports.default=r.exports,r.exports.__esModule=!0},884:r=>{r.exports=function(r,e){var n=r&&("undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"]);if(null!=n){var t,i,o=[],u=!0,c=!1;try{for(n=n.call(r);!(u=(t=n.next()).done)&&(o.push(t.value),!e||o.length!==e);u=!0);}catch(r){c=!0,i=r}finally{try{u||null==n.return||n.return()}finally{if(c)throw i}}return o}},r.exports.default=r.exports,r.exports.__esModule=!0},521:r=>{r.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},r.exports.default=r.exports,r.exports.__esModule=!0},206:r=>{r.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},r.exports.default=r.exports,r.exports.__esModule=!0},38:(r,e,n)=>{var t=n(858),i=n(884),o=n(379),u=n(521);r.exports=function(r,e){return t(r)||i(r,e)||o(r,e)||u()},r.exports.default=r.exports,r.exports.__esModule=!0},319:(r,e,n)=>{var t=n(646),i=n(860),o=n(379),u=n(206);r.exports=function(r){return t(r)||i(r)||o(r)||u()},r.exports.default=r.exports,r.exports.__esModule=!0},379:(r,e,n)=>{var t=n(228);r.exports=function(r,e){if(r){if("string"==typeof r)return t(r,e);var n=Object.prototype.toString.call(r).slice(8,-1);return"Object"===n&&r.constructor&&(n=r.constructor.name),"Map"===n||"Set"===n?Array.from(r):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?t(r,e):void 0}},r.exports.default=r.exports,r.exports.__esModule=!0},757:(r,e,n)=>{r.exports=n(666)},627:(r,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>E});var t="symmetric";function i(r,e,n){if(void 0===n&&(n=!1),0===r.length)throw new Error("Cannot determine symmetric padding for data of zero length.");var t=Math.floor(e/r.length);return(n?t:t+1)%2==0?r[e%r.length]:r[r.length-1-e%r.length]}var o="antisymmetric",u="constant",c="periodic",a="reflect",f="smooth",s="zero",m={antisymmetric:o,constant:u,periodic:c,reflect:a,smooth:f,symmetric:t,zero:s,modes:[s,u,t,c,f,a,o]},h=[1/Math.SQRT2,1/Math.SQRT2],l=[(1+Math.sqrt(3))/(4*Math.SQRT2),(3+Math.sqrt(3))/(4*Math.SQRT2),(3-Math.sqrt(3))/(4*Math.SQRT2),(1-Math.sqrt(3))/(4*Math.SQRT2)],p=[.33267055295008263,.8068915093110925,.45987750211849154,-.13501102001025458,-.08544127388202666,.03522629188570953],g=[.2303778133088965,.7148465705529157,.6308807679298589,-.027983769416859854,-.18703481171909309,.030841381835560764,.0328830116668852,-.010597401785069032],d=[.16010239797419293,.6038292697971896,.7243085284377729,.13842814590132074,-.24229488706638203,-.032244869584638375,.07757149384004572,-.006241490212798274,-.012580751999081999,.0033357252854737712],v=[.11154074335010947,.49462389039845306,.7511339080210954,.31525035170919763,-.22626469396543983,-.12976686756726194,.09750160558732304,.027522865530305727,-.03158203931748603,.0005538422011614961,.004777257510945511,-.0010773010853084796],y=[.07785205408500918,.3965393194819173,.7291320908462351,.4697822874051931,-.14390600392856498,-.22403618499387498,.07130921926683026,.08061260915108308,-.03802993693501441,-.01657454163066688,.01255099855609984,.0004295779729213665,-.0018016407040474908,.00035371379997452024],x=[.05441584224310401,.31287159091429995,.6756307362972898,.5853546836542067,-.015829105256349306,-.2840155429615469,.0004724845739132828,.12874742662047847,-.017369301001807547,-.044088253930794755,.013981027917398282,.008746094047405777,-.004870352993451574,-.00039174037337694705,.0006754494064505693,-.00011747678412476953],w=[.038077947363878345,.24383467461259034,.6048231236901112,.6572880780513005,.13319738582500756,-.2932737832791749,-.09684078322297646,.14854074933810638,.03072568147933338,-.06763282906132997,.00025094711483145197,.022361662123679096,-.004723204757751397,-.00428150368246343,.0018476468830562265,.00023038576352319597,-.0002519631889427101,393473203162716e-19],b=[.026670057900555554,.1881768000776915,.5272011889317256,.6884590394536035,.2811723436605775,-.24984642432731538,-.19594627437737705,.12736934033579325,.09305736460357235,-.07139414716639708,-.029457536821875813,.033212674059341,.0036065535669561697,-.010733175483330575,.001395351747052901,.001992405295185056,-.0006858566949597116,-.00011646685512928545,9358867032006959e-20,-13264202894521244e-21],_={db1:h,db2:l,db3:p,db4:g,db5:d,db6:v,db7:y,db8:x,db9:w,db10:b,D2:h,D4:l,D6:p,D8:g,D10:d,D12:v,D14:y,D16:x,D18:w,D20:b,haar:h};function M(r,e){if(r.length!==e.length)throw new Error("Both arrays have to have the same length.");return r.map((function(r,n){return r+e[n]}))}function k(r){if(r.high.length!==r.low.length)throw new Error("High-pass and low-pass filters have to have equal length.");if(r.low.length<2)throw new Error("Wavelet filter length has to be larger than or equal to two.");return!0}function T(r){return"string"!=typeof r?r:function(r){if(r.length<2)throw new Error("Scaling numbers length has to be larger than or equal to two.");var e=r.slice().reverse().map((function(r,e){return e%2==0?r:-r}));return{dec:{low:r.slice(),high:e.slice()},rec:{low:r.slice(),high:e.slice()}}}(_[r])}function j(r,e){if(void 0===e&&(e=0),!Number.isInteger(r))throw new Error("Length has to be an integer.");if(r<0)throw new Error("Length must not be smaller than zero.");return Array.apply(null,Array(r)).map((function(r,n){return"function"==typeof e?e(n):e}))}function A(r,e){if(r.length!==e.length)throw new Error("Both arrays have to have the same length.");return r.reduce((function(r,n,t){return r+n*e[t]}),0)}function S(r,e){return e.map((function(e){return r*e}))}function P(r,e,n,t){switch(t){case m.antisymmetric:return function(r,e,n){return void 0===n&&(n=!1),(Math.floor(e/r.length)%2==0?-1:1)*i(r,e,n)}(r,e,n);case m.constant:return function(r,e){if(void 0===e&&(e=!1),0===r.length)throw new Error("Cannot determine constant padding for data of zero length.");return e?r[0]:r[r.length-1]}(r,n);case m.periodic:return function(r,e,n){if(void 0===n&&(n=!1),0===r.length)throw new Error("Cannot determine periodic padding for data of zero length.");return n?r[r.length-1-e%r.length]:r[e%r.length]}(r,e,n);case m.reflect:return function(r,e,n){if(void 0===n&&(n=!1),0===r.length)throw new Error("Cannot determine reflect padding for data of zero length.");if(1===r.length)return r[0];var t=Math.floor(e/(r.length-1));return(n?t:t+1)%2==0?r[e%(r.length-1)+1]:r[r.length-2-e%(r.length-1)]}(r,e,n);case m.smooth:return function(r,e,n){if(void 0===n&&(n=!1),0===r.length)throw new Error("Cannot determine smooth padding for data of zero length.");var t=r.length-1;return(n?r[0]:r[t])+(e+1)*(n?1===r.length?r[0]:r[0]-r[1]:1===r.length?-r[0]:r[t]-r[t-1])}(r,e,n);case m.symmetric:return i(r,e,n);case m.zero:return 0;default:throw new Error('Unknown signal extension mode: "'+t+'"')}}var L=m.symmetric;const E=function(){function r(){}return r.dwt=function(r,e,n){void 0===n&&(n=L);var t=T(e).dec;k(t);var i=t.low.length;r=this.pad(r,function(r,e){if(r<=0)throw new Error("Cannot determine padding widths for data of length less than or equal to zero.");if(e<2)throw new Error("Cannot determine padding widths for filter of length less than two.");return[e-2,(r+e)%2==0?e-2:e-1]}(r.length,i),n);for(var o=[],u=[],c=0;c+i<=r.length;c+=2){var a=r.slice(c,c+i);o.push(A(a,t.low)),u.push(A(a,t.high))}return[o,u]},r.energy=function(r){for(var e=0,n=0,t=r;n<t.length;n++){var i=t[n];e+="number"==typeof i?Math.pow(i,2):this.energy(i)}return e},r.idwt=function(r,e,n){if(void 0===r&&void 0!==e&&(r=j(e.length,0)),void 0===e&&void 0!==r&&(e=j(r.length,0)),void 0===r||void 0===e)throw new Error("Coefficients must not be undefined.");!function(r,e){if(r.length!==e.length)throw new Error("Approximation and detail coefficients must have equal length.");if(0===r.length)throw new Error("Approximation and detail coefficients must not have zero length.")}(r,e);var t=T(n).rec;k(t);for(var i=t.low.length,o=r.length,u=j(i+2*(o-1),0),c=0;c<o;c++){var a=2*c,f=u.slice(a,a+i);f=M(f,S(r[c],t.low)),f=M(f,S(e[c],t.high)),u=u.slice(0,a).concat(f).concat(u.slice(a+f.length))}return u.slice(i-2,u.length-(i-2))},r.maxLevel=function(r,e){if(!Number.isInteger(r))throw new Error("Length of data is not an integer. This is not allowed.");if(r<0)throw new Error("Data length cannot be less than zero.");if(0===r)return 0;var n=T(e).dec.low.length;return Math.max(0,Math.floor(Math.log2(r/(n-1))))},r.pad=function(r,e,n){if(!r)throw new Error("Cannot add padding to empty data.");var t=e[0],i=e[1];return j(t,(function(e){return P(r,t-1-e,!0,n)})).concat(r).concat(j(i,(function(e){return P(r,e,!1,n)})))},r.wavedec=function(r,e,n,t){if(void 0===n&&(n=L),void 0===t&&(t=this.maxLevel(r.length,e)),t<0)throw new Error("Decomposition level must not be less than zero");for(var i=[],o=r.slice(),u=1;u<=t;u++){var c=this.dwt(o,e,n);o=c[0];var a=c[1];i.unshift(a.slice())}return i.unshift(o.slice()),i},r.waverec=function(r,e){!function(r){if(r.length<1)throw new Error("Invalid coefficients. Array length must not be zero.")}(r),e=T(e);for(var n=r[0],t=1;t<r.length;t++){var i=r[t];n.length===i.length+1&&(n=n.slice(0,n.length-1)),n=this.idwt(n,i,e)}return n.slice()},r.Modes=m,r}()},32:(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";var numeric=exports;void 0!==__webpack_require__.g&&(__webpack_require__.g.numeric=numeric),numeric.version="1.2.6",numeric.bench=function(r,e){var n,t,i;for(void 0===e&&(e=15),t=.5,n=new Date;;){for(i=t*=2;i>3;i-=4)r(),r(),r(),r();for(;i>0;)r(),i--;if(new Date-n>e)break}for(i=t;i>3;i-=4)r(),r(),r(),r();for(;i>0;)r(),i--;return 1e3*(3*t-1)/(new Date-n)},numeric._myIndexOf=function(r){var e,n=this.length;for(e=0;e<n;++e)if(this[e]===r)return e;return-1},numeric.myIndexOf=Array.prototype.indexOf?Array.prototype.indexOf:numeric._myIndexOf,numeric.Function=Function,numeric.precision=4,numeric.largeArray=50,numeric.prettyPrint=function(r){function e(r){if(0===r)return"0";if(isNaN(r))return"NaN";if(r<0)return"-"+e(-r);if(isFinite(r)){var n=Math.floor(Math.log(r)/Math.log(10)),t=r/Math.pow(10,n),i=t.toPrecision(numeric.precision);return 10===parseFloat(i)&&(n++,i=(t=1).toPrecision(numeric.precision)),parseFloat(i).toString()+"e"+n.toString()}return"Infinity"}var n=[];return function r(t){var i;if(void 0===t)return n.push(Array(numeric.precision+8).join(" ")),!1;if("string"==typeof t)return n.push('"'+t+'"'),!1;if("boolean"==typeof t)return n.push(t.toString()),!1;if("number"==typeof t){var o=e(t),u=t.toPrecision(numeric.precision),c=parseFloat(t.toString()).toString(),a=[o,u,c,parseFloat(u).toString(),parseFloat(c).toString()];for(i=1;i<a.length;i++)a[i].length<o.length&&(o=a[i]);return n.push(Array(numeric.precision+8-o.length).join(" ")+o),!1}if(null===t)return n.push("null"),!1;if("function"==typeof t){n.push(t.toString());var f=!1;for(i in t)t.hasOwnProperty(i)&&(f?n.push(",\n"):n.push("\n{"),f=!0,n.push(i),n.push(": \n"),r(t[i]));return f&&n.push("}\n"),!0}if(t instanceof Array){if(t.length>numeric.largeArray)return n.push("...Large Array..."),!0;for(f=!1,n.push("["),i=0;i<t.length;i++)i>0&&(n.push(","),f&&n.push("\n ")),f=r(t[i]);return n.push("]"),!0}for(i in n.push("{"),f=!1,t)t.hasOwnProperty(i)&&(f&&n.push(",\n"),f=!0,n.push(i),n.push(": \n"),r(t[i]));return n.push("}"),!0}(r),n.join("")},numeric.parseDate=function(r){return function r(e){if("string"==typeof e)return Date.parse(e.replace(/-/g,"/"));if(!(e instanceof Array))throw new Error("parseDate: parameter must be arrays of strings");var n,t=[];for(n=0;n<e.length;n++)t[n]=r(e[n]);return t}(r)},numeric.parseFloat=function(r){return function r(e){if("string"==typeof e)return parseFloat(e);if(!(e instanceof Array))throw new Error("parseFloat: parameter must be arrays of strings");var n,t=[];for(n=0;n<e.length;n++)t[n]=r(e[n]);return t}(r)},numeric.parseCSV=function(r){var e,n,t,i=r.split("\n"),o=[],u=/(([^'",]*)|('[^']*')|("[^"]*")),/g,c=/^\s*(([+-]?[0-9]+(\.[0-9]*)?(e[+-]?[0-9]+)?)|([+-]?[0-9]*(\.[0-9]+)?(e[+-]?[0-9]+)?))\s*$/,a=0;for(n=0;n<i.length;n++){var f,s=(i[n]+",").match(u);if(s.length>0){for(o[a]=[],e=0;e<s.length;e++)f=(t=s[e]).substr(0,t.length-1),c.test(f)?o[a][e]=parseFloat(f):o[a][e]=f;a++}}return o},numeric.toCSV=function(r){var e,n,t,i,o,u=numeric.dim(r);for(t=u[0],u[1],o=[],e=0;e<t;e++){for(i=[],n=0;n<t;n++)i[n]=r[e][n].toString();o[e]=i.join(", ")}return o.join("\n")+"\n"},numeric.getURL=function(r){var e=new XMLHttpRequest;return e.open("GET",r,!1),e.send(),e},numeric.imageURL=function(r){function e(r,e,n){void 0===e&&(e=0),void 0===n&&(n=r.length);var t,i=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],o=-1;for(r.length,t=e;t<n;t++)o=o>>>8^i[255&(o^r[t])];return-1^o}var n,t,i,o,u,c,a,f,s,m,h=r[0].length,l=r[0][0].length,p=[137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,l>>24&255,l>>16&255,l>>8&255,255&l,h>>24&255,h>>16&255,h>>8&255,255&h,8,2,0,0,0,-1,-2,-3,-4,-5,-6,-7,-8,73,68,65,84,8,29];for(m=e(p,12,29),p[29]=m>>24&255,p[30]=m>>16&255,p[31]=m>>8&255,p[32]=255&m,n=1,t=0,a=0;a<h;a++){for(a<h-1?p.push(0):p.push(1),u=3*l+1+(0===a)&255,c=3*l+1+(0===a)>>8&255,p.push(u),p.push(c),p.push(255&~u),p.push(255&~c),0===a&&p.push(0),f=0;f<l;f++)for(i=0;i<3;i++)t=(t+(n=(n+(u=(u=r[i][a][f])>255?255:u<0?0:Math.round(u)))%65521))%65521,p.push(u);p.push(0)}return s=(t<<16)+n,p.push(s>>24&255),p.push(s>>16&255),p.push(s>>8&255),p.push(255&s),o=p.length-41,p[33]=o>>24&255,p[34]=o>>16&255,p[35]=o>>8&255,p[36]=255&o,m=e(p,37),p.push(m>>24&255),p.push(m>>16&255),p.push(m>>8&255),p.push(255&m),p.push(0),p.push(0),p.push(0),p.push(0),p.push(73),p.push(69),p.push(78),p.push(68),p.push(174),p.push(66),p.push(96),p.push(130),"data:image/png;base64,"+function(r){var e,n,t,i,o,u,c,a=r.length,f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",s="";for(e=0;e<a;e+=3)o=((3&(n=r[e]))<<4)+((t=r[e+1])>>4),u=((15&t)<<2)+((i=r[e+2])>>6),c=63&i,e+1>=a?u=c=64:e+2>=a&&(c=64),s+=f.charAt(n>>2)+f.charAt(o)+f.charAt(u)+f.charAt(c);return s}(p)},numeric._dim=function(r){for(var e=[];"object"==typeof r;)e.push(r.length),r=r[0];return e},numeric.dim=function(r){var e;return"object"==typeof r?"object"==typeof(e=r[0])?"object"==typeof e[0]?numeric._dim(r):[r.length,e.length]:[r.length]:[]},numeric.mapreduce=function(r,e){return Function("x","accum","_s","_k",'if(typeof accum === "undefined") accum = '+e+';\nif(typeof x === "number") { var xi = x; '+r+'; return accum; }\nif(typeof _s === "undefined") _s = numeric.dim(x);\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i,xi;\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) {\n        accum = arguments.callee(x[i],accum,_s,_k+1);\n    }    return accum;\n}\nfor(i=_n-1;i>=1;i-=2) { \n    xi = x[i];\n    '+r+";\n    xi = x[i-1];\n    "+r+";\n}\nif(i === 0) {\n    xi = x[i];\n    "+r+"\n}\nreturn accum;")},numeric.mapreduce2=function(r,e){return Function("x","var n = x.length;\nvar i,xi;\n"+e+";\nfor(i=n-1;i!==-1;--i) { \n    xi = x[i];\n    "+r+";\n}\nreturn accum;")},numeric.same=function r(e,n){var t,i;if(!(e instanceof Array&&n instanceof Array))return!1;if((i=e.length)!==n.length)return!1;for(t=0;t<i;t++)if(e[t]!==n[t]){if("object"!=typeof e[t])return!1;if(!r(e[t],n[t]))return!1}return!0},numeric.rep=function(r,e,n){void 0===n&&(n=0);var t,i=r[n],o=Array(i);if(n===r.length-1){for(t=i-2;t>=0;t-=2)o[t+1]=e,o[t]=e;return-1===t&&(o[0]=e),o}for(t=i-1;t>=0;t--)o[t]=numeric.rep(r,e,n+1);return o},numeric.dotMMsmall=function(r,e){var n,t,i,o,u,c,a,f,s,m,h;for(o=r.length,u=e.length,c=e[0].length,a=Array(o),n=o-1;n>=0;n--){for(f=Array(c),s=r[n],i=c-1;i>=0;i--){for(m=s[u-1]*e[u-1][i],t=u-2;t>=1;t-=2)h=t-1,m+=s[t]*e[t][i]+s[h]*e[h][i];0===t&&(m+=s[0]*e[0][i]),f[i]=m}a[n]=f}return a},numeric._getCol=function(r,e,n){var t;for(t=r.length-1;t>0;--t)n[t]=r[t][e],n[--t]=r[t][e];0===t&&(n[0]=r[0][e])},numeric.dotMMbig=function(r,e){var n,t,i,o=numeric._getCol,u=e.length,c=Array(u),a=r.length,f=e[0].length,s=new Array(a),m=numeric.dotVV;for(--u,t=--a;-1!==t;--t)s[t]=Array(f);for(t=--f;-1!==t;--t)for(o(e,t,c),i=a;-1!==i;--i)n=r[i],s[i][t]=m(n,c);return s},numeric.dotMV=function(r,e){var n,t=r.length,i=(e.length,Array(t)),o=numeric.dotVV;for(n=t-1;n>=0;n--)i[n]=o(r[n],e);return i},numeric.dotVM=function(r,e){var n,t,i,o,u,c,a;for(i=r.length,o=e[0].length,u=Array(o),t=o-1;t>=0;t--){for(c=r[i-1]*e[i-1][t],n=i-2;n>=1;n-=2)a=n-1,c+=r[n]*e[n][t]+r[a]*e[a][t];0===n&&(c+=r[0]*e[0][t]),u[t]=c}return u},numeric.dotVV=function(r,e){var n,t,i=r.length,o=r[i-1]*e[i-1];for(n=i-2;n>=1;n-=2)t=n-1,o+=r[n]*e[n]+r[t]*e[t];return 0===n&&(o+=r[0]*e[0]),o},numeric.dot=function(r,e){var n=numeric.dim;switch(1e3*n(r).length+n(e).length){case 2002:return e.length<10?numeric.dotMMsmall(r,e):numeric.dotMMbig(r,e);case 2001:return numeric.dotMV(r,e);case 1002:return numeric.dotVM(r,e);case 1001:return numeric.dotVV(r,e);case 1e3:return numeric.mulVS(r,e);case 1:return numeric.mulSV(r,e);case 0:return r*e;default:throw new Error("numeric.dot only works on vectors and matrices")}},numeric.diag=function(r){var e,n,t,i,o=r.length,u=Array(o);for(e=o-1;e>=0;e--){for(i=Array(o),n=e+2,t=o-1;t>=n;t-=2)i[t]=0,i[t-1]=0;for(t>e&&(i[t]=0),i[e]=r[e],t=e-1;t>=1;t-=2)i[t]=0,i[t-1]=0;0===t&&(i[0]=0),u[e]=i}return u},numeric.getDiag=function(r){var e,n=Math.min(r.length,r[0].length),t=Array(n);for(e=n-1;e>=1;--e)t[e]=r[e][e],t[--e]=r[e][e];return 0===e&&(t[0]=r[0][0]),t},numeric.identity=function(r){return numeric.diag(numeric.rep([r],1))},numeric.pointwise=function(r,e,n){void 0===n&&(n="");var t,i,o=[],u=/\[i\]$/,c="",a=!1;for(t=0;t<r.length;t++)u.test(r[t])?c=i=r[t].substring(0,r[t].length-3):i=r[t],"ret"===i&&(a=!0),o.push(i);return o[r.length]="_s",o[r.length+1]="_k",o[r.length+2]='if(typeof _s === "undefined") _s = numeric.dim('+c+');\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i'+(a?"":", ret = Array(_n)")+";\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) ret[i] = arguments.callee("+r.join(",")+",_s,_k+1);\n    return ret;\n}\n"+n+"\nfor(i=_n-1;i!==-1;--i) {\n    "+e+"\n}\nreturn ret;",Function.apply(null,o)},numeric.pointwise2=function(r,e,n){void 0===n&&(n="");var t,i,o=[],u=/\[i\]$/,c="",a=!1;for(t=0;t<r.length;t++)u.test(r[t])?c=i=r[t].substring(0,r[t].length-3):i=r[t],"ret"===i&&(a=!0),o.push(i);return o[r.length]="var _n = "+c+".length;\nvar i"+(a?"":", ret = Array(_n)")+";\n"+n+"\nfor(i=_n-1;i!==-1;--i) {\n"+e+"\n}\nreturn ret;",Function.apply(null,o)},numeric._biforeach=function r(e,n,t,i,o){var u;if(i!==t.length-1)for(u=t[i]-1;u>=0;u--)r("object"==typeof e?e[u]:e,"object"==typeof n?n[u]:n,t,i+1,o);else o(e,n)},numeric._biforeach2=function r(e,n,t,i,o){if(i===t.length-1)return o(e,n);var u,c=t[i],a=Array(c);for(u=c-1;u>=0;--u)a[u]=r("object"==typeof e?e[u]:e,"object"==typeof n?n[u]:n,t,i+1,o);return a},numeric._foreach=function r(e,n,t,i){var o;if(t!==n.length-1)for(o=n[t]-1;o>=0;o--)r(e[o],n,t+1,i);else i(e)},numeric._foreach2=function r(e,n,t,i){if(t===n.length-1)return i(e);var o,u=n[t],c=Array(u);for(o=u-1;o>=0;o--)c[o]=r(e[o],n,t+1,i);return c},numeric.ops2={add:"+",sub:"-",mul:"*",div:"/",mod:"%",and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">=",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"},numeric.opseq={addeq:"+=",subeq:"-=",muleq:"*=",diveq:"/=",modeq:"%=",lshifteq:"<<=",rshifteq:">>=",rrshifteq:">>>=",bandeq:"&=",boreq:"|=",bxoreq:"^="},numeric.mathfuns=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","isNaN","isFinite"],numeric.mathfuns2=["atan2","pow","max","min"],numeric.ops1={neg:"-",not:"!",bnot:"~",clone:""},numeric.mapreducers={any:["if(xi) return true;","var accum = false;"],all:["if(!xi) return false;","var accum = true;"],sum:["accum += xi;","var accum = 0;"],prod:["accum *= xi;","var accum = 1;"],norm2Squared:["accum += xi*xi;","var accum = 0;"],norminf:["accum = max(accum,abs(xi));","var accum = 0, max = Math.max, abs = Math.abs;"],norm1:["accum += abs(xi)","var accum = 0, abs = Math.abs;"],sup:["accum = max(accum,xi);","var accum = -Infinity, max = Math.max;"],inf:["accum = min(accum,xi);","var accum = Infinity, min = Math.min;"]},function(){var r,e;for(r=0;r<numeric.mathfuns2.length;++r)e=numeric.mathfuns2[r],numeric.ops2[e]=e;for(r in numeric.ops2)if(numeric.ops2.hasOwnProperty(r)){e=numeric.ops2[r];var n,t,i="";-1!==numeric.myIndexOf.call(numeric.mathfuns2,r)?(i="var "+e+" = Math."+e+";\n",n=function(r,n,t){return r+" = "+e+"("+n+","+t+")"},t=function(r,n){return r+" = "+e+"("+r+","+n+")"}):(n=function(r,n,t){return r+" = "+n+" "+e+" "+t},t=numeric.opseq.hasOwnProperty(r+"eq")?function(r,n){return r+" "+e+"= "+n}:function(r,n){return r+" = "+r+" "+e+" "+n}),numeric[r+"VV"]=numeric.pointwise2(["x[i]","y[i]"],n("ret[i]","x[i]","y[i]"),i),numeric[r+"SV"]=numeric.pointwise2(["x","y[i]"],n("ret[i]","x","y[i]"),i),numeric[r+"VS"]=numeric.pointwise2(["x[i]","y"],n("ret[i]","x[i]","y"),i),numeric[r]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar VV = numeric."+r+"VV, VS = numeric."+r+"VS, SV = numeric."+r+'SV;\nvar dim = numeric.dim;\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof x === "object") {\n      if(typeof y === "object") x = numeric._biforeach2(x,y,dim(x),0,VV);\n      else x = numeric._biforeach2(x,y,dim(x),0,VS);\n  } else if(typeof y === "object") x = numeric._biforeach2(x,y,dim(y),0,SV);\n  else '+t("x","y")+"\n}\nreturn x;\n"),numeric[e]=numeric[r],numeric[r+"eqV"]=numeric.pointwise2(["ret[i]","x[i]"],t("ret[i]","x[i]"),i),numeric[r+"eqS"]=numeric.pointwise2(["ret[i]","x"],t("ret[i]","x"),i),numeric[r+"eq"]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar V = numeric."+r+"eqV, S = numeric."+r+'eqS\nvar s = numeric.dim(x);\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof y === "object") numeric._biforeach(x,y,s,0,V);\n  else numeric._biforeach(x,y,s,0,S);\n}\nreturn x;\n')}for(r=0;r<numeric.mathfuns2.length;++r)e=numeric.mathfuns2[r],delete numeric.ops2[e];for(r=0;r<numeric.mathfuns.length;++r)e=numeric.mathfuns[r],numeric.ops1[e]=e;for(r in numeric.ops1)numeric.ops1.hasOwnProperty(r)&&(i="",e=numeric.ops1[r],-1!==numeric.myIndexOf.call(numeric.mathfuns,r)&&Math.hasOwnProperty(e)&&(i="var "+e+" = Math."+e+";\n"),numeric[r+"eqV"]=numeric.pointwise2(["ret[i]"],"ret[i] = "+e+"(ret[i]);",i),numeric[r+"eq"]=Function("x",'if(typeof x !== "object") return '+e+"x\nvar i;\nvar V = numeric."+r+"eqV;\nvar s = numeric.dim(x);\nnumeric._foreach(x,s,0,V);\nreturn x;\n"),numeric[r+"V"]=numeric.pointwise2(["x[i]"],"ret[i] = "+e+"(x[i]);",i),numeric[r]=Function("x",'if(typeof x !== "object") return '+e+"(x)\nvar i;\nvar V = numeric."+r+"V;\nvar s = numeric.dim(x);\nreturn numeric._foreach2(x,s,0,V);\n"));for(r=0;r<numeric.mathfuns.length;++r)e=numeric.mathfuns[r],delete numeric.ops1[e];for(r in numeric.mapreducers)numeric.mapreducers.hasOwnProperty(r)&&(e=numeric.mapreducers[r],numeric[r+"V"]=numeric.mapreduce2(e[0],e[1]),numeric[r]=Function("x","s","k",e[1]+'if(typeof x !== "object") {    xi = x;\n'+e[0]+';\n    return accum;\n}if(typeof s === "undefined") s = numeric.dim(x);\nif(typeof k === "undefined") k = 0;\nif(k === s.length-1) return numeric.'+r+"V(x);\nvar xi;\nvar n = x.length, i;\nfor(i=n-1;i!==-1;--i) {\n   xi = arguments.callee(x[i]);\n"+e[0]+";\n}\nreturn accum;\n"))}(),numeric.truncVV=numeric.pointwise(["x[i]","y[i]"],"ret[i] = round(x[i]/y[i])*y[i];","var round = Math.round;"),numeric.truncVS=numeric.pointwise(["x[i]","y"],"ret[i] = round(x[i]/y)*y;","var round = Math.round;"),numeric.truncSV=numeric.pointwise(["x","y[i]"],"ret[i] = round(x/y[i])*y[i];","var round = Math.round;"),numeric.trunc=function(r,e){return"object"==typeof r?"object"==typeof e?numeric.truncVV(r,e):numeric.truncVS(r,e):"object"==typeof e?numeric.truncSV(r,e):Math.round(r/e)*e},numeric.inv=function(r){var e,n,t,i,o,u,c,a=numeric.dim(r),f=Math.abs,s=a[0],m=a[1],h=numeric.clone(r),l=numeric.identity(s);for(u=0;u<m;++u){var p=-1,g=-1;for(o=u;o!==s;++o)(c=f(h[o][u]))>g&&(p=o,g=c);for(n=h[p],h[p]=h[u],h[u]=n,i=l[p],l[p]=l[u],l[u]=i,r=n[u],c=u;c!==m;++c)n[c]/=r;for(c=m-1;-1!==c;--c)i[c]/=r;for(o=s-1;-1!==o;--o)if(o!==u){for(e=h[o],t=l[o],r=e[u],c=u+1;c!==m;++c)e[c]-=n[c]*r;for(c=m-1;c>0;--c)t[c]-=i[c]*r,t[--c]-=i[c]*r;0===c&&(t[0]-=i[0]*r)}}return l},numeric.det=function(r){var e=numeric.dim(r);if(2!==e.length||e[0]!==e[1])throw new Error("numeric: det() only works on square matrices");var n,t,i,o,u,c,a,f,s=e[0],m=1,h=numeric.clone(r);for(t=0;t<s-1;t++){for(i=t,n=t+1;n<s;n++)Math.abs(h[n][t])>Math.abs(h[i][t])&&(i=n);for(i!==t&&(a=h[i],h[i]=h[t],h[t]=a,m*=-1),o=h[t],n=t+1;n<s;n++){for(c=(u=h[n])[t]/o[t],i=t+1;i<s-1;i+=2)f=i+1,u[i]-=o[i]*c,u[f]-=o[f]*c;i!==s&&(u[i]-=o[i]*c)}if(0===o[t])return 0;m*=o[t]}return m*h[t][t]},numeric.transpose=function(r){var e,n,t,i,o,u=r.length,c=r[0].length,a=Array(c);for(n=0;n<c;n++)a[n]=Array(u);for(e=u-1;e>=1;e-=2){for(i=r[e],t=r[e-1],n=c-1;n>=1;--n)(o=a[n])[e]=i[n],o[e-1]=t[n],(o=a[--n])[e]=i[n],o[e-1]=t[n];0===n&&((o=a[0])[e]=i[0],o[e-1]=t[0])}if(0===e){for(t=r[0],n=c-1;n>=1;--n)a[n][0]=t[n],a[--n][0]=t[n];0===n&&(a[0][0]=t[0])}return a},numeric.negtranspose=function(r){var e,n,t,i,o,u=r.length,c=r[0].length,a=Array(c);for(n=0;n<c;n++)a[n]=Array(u);for(e=u-1;e>=1;e-=2){for(i=r[e],t=r[e-1],n=c-1;n>=1;--n)(o=a[n])[e]=-i[n],o[e-1]=-t[n],(o=a[--n])[e]=-i[n],o[e-1]=-t[n];0===n&&((o=a[0])[e]=-i[0],o[e-1]=-t[0])}if(0===e){for(t=r[0],n=c-1;n>=1;--n)a[n][0]=-t[n],a[--n][0]=-t[n];0===n&&(a[0][0]=-t[0])}return a},numeric._random=function r(e,n){var t,i,o=e[n],u=Array(o);if(n===e.length-1){for(i=Math.random,t=o-1;t>=1;t-=2)u[t]=i(),u[t-1]=i();return 0===t&&(u[0]=i()),u}for(t=o-1;t>=0;t--)u[t]=r(e,n+1);return u},numeric.random=function(r){return numeric._random(r,0)},numeric.norm2=function(r){return Math.sqrt(numeric.norm2Squared(r))},numeric.linspace=function(r,e,n){if(void 0===n&&(n=Math.max(Math.round(e-r)+1,1)),n<2)return 1===n?[r]:[];var t,i=Array(n);for(t=--n;t>=0;t--)i[t]=(t*e+(n-t)*r)/n;return i},numeric.getBlock=function(r,e,n){var t=numeric.dim(r);return function r(i,o){var u,c=e[o],a=n[o]-c,f=Array(a);if(o===t.length-1){for(u=a;u>=0;u--)f[u]=i[u+c];return f}for(u=a;u>=0;u--)f[u]=r(i[u+c],o+1);return f}(r,0)},numeric.setBlock=function(r,e,n,t){var i=numeric.dim(r);return function r(t,o,u){var c,a=e[u],f=n[u]-a;if(u===i.length-1)for(c=f;c>=0;c--)t[c+a]=o[c];for(c=f;c>=0;c--)r(t[c+a],o[c],u+1)}(r,t,0),r},numeric.getRange=function(r,e,n){var t,i,o,u,c=e.length,a=n.length,f=Array(c);for(t=c-1;-1!==t;--t)for(f[t]=Array(a),o=f[t],u=r[e[t]],i=a-1;-1!==i;--i)o[i]=u[n[i]];return f},numeric.blockMatrix=function(r){var e=numeric.dim(r);if(e.length<4)return numeric.blockMatrix([r]);var n,t,i,o,u,c=e[0],a=e[1];for(n=0,t=0,i=0;i<c;++i)n+=r[i][0].length;for(o=0;o<a;++o)t+=r[0][o][0].length;var f=Array(n);for(i=0;i<n;++i)f[i]=Array(t);var s,m,h,l,p,g=0;for(i=0;i<c;++i){for(s=t,o=a-1;-1!==o;--o)for(s-=(u=r[i][o])[0].length,h=u.length-1;-1!==h;--h)for(p=u[h],m=f[g+h],l=p.length-1;-1!==l;--l)m[s+l]=p[l];g+=r[i][0].length}return f},numeric.tensor=function(r,e){if("number"==typeof r||"number"==typeof e)return numeric.mul(r,e);var n=numeric.dim(r),t=numeric.dim(e);if(1!==n.length||1!==t.length)throw new Error("numeric: tensor product is only defined for vectors");var i,o,u,c,a=n[0],f=t[0],s=Array(a);for(o=a-1;o>=0;o--){for(i=Array(f),c=r[o],u=f-1;u>=3;--u)i[u]=c*e[u],i[--u]=c*e[u],i[--u]=c*e[u],i[--u]=c*e[u];for(;u>=0;)i[u]=c*e[u],--u;s[o]=i}return s},numeric.T=function(r,e){this.x=r,this.y=e},numeric.t=function(r,e){return new numeric.T(r,e)},numeric.Tbinop=function(r,e,n,t,i){var o;if(numeric.indexOf,"string"!=typeof i)for(o in i="",numeric)numeric.hasOwnProperty(o)&&(r.indexOf(o)>=0||e.indexOf(o)>=0||n.indexOf(o)>=0||t.indexOf(o)>=0)&&o.length>1&&(i+="var "+o+" = numeric."+o+";\n");return Function(["y"],"var x = this;\nif(!(y instanceof numeric.T)) { y = new numeric.T(y); }\n"+i+"\nif(x.y) {  if(y.y) {    return new numeric.T("+t+");\n  }\n  return new numeric.T("+n+");\n}\nif(y.y) {\n  return new numeric.T("+e+");\n}\nreturn new numeric.T("+r+");\n")},numeric.T.prototype.add=numeric.Tbinop("add(x.x,y.x)","add(x.x,y.x),y.y","add(x.x,y.x),x.y","add(x.x,y.x),add(x.y,y.y)"),numeric.T.prototype.sub=numeric.Tbinop("sub(x.x,y.x)","sub(x.x,y.x),neg(y.y)","sub(x.x,y.x),x.y","sub(x.x,y.x),sub(x.y,y.y)"),numeric.T.prototype.mul=numeric.Tbinop("mul(x.x,y.x)","mul(x.x,y.x),mul(x.x,y.y)","mul(x.x,y.x),mul(x.y,y.x)","sub(mul(x.x,y.x),mul(x.y,y.y)),add(mul(x.x,y.y),mul(x.y,y.x))"),numeric.T.prototype.reciprocal=function(){var r=numeric.mul,e=numeric.div;if(this.y){var n=numeric.add(r(this.x,this.x),r(this.y,this.y));return new numeric.T(e(this.x,n),e(numeric.neg(this.y),n))}return new T(e(1,this.x))},numeric.T.prototype.div=function(r){if(r instanceof numeric.T||(r=new numeric.T(r)),r.y)return this.mul(r.reciprocal());var e=numeric.div;return this.y?new numeric.T(e(this.x,r.x),e(this.y,r.x)):new numeric.T(e(this.x,r.x))},numeric.T.prototype.dot=numeric.Tbinop("dot(x.x,y.x)","dot(x.x,y.x),dot(x.x,y.y)","dot(x.x,y.x),dot(x.y,y.x)","sub(dot(x.x,y.x),dot(x.y,y.y)),add(dot(x.x,y.y),dot(x.y,y.x))"),numeric.T.prototype.transpose=function(){var r=numeric.transpose,e=this.x,n=this.y;return n?new numeric.T(r(e),r(n)):new numeric.T(r(e))},numeric.T.prototype.transjugate=function(){var r=numeric.transpose,e=this.x,n=this.y;return n?new numeric.T(r(e),numeric.negtranspose(n)):new numeric.T(r(e))},numeric.Tunop=function(r,e,n){return"string"!=typeof n&&(n=""),Function("var x = this;\n"+n+"\nif(x.y) {  "+e+";\n}\n"+r+";\n")},numeric.T.prototype.exp=numeric.Tunop("return new numeric.T(ex)","return new numeric.T(mul(cos(x.y),ex),mul(sin(x.y),ex))","var ex = numeric.exp(x.x), cos = numeric.cos, sin = numeric.sin, mul = numeric.mul;"),numeric.T.prototype.conj=numeric.Tunop("return new numeric.T(x.x);","return new numeric.T(x.x,numeric.neg(x.y));"),numeric.T.prototype.neg=numeric.Tunop("return new numeric.T(neg(x.x));","return new numeric.T(neg(x.x),neg(x.y));","var neg = numeric.neg;"),numeric.T.prototype.sin=numeric.Tunop("return new numeric.T(numeric.sin(x.x))","return x.exp().sub(x.neg().exp()).div(new numeric.T(0,2));"),numeric.T.prototype.cos=numeric.Tunop("return new numeric.T(numeric.cos(x.x))","return x.exp().add(x.neg().exp()).div(2);"),numeric.T.prototype.abs=numeric.Tunop("return new numeric.T(numeric.abs(x.x));","return new numeric.T(numeric.sqrt(numeric.add(mul(x.x,x.x),mul(x.y,x.y))));","var mul = numeric.mul;"),numeric.T.prototype.log=numeric.Tunop("return new numeric.T(numeric.log(x.x));","var theta = new numeric.T(numeric.atan2(x.y,x.x)), r = x.abs();\nreturn new numeric.T(numeric.log(r.x),theta.x);"),numeric.T.prototype.norm2=numeric.Tunop("return numeric.norm2(x.x);","var f = numeric.norm2Squared;\nreturn Math.sqrt(f(x.x)+f(x.y));"),numeric.T.prototype.inv=function(){var r=this;if(void 0===r.y)return new numeric.T(numeric.inv(r.x));var e,n,t,i,o,u,c,a,f,s,m,h,l,p,g,d,v,y,x=r.x.length,w=numeric.identity(x),b=numeric.rep([x,x],0),_=numeric.clone(r.x),M=numeric.clone(r.y);for(f=0;f<x;f++){for(h=(p=_[f][f])*p+(g=M[f][f])*g,m=f,s=f+1;s<x;s++)(l=(p=_[s][f])*p+(g=M[s][f])*g)>h&&(m=s,h=l);for(m!==f&&(y=_[f],_[f]=_[m],_[m]=y,y=M[f],M[f]=M[m],M[m]=y,y=w[f],w[f]=w[m],w[m]=y,y=b[f],b[f]=b[m],b[m]=y),e=_[f],n=M[f],o=w[f],u=b[f],p=e[f],g=n[f],s=f+1;s<x;s++)d=e[s],v=n[s],e[s]=(d*p+v*g)/h,n[s]=(v*p-d*g)/h;for(s=0;s<x;s++)d=o[s],v=u[s],o[s]=(d*p+v*g)/h,u[s]=(v*p-d*g)/h;for(s=f+1;s<x;s++){for(t=_[s],i=M[s],c=w[s],a=b[s],p=t[f],g=i[f],m=f+1;m<x;m++)d=e[m],v=n[m],t[m]-=d*p-v*g,i[m]-=v*p+d*g;for(m=0;m<x;m++)d=o[m],v=u[m],c[m]-=d*p-v*g,a[m]-=v*p+d*g}}for(f=x-1;f>0;f--)for(o=w[f],u=b[f],s=f-1;s>=0;s--)for(c=w[s],a=b[s],p=_[s][f],g=M[s][f],m=x-1;m>=0;m--)d=o[m],v=u[m],c[m]-=p*d-g*v,a[m]-=p*v+g*d;return new numeric.T(w,b)},numeric.T.prototype.get=function(r){var e,n=this.x,t=this.y,i=0,o=r.length;if(t){for(;i<o;)n=n[e=r[i]],t=t[e],i++;return new numeric.T(n,t)}for(;i<o;)n=n[e=r[i]],i++;return new numeric.T(n)},numeric.T.prototype.set=function(r,e){var n,t=this.x,i=this.y,o=0,u=r.length,c=e.x,a=e.y;if(0===u)return a?this.y=a:i&&(this.y=void 0),this.x=t,this;if(a){for(i||(i=numeric.rep(numeric.dim(t),0),this.y=i);o<u-1;)t=t[n=r[o]],i=i[n],o++;return t[n=r[o]]=c,i[n]=a,this}if(i){for(;o<u-1;)t=t[n=r[o]],i=i[n],o++;return t[n=r[o]]=c,i[n]=c instanceof Array?numeric.rep(numeric.dim(c),0):0,this}for(;o<u-1;)t=t[n=r[o]],o++;return t[n=r[o]]=c,this},numeric.T.prototype.getRows=function(r,e){var n,t,i=e-r+1,o=Array(i),u=this.x,c=this.y;for(n=r;n<=e;n++)o[n-r]=u[n];if(c){for(t=Array(i),n=r;n<=e;n++)t[n-r]=c[n];return new numeric.T(o,t)}return new numeric.T(o)},numeric.T.prototype.setRows=function(r,e,n){var t,i=this.x,o=this.y,u=n.x,c=n.y;for(t=r;t<=e;t++)i[t]=u[t-r];if(c)for(o||(o=numeric.rep(numeric.dim(i),0),this.y=o),t=r;t<=e;t++)o[t]=c[t-r];else if(o)for(t=r;t<=e;t++)o[t]=numeric.rep([u[t-r].length],0);return this},numeric.T.prototype.getRow=function(r){var e=this.x,n=this.y;return n?new numeric.T(e[r],n[r]):new numeric.T(e[r])},numeric.T.prototype.setRow=function(r,e){var n=this.x,t=this.y,i=e.x,o=e.y;return n[r]=i,o?(t||(t=numeric.rep(numeric.dim(n),0),this.y=t),t[r]=o):t&&(t=numeric.rep([i.length],0)),this},numeric.T.prototype.getBlock=function(r,e){var n=this.x,t=this.y,i=numeric.getBlock;return t?new numeric.T(i(n,r,e),i(t,r,e)):new numeric.T(i(n,r,e))},numeric.T.prototype.setBlock=function(r,e,n){n instanceof numeric.T||(n=new numeric.T(n));var t=this.x,i=this.y,o=numeric.setBlock,u=n.x,c=n.y;if(c)return i||(this.y=numeric.rep(numeric.dim(this),0),i=this.y),o(t,r,e,u),o(i,r,e,c),this;o(t,r,e,u),i&&o(i,r,e,numeric.rep(numeric.dim(u),0))},numeric.T.rep=function(r,e){var n=numeric.T;e instanceof n||(e=new n(e));var t=e.x,i=e.y,o=numeric.rep;return i?new n(o(r,t),o(r,i)):new n(o(r,t))},numeric.T.diag=function(r){r instanceof numeric.T||(r=new numeric.T(r));var e=r.x,n=r.y,t=numeric.diag;return n?new numeric.T(t(e),t(n)):new numeric.T(t(e))},numeric.T.eig=function(){if(this.y)throw new Error("eig: not implemented for complex matrices.");return numeric.eig(this.x)},numeric.T.identity=function(r){return new numeric.T(numeric.identity(r))},numeric.T.prototype.getDiag=function(){var r=numeric,e=this.x,n=this.y;return n?new r.T(r.getDiag(e),r.getDiag(n)):new r.T(r.getDiag(e))},numeric.house=function(r){var e=numeric.clone(r),n=(r[0]>=0?1:-1)*numeric.norm2(r);e[0]+=n;var t=numeric.norm2(e);if(0===t)throw new Error("eig: internal error");return numeric.div(e,t)},numeric.toUpperHessenberg=function(r){var e=numeric.dim(r);if(2!==e.length||e[0]!==e[1])throw new Error("numeric: toUpperHessenberg() only works on square matrices");var n,t,i,o,u,c,a,f,s,m,h=e[0],l=numeric.clone(r),p=numeric.identity(h);for(t=0;t<h-2;t++){for(o=Array(h-t-1),n=t+1;n<h;n++)o[n-t-1]=l[n][t];if(numeric.norm2(o)>0){for(u=numeric.house(o),c=numeric.getBlock(l,[t+1,t],[h-1,h-1]),a=numeric.tensor(u,numeric.dot(u,c)),n=t+1;n<h;n++)for(f=l[n],s=a[n-t-1],i=t;i<h;i++)f[i]-=2*s[i-t];for(c=numeric.getBlock(l,[0,t+1],[h-1,h-1]),a=numeric.tensor(numeric.dot(c,u),u),n=0;n<h;n++)for(f=l[n],s=a[n],i=t+1;i<h;i++)f[i]-=2*s[i-t-1];for(c=Array(h-t-1),n=t+1;n<h;n++)c[n-t-1]=p[n];for(a=numeric.tensor(u,numeric.dot(u,c)),n=t+1;n<h;n++)for(m=p[n],s=a[n-t-1],i=0;i<h;i++)m[i]-=2*s[i]}}return{H:l,Q:p}},numeric.epsilon=2220446049250313e-31,numeric.QRFrancis=function(r,e){void 0===e&&(e=1e4),r=numeric.clone(r),numeric.clone(r);var n,t,i,o,u,c,a,f,s,m,h,l,p,g,d,v,y,x,w=numeric.dim(r)[0],b=numeric.identity(w);if(w<3)return{Q:b,B:[[0,w-1]]};var _=numeric.epsilon;for(x=0;x<e;x++){for(v=0;v<w-1;v++)if(Math.abs(r[v+1][v])<_*(Math.abs(r[v][v])+Math.abs(r[v+1][v+1]))){var M=numeric.QRFrancis(numeric.getBlock(r,[0,0],[v,v]),e),k=numeric.QRFrancis(numeric.getBlock(r,[v+1,v+1],[w-1,w-1]),e);for(l=Array(v+1),d=0;d<=v;d++)l[d]=b[d];for(p=numeric.dot(M.Q,l),d=0;d<=v;d++)b[d]=p[d];for(l=Array(w-v-1),d=v+1;d<w;d++)l[d-v-1]=b[d];for(p=numeric.dot(k.Q,l),d=v+1;d<w;d++)b[d]=p[d-v-1];return{Q:b,B:M.B.concat(numeric.add(k.B,v+1))}}var T,j,A;for(i=r[w-2][w-2],o=r[w-2][w-1],u=r[w-1][w-2],f=i+(c=r[w-1][w-1]),a=i*c-o*u,s=numeric.getBlock(r,[0,0],[2,2]),f*f>=4*a?(T=.5*(f+Math.sqrt(f*f-4*a)),j=.5*(f-Math.sqrt(f*f-4*a)),s=numeric.add(numeric.sub(numeric.dot(s,s),numeric.mul(s,T+j)),numeric.diag(numeric.rep([3],T*j)))):s=numeric.add(numeric.sub(numeric.dot(s,s),numeric.mul(s,f)),numeric.diag(numeric.rep([3],a))),n=[s[0][0],s[1][0],s[2][0]],t=numeric.house(n),l=[r[0],r[1],r[2]],p=numeric.tensor(t,numeric.dot(t,l)),d=0;d<3;d++)for(h=r[d],g=p[d],y=0;y<w;y++)h[y]-=2*g[y];for(l=numeric.getBlock(r,[0,0],[w-1,2]),p=numeric.tensor(numeric.dot(l,t),t),d=0;d<w;d++)for(h=r[d],g=p[d],y=0;y<3;y++)h[y]-=2*g[y];for(l=[b[0],b[1],b[2]],p=numeric.tensor(t,numeric.dot(t,l)),d=0;d<3;d++)for(m=b[d],g=p[d],y=0;y<w;y++)m[y]-=2*g[y];for(v=0;v<w-2;v++){for(y=v;y<=v+1;y++)if(Math.abs(r[y+1][y])<_*(Math.abs(r[y][y])+Math.abs(r[y+1][y+1]))){for(M=numeric.QRFrancis(numeric.getBlock(r,[0,0],[y,y]),e),k=numeric.QRFrancis(numeric.getBlock(r,[y+1,y+1],[w-1,w-1]),e),l=Array(y+1),d=0;d<=y;d++)l[d]=b[d];for(p=numeric.dot(M.Q,l),d=0;d<=y;d++)b[d]=p[d];for(l=Array(w-y-1),d=y+1;d<w;d++)l[d-y-1]=b[d];for(p=numeric.dot(k.Q,l),d=y+1;d<w;d++)b[d]=p[d-y-1];return{Q:b,B:M.B.concat(numeric.add(k.B,y+1))}}for(A=Math.min(w-1,v+3),n=Array(A-v),d=v+1;d<=A;d++)n[d-v-1]=r[d][v];for(t=numeric.house(n),l=numeric.getBlock(r,[v+1,v],[A,w-1]),p=numeric.tensor(t,numeric.dot(t,l)),d=v+1;d<=A;d++)for(h=r[d],g=p[d-v-1],y=v;y<w;y++)h[y]-=2*g[y-v];for(l=numeric.getBlock(r,[0,v+1],[w-1,A]),p=numeric.tensor(numeric.dot(l,t),t),d=0;d<w;d++)for(h=r[d],g=p[d],y=v+1;y<=A;y++)h[y]-=2*g[y-v-1];for(l=Array(A-v),d=v+1;d<=A;d++)l[d-v-1]=b[d];for(p=numeric.tensor(t,numeric.dot(t,l)),d=v+1;d<=A;d++)for(m=b[d],g=p[d-v-1],y=0;y<w;y++)m[y]-=2*g[y]}}throw new Error("numeric: eigenvalue iteration does not converge -- increase maxiter?")},numeric.eig=function(r,e){var n,t,i,o,u,c,a,f,s,m,h,l,p,g,d,v,y=numeric.toUpperHessenberg(r),x=numeric.QRFrancis(y.H,e),w=numeric.T,b=r.length,_=x.B,M=numeric.dot(x.Q,numeric.dot(y.H,numeric.transpose(x.Q))),k=new w(numeric.dot(x.Q,y.Q)),T=_.length,j=Math.sqrt;for(t=0;t<T;t++)if((n=_[t][0])===_[t][1]);else{if(o=n+1,u=M[n][n],c=M[n][o],a=M[o][n],f=M[o][o],0===c&&0===a)continue;(m=(s=-u-f)*s-4*(u*f-c*a))>=0?((d=(u-(h=s<0?-.5*(s-j(m)):-.5*(s+j(m))))*(u-h)+c*c)>(v=a*a+(f-h)*(f-h))?(p=(u-h)/(d=j(d)),g=c/d):(p=a/(v=j(v)),g=(f-h)/v),i=new w([[g,-p],[p,g]]),k.setRows(n,o,i.dot(k.getRows(n,o)))):(h=-.5*s,l=.5*j(-m),(d=(u-h)*(u-h)+c*c)>(v=a*a+(f-h)*(f-h))?(p=(u-h)/(d=j(d+l*l)),g=c/d,h=0,l/=d):(p=a/(v=j(v+l*l)),g=(f-h)/v,h=l/v,l=0),i=new w([[g,-p],[p,g]],[[h,l],[l,-h]]),k.setRows(n,o,i.dot(k.getRows(n,o))))}var A=k.dot(r).dot(k.transjugate()),S=(b=r.length,numeric.T.identity(b));for(o=0;o<b;o++)if(o>0)for(t=o-1;t>=0;t--){var P=A.get([t,t]),L=A.get([o,o]);numeric.neq(P.x,L.x)||numeric.neq(P.y,L.y)?(h=A.getRow(t).getBlock([t],[o-1]),l=S.getRow(o).getBlock([t],[o-1]),S.set([o,t],A.get([t,o]).neg().sub(h.dot(l)).div(P.sub(L)))):S.setRow(o,S.getRow(t))}for(o=0;o<b;o++)h=S.getRow(o),S.setRow(o,h.div(h.norm2()));return S=S.transpose(),S=k.transjugate().dot(S),{lambda:A.getDiag(),E:S}},numeric.ccsSparse=function(r){var e,n,t,i=r.length,o=[];for(n=i-1;-1!==n;--n)for(t in e=r[n]){for(t=parseInt(t);t>=o.length;)o[o.length]=0;0!==e[t]&&o[t]++}var u=o.length,c=Array(u+1);for(c[0]=0,n=0;n<u;++n)c[n+1]=c[n]+o[n];var a=Array(c[u]),f=Array(c[u]);for(n=i-1;-1!==n;--n)for(t in e=r[n])0!==e[t]&&(o[t]--,a[c[t]+o[t]]=n,f[c[t]+o[t]]=e[t]);return[c,a,f]},numeric.ccsFull=function(r){var e,n,t,i,o=r[0],u=r[1],c=r[2],a=numeric.ccsDim(r),f=a[0],s=a[1],m=numeric.rep([f,s],0);for(e=0;e<s;e++)for(t=o[e],i=o[e+1],n=t;n<i;++n)m[u[n]][e]=c[n];return m},numeric.ccsTSolve=function(r,e,n,t,i){var o,u,c,a,f,s,m,h=r[0],l=r[1],p=r[2],g=h.length-1,d=Math.max,v=0;function y(r){var e;if(0===n[r]){for(n[r]=1,e=h[r];e<h[r+1];++e)y(l[e]);i[v]=r,++v}}for(void 0===t&&(n=numeric.rep([g],0)),void 0===t&&(t=numeric.linspace(0,n.length-1)),void 0===i&&(i=[]),o=t.length-1;-1!==o;--o)y(t[o]);for(i.length=v,o=i.length-1;-1!==o;--o)n[i[o]]=0;for(o=t.length-1;-1!==o;--o)u=t[o],n[u]=e[u];for(o=i.length-1;-1!==o;--o){for(u=i[o],c=h[u],a=d(h[u+1],c),f=c;f!==a;++f)if(l[f]===u){n[u]/=p[f];break}for(m=n[u],f=c;f!==a;++f)(s=l[f])!==u&&(n[s]-=m*p[f])}return n},numeric.ccsDFS=function(r){this.k=Array(r),this.k1=Array(r),this.j=Array(r)},numeric.ccsDFS.prototype.dfs=function(r,e,n,t,i,o){var u,c,a,f=0,s=i.length,m=this.k,h=this.k1,l=this.j;if(0===t[r])for(t[r]=1,l[0]=r,m[0]=c=e[r],h[0]=a=e[r+1];;)if(c>=a){if(i[s]=l[f],0===f)return;++s,c=m[--f],a=h[f]}else 0===t[u=o[n[c]]]?(t[u]=1,m[f]=c,l[++f]=u,c=e[u],h[f]=a=e[u+1]):++c},numeric.ccsLPSolve=function(r,e,n,t,i,o,u){var c,a,f,s,m,h,l,p,g,d=r[0],v=r[1],y=r[2],x=(d.length,e[0]),w=e[1],b=e[2];for(a=x[i],f=x[i+1],t.length=0,c=a;c<f;++c)u.dfs(o[w[c]],d,v,n,t,o);for(c=t.length-1;-1!==c;--c)n[t[c]]=0;for(c=a;c!==f;++c)n[s=o[w[c]]]=b[c];for(c=t.length-1;-1!==c;--c){for(m=d[s=t[c]],h=d[s+1],l=m;l<h;++l)if(o[v[l]]===s){n[s]/=y[l];break}for(g=n[s],l=m;l<h;++l)(p=o[v[l]])!==s&&(n[p]-=g*y[l])}return n},numeric.ccsLUP1=function(r,e){var n,t,i,o,u,c,a,f=r[0].length-1,s=[numeric.rep([f+1],0),[],[]],m=[numeric.rep([f+1],0),[],[]],h=s[0],l=s[1],p=s[2],g=m[0],d=m[1],v=m[2],y=numeric.rep([f],0),x=numeric.rep([f],0),w=numeric.ccsLPSolve,b=(Math.max,Math.abs),_=numeric.linspace(0,f-1),M=numeric.linspace(0,f-1),k=new numeric.ccsDFS(f);for(void 0===e&&(e=1),n=0;n<f;++n){for(w(s,r,y,x,n,M,k),o=-1,u=-1,t=x.length-1;-1!==t;--t)(i=x[t])<=n||(c=b(y[i]))>o&&(u=i,o=c);for(b(y[n])<e*o&&(t=_[n],o=_[u],_[n]=o,M[o]=n,_[u]=t,M[t]=u,o=y[n],y[n]=y[u],y[u]=o),o=h[n],u=g[n],a=y[n],l[o]=_[n],p[o]=1,++o,t=x.length-1;-1!==t;--t)c=y[i=x[t]],x[t]=0,y[i]=0,i<=n?(d[u]=i,v[u]=c,++u):(l[o]=_[i],p[o]=c/a,++o);h[n+1]=o,g[n+1]=u}for(t=l.length-1;-1!==t;--t)l[t]=M[l[t]];return{L:s,U:m,P:_,Pinv:M}},numeric.ccsDFS0=function(r){this.k=Array(r),this.k1=Array(r),this.j=Array(r)},numeric.ccsDFS0.prototype.dfs=function(r,e,n,t,i,o,u){var c,a,f,s=0,m=i.length,h=this.k,l=this.k1,p=this.j;if(0===t[r])for(t[r]=1,p[0]=r,h[0]=a=e[o[r]],l[0]=f=e[o[r]+1];;){if(isNaN(a))throw new Error("Ow!");if(a>=f){if(i[m]=o[p[s]],0===s)return;++m,a=h[--s],f=l[s]}else 0===t[c=n[a]]?(t[c]=1,h[s]=a,p[++s]=c,a=e[c=o[c]],l[s]=f=e[c+1]):++a}},numeric.ccsLPSolve0=function(r,e,n,t,i,o,u,c){var a,f,s,m,h,l,p,g,d,v=r[0],y=r[1],x=r[2],w=(v.length,e[0]),b=e[1],_=e[2];for(f=w[i],s=w[i+1],t.length=0,a=f;a<s;++a)c.dfs(b[a],v,y,n,t,o,u);for(a=t.length-1;-1!==a;--a)n[u[m=t[a]]]=0;for(a=f;a!==s;++a)n[m=b[a]]=_[a];for(a=t.length-1;-1!==a;--a){for(g=u[m=t[a]],h=v[m],l=v[m+1],p=h;p<l;++p)if(y[p]===g){n[g]/=x[p];break}for(d=n[g],p=h;p<l;++p)n[y[p]]-=d*x[p];n[g]=d}},numeric.ccsLUP0=function(r,e){var n,t,i,o,u,c,a,f=r[0].length-1,s=[numeric.rep([f+1],0),[],[]],m=[numeric.rep([f+1],0),[],[]],h=s[0],l=s[1],p=s[2],g=m[0],d=m[1],v=m[2],y=numeric.rep([f],0),x=numeric.rep([f],0),w=numeric.ccsLPSolve0,b=(Math.max,Math.abs),_=numeric.linspace(0,f-1),M=numeric.linspace(0,f-1),k=new numeric.ccsDFS0(f);for(void 0===e&&(e=1),n=0;n<f;++n){for(w(s,r,y,x,n,M,_,k),o=-1,u=-1,t=x.length-1;-1!==t;--t)(i=x[t])<=n||(c=b(y[_[i]]))>o&&(u=i,o=c);for(b(y[_[n]])<e*o&&(t=_[n],o=_[u],_[n]=o,M[o]=n,_[u]=t,M[t]=u),o=h[n],u=g[n],a=y[_[n]],l[o]=_[n],p[o]=1,++o,t=x.length-1;-1!==t;--t)c=y[_[i=x[t]]],x[t]=0,y[_[i]]=0,i<=n?(d[u]=i,v[u]=c,++u):(l[o]=_[i],p[o]=c/a,++o);h[n+1]=o,g[n+1]=u}for(t=l.length-1;-1!==t;--t)l[t]=M[l[t]];return{L:s,U:m,P:_,Pinv:M}},numeric.ccsLUP=numeric.ccsLUP0,numeric.ccsDim=function(r){return[numeric.sup(r[1])+1,r[0].length-1]},numeric.ccsGetBlock=function(r,e,n){var t=numeric.ccsDim(r),i=t[0],o=t[1];void 0===e?e=numeric.linspace(0,i-1):"number"==typeof e&&(e=[e]),void 0===n?n=numeric.linspace(0,o-1):"number"==typeof n&&(n=[n]);var u,c,a,f,s=e.length,m=n.length,h=numeric.rep([o],0),l=[],p=[],g=[h,l,p],d=r[0],v=r[1],y=r[2],x=numeric.rep([i],0),w=0,b=numeric.rep([i],0);for(c=0;c<m;++c){var _=d[f=n[c]],M=d[f+1];for(u=_;u<M;++u)b[a=v[u]]=1,x[a]=y[u];for(u=0;u<s;++u)b[e[u]]&&(l[w]=u,p[w]=x[e[u]],++w);for(u=_;u<M;++u)b[a=v[u]]=0;h[c+1]=w}return g},numeric.ccsDot=function(r,e){var n,t,i,o,u,c,a,f,s,m,h,l=r[0],p=r[1],g=r[2],d=e[0],v=e[1],y=e[2],x=numeric.ccsDim(r),w=numeric.ccsDim(e),b=x[0],_=(x[1],w[1]),M=numeric.rep([b],0),k=numeric.rep([b],0),T=Array(b),j=numeric.rep([_],0),A=[],S=[],P=[j,A,S];for(i=0;i!==_;++i){for(o=d[i],u=d[i+1],s=0,t=o;t<u;++t)for(m=v[t],h=y[t],c=l[m],a=l[m+1],n=c;n<a;++n)0===k[f=p[n]]&&(T[s]=f,k[f]=1,s+=1),M[f]=M[f]+g[n]*h;for(u=(o=j[i])+s,j[i+1]=u,t=s-1;-1!==t;--t)h=o+t,n=T[t],A[h]=n,S[h]=M[n],k[n]=0,M[n]=0;j[i+1]=j[i]+s}return P},numeric.ccsLUPSolve=function(r,e){var n=r.L,t=r.U,i=(r.P,e[0]),o=!1;"object"!=typeof i&&(i=(e=[[0,e.length],numeric.linspace(0,e.length-1),e])[0],o=!0);var u,c,a,f,s,m,h=e[1],l=e[2],p=n[0].length-1,g=i.length-1,d=numeric.rep([p],0),v=Array(p),y=numeric.rep([p],0),x=Array(p),w=numeric.rep([g+1],0),b=[],_=[],M=numeric.ccsTSolve,k=0;for(u=0;u<g;++u){for(s=0,a=i[u],f=i[u+1],c=a;c<f;++c)m=r.Pinv[h[c]],x[s]=m,y[m]=l[c],++s;for(x.length=s,M(n,y,d,x,v),c=x.length-1;-1!==c;--c)y[x[c]]=0;if(M(t,d,y,v,x),o)return y;for(c=v.length-1;-1!==c;--c)d[v[c]]=0;for(c=x.length-1;-1!==c;--c)m=x[c],b[k]=m,_[k]=y[m],y[m]=0,++k;w[u+1]=k}return[w,b,_]},numeric.ccsbinop=function(r,e){return void 0===e&&(e=""),Function("X","Y","var Xi = X[0], Xj = X[1], Xv = X[2];\nvar Yi = Y[0], Yj = Y[1], Yv = Y[2];\nvar n = Xi.length-1,m = Math.max(numeric.sup(Xj),numeric.sup(Yj))+1;\nvar Zi = numeric.rep([n+1],0), Zj = [], Zv = [];\nvar x = numeric.rep([m],0),y = numeric.rep([m],0);\nvar xk,yk,zk;\nvar i,j,j0,j1,k,p=0;\n"+e+"for(i=0;i<n;++i) {\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Xj[j];\n    x[k] = 1;\n    Zj[p] = k;\n    ++p;\n  }\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Yj[j];\n    y[k] = Yv[j];\n    if(x[k] === 0) {\n      Zj[p] = k;\n      ++p;\n    }\n  }\n  Zi[i+1] = p;\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = Xv[j];\n  j0 = Zi[i]; j1 = Zi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Zj[j];\n    xk = x[k];\n    yk = y[k];\n"+r+"\n    Zv[j] = zk;\n  }\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = 0;\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) y[Yj[j]] = 0;\n}\nreturn [Zi,Zj,Zv];")},function(){var k,A,B,C;for(k in numeric.ops2)A=isFinite(eval("1"+numeric.ops2[k]+"0"))?"[Y[0],Y[1],numeric."+k+"(X,Y[2])]":"NaN",B=isFinite(eval("0"+numeric.ops2[k]+"1"))?"[X[0],X[1],numeric."+k+"(X[2],Y)]":"NaN",C=isFinite(eval("1"+numeric.ops2[k]+"0"))&&isFinite(eval("0"+numeric.ops2[k]+"1"))?"numeric.ccs"+k+"MM(X,Y)":"NaN",numeric["ccs"+k+"MM"]=numeric.ccsbinop("zk = xk "+numeric.ops2[k]+"yk;"),numeric["ccs"+k]=Function("X","Y",'if(typeof X === "number") return '+A+';\nif(typeof Y === "number") return '+B+";\nreturn "+C+";\n")}(),numeric.ccsScatter=function(r){var e,n=r[0],t=r[1],i=r[2],o=numeric.sup(t)+1,u=n.length,c=numeric.rep([o],0),a=Array(u),f=Array(u),s=numeric.rep([o],0);for(e=0;e<u;++e)s[t[e]]++;for(e=0;e<o;++e)c[e+1]=c[e]+s[e];var m,h,l=c.slice(0);for(e=0;e<u;++e)a[m=l[h=t[e]]]=n[e],f[m]=i[e],l[h]=l[h]+1;return[c,a,f]},numeric.ccsGather=function(r){var e,n,t,i,o,u=r[0],c=r[1],a=r[2],f=u.length-1,s=c.length,m=Array(s),h=Array(s),l=Array(s);for(o=0,e=0;e<f;++e)for(t=u[e],i=u[e+1],n=t;n!==i;++n)h[o]=e,m[o]=c[n],l[o]=a[n],++o;return[m,h,l]},numeric.sdim=function r(e,n,t){if(void 0===n&&(n=[]),"object"!=typeof e)return n;var i;for(i in void 0===t&&(t=0),t in n||(n[t]=0),e.length>n[t]&&(n[t]=e.length),e)e.hasOwnProperty(i)&&r(e[i],n,t+1);return n},numeric.sclone=function r(e,n,t){void 0===n&&(n=0),void 0===t&&(t=numeric.sdim(e).length);var i,o=Array(e.length);if(n===t-1){for(i in e)e.hasOwnProperty(i)&&(o[i]=e[i]);return o}for(i in e)e.hasOwnProperty(i)&&(o[i]=r(e[i],n+1,t));return o},numeric.sdiag=function(r){var e,n,t=r.length,i=Array(t);for(e=t-1;e>=1;e-=2)n=e-1,i[e]=[],i[e][e]=r[e],i[n]=[],i[n][n]=r[n];return 0===e&&(i[0]=[],i[0][0]=r[e]),i},numeric.sidentity=function(r){return numeric.sdiag(numeric.rep([r],1))},numeric.stranspose=function(r){var e,n,t,i=[];for(e in r.length,r)if(r.hasOwnProperty(e))for(n in t=r[e])t.hasOwnProperty(n)&&("object"!=typeof i[n]&&(i[n]=[]),i[n][e]=t[n]);return i},numeric.sLUP=function(r,e){throw new Error("The function numeric.sLUP had a bug in it and has been removed. Please use the new numeric.ccsLUP function instead.")},numeric.sdotMM=function(r,e){var n,t,i,o,u,c,a,f=r.length,s=(e.length,numeric.stranspose(e)),m=s.length,h=Array(f);for(i=f-1;i>=0;i--){for(a=[],n=r[i],u=m-1;u>=0;u--){for(o in c=0,t=s[u],n)n.hasOwnProperty(o)&&o in t&&(c+=n[o]*t[o]);c&&(a[u]=c)}h[i]=a}return h},numeric.sdotMV=function(r,e){var n,t,i,o,u=r.length,c=Array(u);for(t=u-1;t>=0;t--){for(i in o=0,n=r[t])n.hasOwnProperty(i)&&e[i]&&(o+=n[i]*e[i]);o&&(c[t]=o)}return c},numeric.sdotVM=function(r,e){var n,t,i,o,u=[];for(n in r)if(r.hasOwnProperty(n))for(t in i=e[n],o=r[n],i)i.hasOwnProperty(t)&&(u[t]||(u[t]=0),u[t]+=o*i[t]);return u},numeric.sdotVV=function(r,e){var n,t=0;for(n in r)r[n]&&e[n]&&(t+=r[n]*e[n]);return t},numeric.sdot=function(r,e){var n=numeric.sdim(r).length,t=numeric.sdim(e).length;switch(1e3*n+t){case 0:return r*e;case 1001:return numeric.sdotVV(r,e);case 2001:return numeric.sdotMV(r,e);case 1002:return numeric.sdotVM(r,e);case 2002:return numeric.sdotMM(r,e);default:throw new Error("numeric.sdot not implemented for tensors of order "+n+" and "+t)}},numeric.sscatter=function(r){var e,n,t,i,o=r[0].length,u=r.length,c=[];for(n=o-1;n>=0;--n)if(r[u-1][n]){for(i=c,t=0;t<u-2;t++)i[e=r[t][n]]||(i[e]=[]),i=i[e];i[r[t][n]]=r[t+1][n]}return c},numeric.sgather=function r(e,n,t){var i,o,u;for(o in void 0===n&&(n=[]),void 0===t&&(t=[]),i=t.length,e)if(e.hasOwnProperty(o))if(t[i]=parseInt(o),"number"==typeof(u=e[o])){if(u){if(0===n.length)for(o=i+1;o>=0;--o)n[o]=[];for(o=i;o>=0;--o)n[o].push(t[o]);n[i+1].push(u)}}else r(u,n,t);return t.length>i&&t.pop(),n},numeric.cLU=function(r){var e,n,t,i,o,u,c=r[0],a=r[1],f=r[2],s=c.length,m=0;for(e=0;e<s;e++)c[e]>m&&(m=c[e]);m++;var h,l=Array(m),p=Array(m),g=numeric.rep([m],1/0),d=numeric.rep([m],-1/0);for(t=0;t<s;t++)e=c[t],(n=a[t])<g[e]&&(g[e]=n),n>d[e]&&(d[e]=n);for(e=0;e<m-1;e++)d[e]>d[e+1]&&(d[e+1]=d[e]);for(e=m-1;e>=1;e--)g[e]<g[e-1]&&(g[e-1]=g[e]);for(e=0;e<m;e++)p[e]=numeric.rep([d[e]-g[e]+1],0),l[e]=numeric.rep([e-g[e]],0),g[e],d[e];for(t=0;t<s;t++)p[e=c[t]][a[t]-g[e]]=f[t];for(e=0;e<m-1;e++)for(i=e-g[e],x=p[e],n=e+1;g[n]<=e&&n<m;n++)if(o=e-g[n],u=d[e]-e,h=(w=p[n])[o]/x[i]){for(t=1;t<=u;t++)w[t+o]-=h*x[t+i];l[n][e-g[n]]=h}var v,y,x=[],w=[],b=[],_=[],M=[],k=[];for(s=0,v=0,e=0;e<m;e++){for(i=g[e],o=d[e],y=p[e],n=e;n<=o;n++)y[n-i]&&(x[s]=e,w[s]=n,b[s]=y[n-i],s++);for(y=l[e],n=i;n<e;n++)y[n-i]&&(_[v]=e,M[v]=n,k[v]=y[n-i],v++);_[v]=e,M[v]=e,k[v]=1,v++}return{U:[x,w,b],L:[_,M,k]}},numeric.cLUsolve=function(r,e){var n,t,i=r.L,o=r.U,u=numeric.clone(e),c=i[0],a=i[1],f=i[2],s=o[0],m=o[1],h=o[2],l=s.length,p=(c.length,u.length);for(t=0,n=0;n<p;n++){for(;a[t]<n;)u[n]-=f[t]*u[a[t]],t++;t++}for(t=l-1,n=p-1;n>=0;n--){for(;m[t]>n;)u[n]-=h[t]*u[m[t]],t--;u[n]/=h[t],t--}return u},numeric.cgrid=function(r,e){"number"==typeof r&&(r=[r,r]);var n,t,i,o=numeric.rep(r,-1);if("function"!=typeof e)switch(e){case"L":e=function(e,n){return e>=r[0]/2||n<r[1]/2};break;default:e=function(r,e){return!0}}for(i=0,n=1;n<r[0]-1;n++)for(t=1;t<r[1]-1;t++)e(n,t)&&(o[n][t]=i,i++);return o},numeric.cdelsq=function(r){var e,n,t,i,o,u=[[-1,0],[0,-1],[0,1],[1,0]],c=numeric.dim(r),a=c[0],f=c[1],s=[],m=[],h=[];for(e=1;e<a-1;e++)for(n=1;n<f-1;n++)if(!(r[e][n]<0)){for(t=0;t<4;t++)i=e+u[t][0],o=n+u[t][1],r[i][o]<0||(s.push(r[e][n]),m.push(r[i][o]),h.push(-1));s.push(r[e][n]),m.push(r[e][n]),h.push(4)}return[s,m,h]},numeric.cdotMV=function(r,e){var n,t,i,o=r[0],u=r[1],c=r[2],a=o.length;for(i=0,t=0;t<a;t++)o[t]>i&&(i=o[t]);for(i++,n=numeric.rep([i],0),t=0;t<a;t++)n[o[t]]+=c[t]*e[u[t]];return n},numeric.Spline=function(r,e,n,t,i){this.x=r,this.yl=e,this.yr=n,this.kl=t,this.kr=i},numeric.Spline.prototype._at=function(r,e){var n,t,i,o=this.x,u=this.yl,c=this.yr,a=this.kl,f=this.kr,s=numeric.add,m=numeric.sub,h=numeric.mul;n=m(h(a[e],o[e+1]-o[e]),m(c[e+1],u[e])),t=s(h(f[e+1],o[e]-o[e+1]),m(c[e+1],u[e]));var l=(i=(r-o[e])/(o[e+1]-o[e]))*(1-i);return s(s(s(h(1-i,u[e]),h(i,c[e+1])),h(n,l*(1-i))),h(t,l*i))},numeric.Spline.prototype.at=function(r){if("number"==typeof r){var e,n,t,i=this.x,o=i.length,u=Math.floor;for(e=0,n=o-1;n-e>1;)i[t=u((e+n)/2)]<=r?e=t:n=t;return this._at(r,e)}o=r.length;var c,a=Array(o);for(c=o-1;-1!==c;--c)a[c]=this.at(r[c]);return a},numeric.Spline.prototype.diff=function(){var r,e,n,t=this.x,i=this.yl,o=this.yr,u=this.kl,c=this.kr,a=i.length,f=u,s=c,m=Array(a),h=Array(a),l=numeric.add,p=numeric.mul,g=numeric.div,d=numeric.sub;for(r=a-1;-1!==r;--r)e=t[r+1]-t[r],n=d(o[r+1],i[r]),m[r]=g(l(p(n,6),p(u[r],-4*e),p(c[r+1],-2*e)),e*e),h[r+1]=g(l(p(n,-6),p(u[r],2*e),p(c[r+1],4*e)),e*e);return new numeric.Spline(t,f,s,m,h)},numeric.Spline.prototype.roots=function(){function r(r){return r*r}var e=[],n=this.x,t=this.yl,i=this.yr,o=this.kl,u=this.kr;"number"==typeof t[0]&&(t=[t],i=[i],o=[o],u=[u]);var c,a,f,s,m,h,l,p,g,d,v,y,x,w,b,_,M,k,T,j,A,S,P,L=t.length,E=n.length-1,q=(e=Array(L),Math.sqrt);for(c=0;c!==L;++c){for(s=t[c],m=i[c],h=o[c],l=u[c],p=[],a=0;a!==E;a++){for(a>0&&m[a]*s[a]<0&&p.push(n[a]),_=n[a+1]-n[a],n[a],v=s[a],y=m[a+1],g=h[a]/_,x=(d=l[a+1]/_)+3*v+2*g-3*y,w=3*(d+g+2*(v-y)),(b=r(g-d+3*(v-y))+12*d*v)<=0?M=(k=x/w)>n[a]&&k<n[a+1]?[n[a],k,n[a+1]]:[n[a],n[a+1]]:(k=(x-q(b))/w,T=(x+q(b))/w,M=[n[a]],k>n[a]&&k<n[a+1]&&M.push(k),T>n[a]&&T<n[a+1]&&M.push(T),M.push(n[a+1])),A=M[0],k=this._at(A,a),f=0;f<M.length-1;f++)if(S=M[f+1],T=this._at(S,a),0!==k)if(0===T||k*T>0)A=S,k=T;else{for(var N=0;!((P=(k*S-T*A)/(k-T))<=A||P>=S);)if((j=this._at(P,a))*T>0)S=P,T=j,-1===N&&(k*=.5),N=-1;else{if(!(j*k>0))break;A=P,k=j,1===N&&(T*=.5),N=1}p.push(P),A=M[f+1],k=this._at(A,a)}else p.push(A),A=S,k=T;0===T&&p.push(S)}e[c]=p}return"number"==typeof this.yl[0]?e[0]:e},numeric.spline=function(r,e,n,t){var i,o=r.length,u=[],c=[],a=[],f=numeric.sub,s=numeric.mul,m=numeric.add;for(i=o-2;i>=0;i--)c[i]=r[i+1]-r[i],a[i]=f(e[i+1],e[i]);"string"!=typeof n&&"string"!=typeof t||(n=t="periodic");var h=[[],[],[]];switch(typeof n){case"undefined":u[0]=s(3/(c[0]*c[0]),a[0]),h[0].push(0,0),h[1].push(0,1),h[2].push(2/c[0],1/c[0]);break;case"string":u[0]=m(s(3/(c[o-2]*c[o-2]),a[o-2]),s(3/(c[0]*c[0]),a[0])),h[0].push(0,0,0),h[1].push(o-2,0,1),h[2].push(1/c[o-2],2/c[o-2]+2/c[0],1/c[0]);break;default:u[0]=n,h[0].push(0),h[1].push(0),h[2].push(1)}for(i=1;i<o-1;i++)u[i]=m(s(3/(c[i-1]*c[i-1]),a[i-1]),s(3/(c[i]*c[i]),a[i])),h[0].push(i,i,i),h[1].push(i-1,i,i+1),h[2].push(1/c[i-1],2/c[i-1]+2/c[i],1/c[i]);switch(typeof t){case"undefined":u[o-1]=s(3/(c[o-2]*c[o-2]),a[o-2]),h[0].push(o-1,o-1),h[1].push(o-2,o-1),h[2].push(1/c[o-2],2/c[o-2]);break;case"string":h[1][h[1].length-1]=0;break;default:u[o-1]=t,h[0].push(o-1),h[1].push(o-1),h[2].push(1)}u="number"!=typeof u[0]?numeric.transpose(u):[u];var l=Array(u.length);if("string"==typeof n)for(i=l.length-1;-1!==i;--i)l[i]=numeric.ccsLUPSolve(numeric.ccsLUP(numeric.ccsScatter(h)),u[i]),l[i][o-1]=l[i][0];else for(i=l.length-1;-1!==i;--i)l[i]=numeric.cLUsolve(numeric.cLU(h),u[i]);return l="number"==typeof e[0]?l[0]:numeric.transpose(l),new numeric.Spline(r,e,e,l,l)},numeric.fftpow2=function r(e,n){var t=e.length;if(1!==t){var i,o,u=Math.cos,c=Math.sin,a=Array(t/2),f=Array(t/2),s=Array(t/2),m=Array(t/2);for(o=t/2,i=t-1;-1!==i;--i)s[--o]=e[i],m[o]=n[i],--i,a[o]=e[i],f[o]=n[i];r(a,f),r(s,m),o=t/2;var h,l,p,g=-6.283185307179586/t;for(i=t-1;-1!==i;--i)-1==--o&&(o=t/2-1),l=u(h=g*i),p=c(h),e[i]=a[o]+l*s[o]-p*m[o],n[i]=f[o]+l*m[o]+p*s[o]}},numeric._ifftpow2=function r(e,n){var t=e.length;if(1!==t){var i,o,u=Math.cos,c=Math.sin,a=Array(t/2),f=Array(t/2),s=Array(t/2),m=Array(t/2);for(o=t/2,i=t-1;-1!==i;--i)s[--o]=e[i],m[o]=n[i],--i,a[o]=e[i],f[o]=n[i];r(a,f),r(s,m),o=t/2;var h,l,p,g=6.283185307179586/t;for(i=t-1;-1!==i;--i)-1==--o&&(o=t/2-1),l=u(h=g*i),p=c(h),e[i]=a[o]+l*s[o]-p*m[o],n[i]=f[o]+l*m[o]+p*s[o]}},numeric.ifftpow2=function(r,e){numeric._ifftpow2(r,e),numeric.diveq(r,r.length),numeric.diveq(e,e.length)},numeric.convpow2=function(r,e,n,t){var i,o,u,c,a;for(numeric.fftpow2(r,e),numeric.fftpow2(n,t),i=r.length-1;-1!==i;--i)o=r[i],c=e[i],u=n[i],a=t[i],r[i]=o*u-c*a,e[i]=o*a+c*u;numeric.ifftpow2(r,e)},numeric.T.prototype.fft=function(){var r,e,n=this.x,t=this.y,i=n.length,o=Math.log,u=o(2),c=Math.ceil(o(2*i-1)/u),a=Math.pow(2,c),f=numeric.rep([a],0),s=numeric.rep([a],0),m=Math.cos,h=Math.sin,l=-3.141592653589793/i,p=numeric.rep([a],0),g=numeric.rep([a],0);for(Math.floor(i/2),r=0;r<i;r++)p[r]=n[r];if(void 0!==t)for(r=0;r<i;r++)g[r]=t[r];for(f[0]=1,r=1;r<=a/2;r++)e=l*r*r,f[r]=m(e),s[r]=h(e),f[a-r]=m(e),s[a-r]=h(e);var d=new numeric.T(p,g),v=new numeric.T(f,s);return d=d.mul(v),numeric.convpow2(d.x,d.y,numeric.clone(v.x),numeric.neg(v.y)),(d=d.mul(v)).x.length=i,d.y.length=i,d},numeric.T.prototype.ifft=function(){var r,e,n=this.x,t=this.y,i=n.length,o=Math.log,u=o(2),c=Math.ceil(o(2*i-1)/u),a=Math.pow(2,c),f=numeric.rep([a],0),s=numeric.rep([a],0),m=Math.cos,h=Math.sin,l=3.141592653589793/i,p=numeric.rep([a],0),g=numeric.rep([a],0);for(Math.floor(i/2),r=0;r<i;r++)p[r]=n[r];if(void 0!==t)for(r=0;r<i;r++)g[r]=t[r];for(f[0]=1,r=1;r<=a/2;r++)e=l*r*r,f[r]=m(e),s[r]=h(e),f[a-r]=m(e),s[a-r]=h(e);var d=new numeric.T(p,g),v=new numeric.T(f,s);return d=d.mul(v),numeric.convpow2(d.x,d.y,numeric.clone(v.x),numeric.neg(v.y)),(d=d.mul(v)).x.length=i,d.y.length=i,d.div(i)},numeric.gradient=function(r,e){var n=e.length,t=r(e);if(isNaN(t))throw new Error("gradient: f(x) is a NaN!");var i,o,u,c,a,f,s,m,h,l=Math.max,p=numeric.clone(e),g=Array(n),d=(numeric.div,numeric.sub,l=Math.max,Math.abs),v=Math.min,y=0;for(i=0;i<n;i++)for(var x=l(1e-6*t,1e-8);;){if(++y>20)throw new Error("Numerical gradient fails");if(p[i]=e[i]+x,o=r(p),p[i]=e[i]-x,u=r(p),p[i]=e[i],isNaN(o)||isNaN(u))x/=16;else{if(g[i]=(o-u)/(2*x),c=e[i]-x,a=e[i],f=e[i]+x,s=(o-t)/x,m=(t-u)/x,h=l(d(g[i]),d(t),d(o),d(u),d(c),d(a),d(f),1e-8),!(v(l(d(s-g[i]),d(m-g[i]),d(s-m))/h,x/h)>.001))break;x/=16}}return g},numeric.uncmin=function(r,e,n,t,i,o,u){var c=numeric.gradient;void 0===u&&(u={}),void 0===n&&(n=1e-8),void 0===t&&(t=function(e){return c(r,e)}),void 0===i&&(i=1e3);var a,f,s=(e=numeric.clone(e)).length,m=r(e);if(isNaN(m))throw new Error("uncmin: f(x0) is a NaN!");var h=Math.max,l=numeric.norm2;n=h(n,numeric.epsilon);var p,g,d,v,y,x,w,b,_,M,k=u.Hinv||numeric.identity(s),T=numeric.dot,j=(numeric.inv,numeric.sub),A=numeric.add,S=numeric.tensor,P=numeric.div,L=numeric.mul,E=numeric.all,q=numeric.isFinite,N=numeric.neg,V=0,F="";for(g=t(e);V<i;){if("function"==typeof o&&o(V,e,m,g,k)){F="Callback returned true";break}if(!E(q(g))){F="Gradient has Infinity or NaN";break}if(!E(q(p=N(T(k,g))))){F="Search direction has Infinity or NaN";break}if((M=l(p))<n){F="Newton step smaller than tol";break}for(_=1,f=T(g,p),y=e;V<i&&!(_*M<n)&&(y=A(e,v=L(p,_)),(a=r(y))-m>=.1*_*f||isNaN(a));)_*=.5,++V;if(_*M<n){F="Line search step size smaller than tol";break}if(V===i){F="maxit reached during line search";break}b=T(x=j(d=t(y),g),v),w=T(k,x),k=j(A(k,L((b+T(x,w))/(b*b),S(v,v))),P(A(S(w,v),S(v,w)),b)),e=y,m=a,g=d,++V}return{solution:e,f:m,gradient:g,invHessian:k,iterations:V,message:F}},numeric.Dopri=function(r,e,n,t,i,o,u){this.x=r,this.y=e,this.f=n,this.ymid=t,this.iterations=i,this.events=u,this.message=o},numeric.Dopri.prototype._at=function(r,e){function n(r){return r*r}var t,i,o,u,c,a,f,s,m,h=this,l=h.x,p=h.y,g=h.f,d=h.ymid,v=(l.length,Math.floor,numeric.add),y=numeric.mul,x=numeric.sub;return t=l[e],i=l[e+1],u=p[e],c=p[e+1],o=t+.5*(i-t),a=d[e],f=x(g[e],y(u,1/(t-o)+2/(t-i))),s=x(g[e+1],y(c,1/(i-o)+2/(i-t))),v(v(v(v(y(u,(m=[n(r-i)*(r-o)/n(t-i)/(t-o),n(r-t)*n(r-i)/n(t-o)/n(i-o),n(r-t)*(r-o)/n(i-t)/(i-o),(r-t)*n(r-i)*(r-o)/n(t-i)/(t-o),(r-i)*n(r-t)*(r-o)/n(t-i)/(i-o)])[0]),y(a,m[1])),y(c,m[2])),y(f,m[3])),y(s,m[4]))},numeric.Dopri.prototype.at=function(r){var e,n,t,i=Math.floor;if("number"!=typeof r){var o=r.length,u=Array(o);for(e=o-1;-1!==e;--e)u[e]=this.at(r[e]);return u}var c=this.x;for(e=0,n=c.length-1;n-e>1;)c[t=i(.5*(e+n))]<=r?e=t:n=t;return this._at(r,e)},numeric.dopri=function(r,e,n,t,i,o,u){void 0===i&&(i=1e-6),void 0===o&&(o=1e3);var c,a,f,s,m,h,l,p,g,d,v,y,x,w=[r],b=[n],_=[t(r,n)],M=[],k=[3/40,9/40],T=[44/45,-56/15,32/9],j=[19372/6561,-25360/2187,64448/6561,-212/729],A=[9017/3168,-355/33,46732/5247,49/176,-5103/18656],S=[35/384,0,500/1113,125/192,-2187/6784,11/84],P=[.10013431883002395,0,.3918321794184259,-.02982460176594817,.05893268337240795,-.04497888809104361,5618549.5/235043384],L=[.2,.3,.8,8/9,1,1],E=[-71/57600,0,71/16695,-71/1920,17253/339200,-22/525,1/40],q=0,N=(e-r)/10,V=0,F=numeric.add,D=numeric.mul,O=(Math.max,Math.min),R=Math.abs,C=numeric.norminf,U=Math.pow,B=numeric.any,I=numeric.lt,Q=numeric.and,W=(numeric.sub,new numeric.Dopri(w,b,_,M,-1,""));for("function"==typeof u&&(v=u(r,n));r<e&&V<o;)if(++V,r+N>e&&(N=e-r),c=t(r+L[0]*N,F(n,D(.2*N,_[q]))),a=t(r+L[1]*N,F(F(n,D(k[0]*N,_[q])),D(k[1]*N,c))),f=t(r+L[2]*N,F(F(F(n,D(T[0]*N,_[q])),D(T[1]*N,c)),D(T[2]*N,a))),s=t(r+L[3]*N,F(F(F(F(n,D(j[0]*N,_[q])),D(j[1]*N,c)),D(j[2]*N,a)),D(j[3]*N,f))),m=t(r+L[4]*N,F(F(F(F(F(n,D(A[0]*N,_[q])),D(A[1]*N,c)),D(A[2]*N,a)),D(A[3]*N,f)),D(A[4]*N,s))),h=t(r+N,g=F(F(F(F(F(n,D(_[q],N*S[0])),D(a,N*S[2])),D(f,N*S[3])),D(s,N*S[4])),D(m,N*S[5]))),(d="number"==typeof(l=F(F(F(F(F(D(_[q],N*E[0]),D(a,N*E[2])),D(f,N*E[3])),D(s,N*E[4])),D(m,N*E[5])),D(h,N*E[6])))?R(l):C(l))>i){if(r+(N=.2*N*U(i/d,.25))===r){W.msg="Step size became too small";break}}else{if(M[q]=F(F(F(F(F(F(n,D(_[q],N*P[0])),D(a,N*P[2])),D(f,N*P[3])),D(s,N*P[4])),D(m,N*P[5])),D(h,N*P[6])),w[++q]=r+N,b[q]=g,_[q]=h,"function"==typeof u){var z,X,Y=r,H=r+.5*N;if(y=u(H,M[q-1]),B(x=Q(I(v,0),I(0,y)))||(Y=H,v=y,y=u(H=r+N,g),x=Q(I(v,0),I(0,y))),B(x)){for(var G,Z,$=0,K=1,J=1;;){if("number"==typeof v)X=(J*y*Y-K*v*H)/(J*y-K*v);else for(X=H,p=v.length-1;-1!==p;--p)v[p]<0&&y[p]>0&&(X=O(X,(J*y[p]*Y-K*v[p]*H)/(J*y[p]-K*v[p])));if(X<=Y||X>=H)break;Z=u(X,z=W._at(X,q-1)),B(G=Q(I(v,0),I(0,Z)))?(H=X,y=Z,x=G,J=1,-1===$?K*=.5:K=1,$=-1):(Y=X,v=Z,K=1,1===$?J*=.5:J=1,$=1)}return g=W._at(.5*(r+X),q-1),W.f[q]=t(X,z),W.x[q]=X,W.y[q]=z,W.ymid[q-1]=g,W.events=x,W.iterations=V,W}}r+=N,n=g,v=y,N=O(.8*N*U(i/d,.25),4*N)}return W.iterations=V,W},numeric.LU=function(r,e){e=e||!1;var n,t,i,o,u,c,a,f,s,m=Math.abs,h=r.length,l=h-1,p=new Array(h);for(e||(r=numeric.clone(r)),i=0;i<h;++i){for(a=i,s=m((c=r[i])[i]),t=i+1;t<h;++t)s<(o=m(r[t][i]))&&(s=o,a=t);for(p[i]=a,a!=i&&(r[i]=r[a],r[a]=c,c=r[i]),u=c[i],n=i+1;n<h;++n)r[n][i]/=u;for(n=i+1;n<h;++n){for(f=r[n],t=i+1;t<l;++t)f[t]-=f[i]*c[t],f[++t]-=f[i]*c[t];t===l&&(f[t]-=f[i]*c[t])}}return{LU:r,P:p}},numeric.LUsolve=function(r,e){var n,t,i,o,u,c=r.LU,a=c.length,f=numeric.clone(e),s=r.P;for(n=a-1;-1!==n;--n)f[n]=e[n];for(n=0;n<a;++n)for(i=s[n],s[n]!==n&&(u=f[n],f[n]=f[i],f[i]=u),o=c[n],t=0;t<n;++t)f[n]-=f[t]*o[t];for(n=a-1;n>=0;--n){for(o=c[n],t=n+1;t<a;++t)f[n]-=f[t]*o[t];f[n]/=o[n]}return f},numeric.solve=function(r,e,n){return numeric.LUsolve(numeric.LU(r,n),e)},numeric.echelonize=function(r){var e,n,t,i,o,u,c,a,f=numeric.dim(r),s=f[0],m=f[1],h=numeric.identity(s),l=Array(s),p=Math.abs,g=numeric.diveq;for(r=numeric.clone(r),e=0;e<s;++e){for(t=0,o=r[e],u=h[e],n=1;n<m;++n)p(o[t])<p(o[n])&&(t=n);for(l[e]=t,g(u,o[t]),g(o,o[t]),n=0;n<s;++n)if(n!==e){for(a=(c=r[n])[t],i=m-1;-1!==i;--i)c[i]-=o[i]*a;for(c=h[n],i=s-1;-1!==i;--i)c[i]-=u[i]*a}}return{I:h,A:r,P:l}},numeric.__solveLP=function(r,e,n,t,i,o,u){var c,a,f,s,m=numeric.sum,h=(numeric.log,numeric.mul),l=numeric.sub,p=numeric.dot,g=numeric.div,d=numeric.add,v=r.length,y=n.length,x=!1,w=1,b=(numeric.transpose(e),numeric.svd,numeric.transpose),_=(numeric.leq,Math.sqrt),M=Math.abs,k=(numeric.muleq,numeric.norminf,numeric.any,Math.min),T=numeric.all,j=numeric.gt,A=Array(v),S=Array(y),P=(numeric.rep([y],1),numeric.solve),L=l(n,p(e,o)),E=p(r,r);for(f=0;f<i;++f){var q,N;for(q=y-1;-1!==q;--q)S[q]=g(e[q],L[q]);var V=b(S);for(q=v-1;-1!==q;--q)A[q]=m(V[q]);w=.25*M(E/p(r,A));var F=100*_(E/p(A,A));for((!isFinite(w)||w>F)&&(w=F),s=d(r,h(w,A)),a=p(V,S),q=v-1;-1!==q;--q)a[q][q]+=1;N=P(a,g(s,w),!0);var D=g(L,p(e,N)),O=1;for(q=y-1;-1!==q;--q)D[q]<0&&(O=k(O,-.999*D[q]));if(c=l(o,h(N,O)),!T(j(L=l(n,p(e,c)),0)))return{solution:o,message:"",iterations:f};if(o=c,w<t)return{solution:c,message:"",iterations:f};if(u){var R=p(r,s),C=p(e,s);for(x=!0,q=y-1;-1!==q;--q)if(R*C[q]<0){x=!1;break}}else x=!(o[v-1]>=0);if(x)return{solution:c,message:"Unbounded",iterations:f}}return{solution:o,message:"maximum iteration count exceeded",iterations:f}},numeric._solveLP=function(r,e,n,t,i){var o=r.length,u=n.length,c=(numeric.sum,numeric.log,numeric.mul,numeric.sub),a=numeric.dot,f=(numeric.div,numeric.add,numeric.rep([o],0).concat([1])),s=numeric.rep([u,1],-1),m=numeric.blockMatrix([[e,s]]),h=n,l=numeric.rep([o],0).concat(Math.max(0,numeric.sup(numeric.neg(n)))+1),p=numeric.__solveLP(f,m,h,t,i,l,!1),g=numeric.clone(p.solution);if(g.length=o,numeric.inf(c(n,a(e,g)))<0)return{solution:NaN,message:"Infeasible",iterations:p.iterations};var d=numeric.__solveLP(r,e,n,t,i-p.iterations,g,!0);return d.iterations+=p.iterations,d},numeric.solveLP=function(r,e,n,t,i,o,u){if(void 0===u&&(u=1e3),void 0===o&&(o=numeric.epsilon),void 0===t)return numeric._solveLP(r,e,n,o,u);var c,a=t.length,f=t[0].length,s=e.length,m=numeric.echelonize(t),h=numeric.rep([f],0),l=m.P,p=[];for(c=l.length-1;-1!==c;--c)h[l[c]]=1;for(c=f-1;-1!==c;--c)0===h[c]&&p.push(c);var g=numeric.getRange,d=numeric.linspace(0,a-1),v=numeric.linspace(0,s-1),y=g(t,d,p),x=g(e,v,l),w=g(e,v,p),b=numeric.dot,_=numeric.sub,M=b(x,m.I),k=_(w,b(M,y)),T=_(n,b(M,i)),j=Array(l.length),A=Array(p.length);for(c=l.length-1;-1!==c;--c)j[c]=r[l[c]];for(c=p.length-1;-1!==c;--c)A[c]=r[p[c]];var S=_(A,b(j,b(m.I,y))),P=numeric._solveLP(S,k,T,o,u),L=P.solution;if(L!=L)return P;var E=b(m.I,_(i,b(y,L))),q=Array(r.length);for(c=l.length-1;-1!==c;--c)q[l[c]]=E[c];for(c=p.length-1;-1!==c;--c)q[p[c]]=L[c];return{solution:q,message:P.message,iterations:P.iterations}},numeric.MPStoLP=function(r){r instanceof String&&r.split("\n");var e,n,t,i,o=0,u=["Initial state","NAME","ROWS","COLUMNS","RHS","BOUNDS","ENDATA"],c=r.length,a=0,f={},s=[],m=0,h={},l=0,p=[],g=[],d=[];function v(n){throw new Error("MPStoLP: "+n+"\nLine "+e+": "+r[e]+"\nCurrent state: "+u[o]+"\n")}for(e=0;e<c;++e){var y=(t=r[e]).match(/\S*/g),x=[];for(n=0;n<y.length;++n)""!==y[n]&&x.push(y[n]);if(0!==x.length){for(n=0;n<u.length&&t.substr(0,u[n].length)!==u[n];++n);if(n<u.length){if(o=n,1===n&&(i=x[1]),6===n)return{name:i,c:p,A:numeric.transpose(g),b:d,rows:f,vars:h}}else switch(o){case 0:case 1:v("Unexpected line");case 2:switch(x[0]){case"N":0===a?a=x[1]:v("Two or more N rows");break;case"L":f[x[1]]=m,s[m]=1,d[m]=0,++m;break;case"G":f[x[1]]=m,s[m]=-1,d[m]=0,++m;break;case"E":f[x[1]]=m,s[m]=0,d[m]=0,++m;break;default:v("Parse error "+numeric.prettyPrint(x))}break;case 3:h.hasOwnProperty(x[0])||(h[x[0]]=l,p[l]=0,g[l]=numeric.rep([m],0),++l);var w=h[x[0]];for(n=1;n<x.length;n+=2)if(x[n]!==a){var b=f[x[n]];g[w][b]=(s[b]<0?-1:1)*parseFloat(x[n+1])}else p[w]=parseFloat(x[n+1]);break;case 4:for(n=1;n<x.length;n+=2)d[f[x[n]]]=(s[f[x[n]]]<0?-1:1)*parseFloat(x[n+1]);break;case 5:break;case 6:v("Internal error")}}}v("Reached end of file without ENDATA")},numeric.seedrandom={pow:Math.pow,random:Math.random},function(r,e,n,t,i,o,u){function c(r){var e,t,i=this,o=r.length,u=0,c=i.i=i.j=i.m=0;for(i.S=[],i.c=[],o||(r=[o++]);u<n;)i.S[u]=u++;for(u=0;u<n;u++)c=s(c+(e=i.S[u])+r[u%o]),t=i.S[c],i.S[u]=t,i.S[c]=e;i.g=function(r){var e=i.S,t=s(i.i+1),o=e[t],u=s(i.j+o),c=e[u];e[t]=c,e[u]=o;for(var a=e[s(o+c)];--r;)t=s(t+1),c=e[u=s(u+(o=e[t]))],e[t]=c,e[u]=o,a=a*n+e[s(o+c)];return i.i=t,i.j=u,a},i.g(n)}function a(r,e,n,t,i){if(n=[],i=typeof r,e&&"object"==i)for(t in r)if(t.indexOf("S")<5)try{n.push(a(r[t],e-1))}catch(r){}return n.length?n:r+("string"!=i?"\0":"")}function f(r,e,n,t){for(r+="",n=0,t=0;t<r.length;t++)e[s(t)]=s((n^=19*e[s(t)])+r.charCodeAt(t));for(t in r="",e)r+=String.fromCharCode(e[t]);return r}function s(r){return 255&r}e.seedrandom=function(t,s){var m,h=[];return t=f(a(s?[t,r]:arguments.length?t:[(new Date).getTime(),r,window],3),h),f((m=new c(h)).S,r),e.random=function(){for(var r=m.g(6),e=u,t=0;r<i;)r=(r+t)*n,e*=n,t=m.g(1);for(;r>=o;)r/=2,e/=2,t>>>=1;return(r+t)/e},t},u=e.pow(n,6),i=e.pow(2,i),o=2*i,f(e.random(),r)}([],numeric.seedrandom,256,0,52),function(r){function e(r){if("object"!=typeof r)return r;var n,t=[],i=r.length;for(n=0;n<i;n++)t[n+1]=e(r[n]);return t}function n(r){if("object"!=typeof r)return r;var e,t=[],i=r.length;for(e=1;e<i;e++)t[e-1]=n(r[e]);return t}r.solveQP=function(r,t,i,o,u,c){r=e(r),t=e(t),i=e(i);var a,f,s,m,h,l=[],p=[],g=[],d=[],v=[];if(u=u||0,c=c?e(c):[void 0,0],o=o?e(o):[],f=r.length-1,s=i[1].length-1,!o)for(a=1;a<=s;a+=1)o[a]=0;for(a=1;a<=s;a+=1)p[a]=0;for(m=Math.min(f,s),a=1;a<=f;a+=1)g[a]=0;for(l[1]=0,a=1;a<=2*f+m*(m+5)/2+2*s+1;a+=1)d[a]=0;for(a=1;a<=2;a+=1)v[a]=0;return function(r,e,n,t,i,o,u,c,a,f,s,m,h,l,p,g){var d,v,y,x,w,b,_,M,k,T,j,A,S,P,L,E,q,N,V,F,D,O,R,C,U,B,I;S=Math.min(t,f),y=2*t+S*(S+5)/2+2*f+1,C=1e-60;do{U=1+.1*(C+=C),B=1+.2*C}while(U<=1||B<=1);for(d=1;d<=t;d+=1)p[d]=e[d];for(d=t+1;d<=y;d+=1)p[d]=0;for(d=1;d<=f;d+=1)m[d]=0;if(w=[],0===g[1]){if(function(r,e,n,t){var i,o,u,c,a,f;for(o=1;o<=n;o+=1){if(t[1]=o,f=0,(u=o-1)<1){if((f=r[o][o]-f)<=0)break;r[o][o]=Math.sqrt(f)}else{for(c=1;c<=u;c+=1){for(a=r[c][o],i=1;i<c;i+=1)a-=r[i][o]*r[i][c];a/=r[c][c],r[c][o]=a,f+=a*a}if((f=r[o][o]-f)<=0)break;r[o][o]=Math.sqrt(f)}t[1]=0}}(r,0,t,w),0!==w[1])return void(g[1]=2);!function(r,e,n,t){var i,o,u,c;for(o=1;o<=n;o+=1){for(c=0,i=1;i<o;i+=1)c+=r[i][o]*t[i];t[o]=(t[o]-c)/r[o][o]}for(u=1;u<=n;u+=1)for(t[o=n+1-u]=t[o]/r[o][o],c=-t[o],i=1;i<o;i+=1)t[i]=t[i]+c*r[i][o]}(r,0,t,e),function(r,e,n){var t,i,o,u,c;for(o=1;o<=n;o+=1){for(r[o][o]=1/r[o][o],c=-r[o][o],t=1;t<o;t+=1)r[t][o]=c*r[t][o];if(n<(u=o+1))break;for(i=u;i<=n;i+=1)for(c=r[o][i],r[o][i]=0,t=1;t<=o;t+=1)r[t][i]=r[t][i]+c*r[t][o]}}(r,0,t)}else{for(v=1;v<=t;v+=1)for(i[v]=0,d=1;d<=v;d+=1)i[v]=i[v]+r[d][v]*e[d];for(v=1;v<=t;v+=1)for(e[v]=0,d=v;d<=t;d+=1)e[v]=e[v]+r[v][d]*i[d]}for(o[1]=0,v=1;v<=t;v+=1)for(i[v]=e[v],o[1]=o[1]+p[v]*i[v],p[v]=0,d=v+1;d<=t;d+=1)r[d][v]=0;for(o[1]=-o[1]/2,g[1]=0,P=(T=(k=(j=(M=(_=t)+t)+S)+S+1)+S*(S+1)/2)+f,d=1;d<=f;d+=1){for(E=0,v=1;v<=t;v+=1)E+=u[v][d]*u[v][d];p[P+d]=Math.sqrt(E)}function Q(){for(l[1]=l[1]+1,y=T,d=1;d<=f;d+=1){for(y+=1,E=-c[d],v=1;v<=t;v+=1)E+=u[v][d]*i[v];if(Math.abs(E)<C&&(E=0),d>s)p[y]=E;else if(p[y]=-Math.abs(E),E>0){for(v=1;v<=t;v+=1)u[v][d]=-u[v][d];c[d]=-c[d]}}for(d=1;d<=h;d+=1)p[T+m[d]]=0;for(A=0,L=0,d=1;d<=f;d+=1)p[T+d]<L*p[P+d]&&(A=d,L=p[T+d]/p[P+d]);return 0===A?999:0}function W(){for(d=1;d<=t;d+=1){for(E=0,v=1;v<=t;v+=1)E+=r[v][d]*u[v][A];p[d]=E}for(x=_,d=1;d<=t;d+=1)p[x+d]=0;for(v=h+1;v<=t;v+=1)for(d=1;d<=t;d+=1)p[x+d]=p[x+d]+r[d][v]*p[v];for(O=!0,d=h;d>=1;d-=1){for(E=p[d],x=(y=k+d*(d+3)/2)-d,v=d+1;v<=h;v+=1)E-=p[y]*p[M+v],y+=v;if(E/=p[x],p[M+d]=E,m[d]<s)break;if(E<0)break;O=!1,b=d}if(!O)for(q=p[j+b]/p[M+b],d=1;d<=h&&!(m[d]<s)&&!(p[M+d]<0);d+=1)(L=p[j+d]/p[M+d])<q&&(q=L,b=d);for(E=0,d=_+1;d<=_+t;d+=1)E+=p[d]*p[d];if(Math.abs(E)<=C){if(O)return g[1]=1,999;for(d=1;d<=h;d+=1)p[j+d]=p[j+d]-q*p[M+d];return p[j+h+1]=p[j+h+1]+q,700}for(E=0,d=1;d<=t;d+=1)E+=p[_+d]*u[d][A];for(N=-p[T+A]/E,R=!0,O||q<N&&(N=q,R=!1),d=1;d<=t;d+=1)i[d]=i[d]+N*p[_+d],Math.abs(i[d])<C&&(i[d]=0);for(o[1]=o[1]+N*E*(N/2+p[j+h+1]),d=1;d<=h;d+=1)p[j+d]=p[j+d]-N*p[M+d];if(p[j+h+1]=p[j+h+1]+N,!R){for(E=-c[A],v=1;v<=t;v+=1)E+=i[v]*u[v][A];if(A>s)p[T+A]=E;else if(p[T+A]=-Math.abs(E),E>0){for(v=1;v<=t;v+=1)u[v][A]=-u[v][A];c[A]=-c[A]}return 700}for(m[h+=1]=A,y=k+(h-1)*h/2+1,d=1;d<=h-1;d+=1)p[y]=p[d],y+=1;if(h===t)p[y]=p[t];else{for(d=t;d>=h+1&&0!==p[d]&&(V=Math.max(Math.abs(p[d-1]),Math.abs(p[d])),F=Math.min(Math.abs(p[d-1]),Math.abs(p[d])),L=p[d-1]>=0?Math.abs(V*Math.sqrt(1+F*F/(V*V))):-Math.abs(V*Math.sqrt(1+F*F/(V*V))),V=p[d-1]/L,F=p[d]/L,1!==V);d-=1)if(0===V)for(p[d-1]=F*L,v=1;v<=t;v+=1)L=r[v][d-1],r[v][d-1]=r[v][d],r[v][d]=L;else for(p[d-1]=L,D=F/(1+V),v=1;v<=t;v+=1)L=V*r[v][d-1]+F*r[v][d],r[v][d]=D*(r[v][d-1]+L)-r[v][d],r[v][d-1]=L;p[y]=p[h]}return 0}function z(){if(0===p[x=(y=k+b*(b+1)/2+1)+b])return 798;if(V=Math.max(Math.abs(p[x-1]),Math.abs(p[x])),F=Math.min(Math.abs(p[x-1]),Math.abs(p[x])),L=p[x-1]>=0?Math.abs(V*Math.sqrt(1+F*F/(V*V))):-Math.abs(V*Math.sqrt(1+F*F/(V*V))),V=p[x-1]/L,F=p[x]/L,1===V)return 798;if(0===V){for(d=b+1;d<=h;d+=1)L=p[x-1],p[x-1]=p[x],p[x]=L,x+=d;for(d=1;d<=t;d+=1)L=r[d][b],r[d][b]=r[d][b+1],r[d][b+1]=L}else{for(D=F/(1+V),d=b+1;d<=h;d+=1)L=V*p[x-1]+F*p[x],p[x]=D*(p[x-1]+L)-p[x],p[x-1]=L,x+=d;for(d=1;d<=t;d+=1)L=V*r[d][b]+F*r[d][b+1],r[d][b+1]=D*(r[d][b]+L)-r[d][b+1],r[d][b]=L}return 0}function X(){for(x=y-b,d=1;d<=b;d+=1)p[x]=p[y],y+=1,x+=1;return p[j+b]=p[j+b+1],m[b]=m[b+1],(b+=1)<h?797:0}function Y(){return p[j+h]=p[j+h+1],p[j+h+1]=0,m[h]=0,h-=1,l[2]=l[2]+1,0}for(h=0,l[1]=0,l[2]=0,I=0;;){if(999===(I=Q()))return;for(;0!==(I=W());){if(999===I)return;if(700===I)if(b===h)Y();else{for(;z(),797===(I=X()););Y()}}}}(r,t,0,f,g,l,i,o,0,s,u,p,0,v,d,c),h="",1===c[1]&&(h="constraints are inconsistent, no solution!"),2===c[1]&&(h="matrix D in quadratic function is not positive definite!"),{solution:n(g),value:n(l),unconstrained_solution:n(t),iterations:n(v),iact:n(p),message:h}}}(numeric),numeric.svd=function(r){var e,n=numeric.epsilon,t=1e-64/n,i=0,o=0,u=0,c=0,a=0,f=numeric.clone(r),s=f.length,m=f[0].length;if(s<m)throw"Need more rows than columns";var h=new Array(m),l=new Array(m);for(o=0;o<m;o++)h[o]=l[o]=0;var p=numeric.rep([m,m],0);function g(r,e){return(r=Math.abs(r))>(e=Math.abs(e))?r*Math.sqrt(1+e*e/r/r):0==e?r:e*Math.sqrt(1+r*r/e/e)}var d=0,v=0,y=0,x=0,w=0,b=0,_=0;for(o=0;o<m;o++){for(h[o]=v,_=0,a=o+1,u=o;u<s;u++)_+=f[u][o]*f[u][o];if(_<=t)v=0;else for(d=f[o][o],v=Math.sqrt(_),d>=0&&(v=-v),y=d*v-_,f[o][o]=d-v,u=a;u<m;u++){for(_=0,c=o;c<s;c++)_+=f[c][o]*f[c][u];for(d=_/y,c=o;c<s;c++)f[c][u]+=d*f[c][o]}for(l[o]=v,_=0,u=a;u<m;u++)_+=f[o][u]*f[o][u];if(_<=t)v=0;else{for(d=f[o][o+1],v=Math.sqrt(_),d>=0&&(v=-v),y=d*v-_,f[o][o+1]=d-v,u=a;u<m;u++)h[u]=f[o][u]/y;for(u=a;u<s;u++){for(_=0,c=a;c<m;c++)_+=f[u][c]*f[o][c];for(c=a;c<m;c++)f[u][c]+=_*h[c]}}(w=Math.abs(l[o])+Math.abs(h[o]))>x&&(x=w)}for(o=m-1;-1!=o;o+=-1){if(0!=v){for(y=v*f[o][o+1],u=a;u<m;u++)p[u][o]=f[o][u]/y;for(u=a;u<m;u++){for(_=0,c=a;c<m;c++)_+=f[o][c]*p[c][u];for(c=a;c<m;c++)p[c][u]+=_*p[c][o]}}for(u=a;u<m;u++)p[o][u]=0,p[u][o]=0;p[o][o]=1,v=h[o],a=o}for(o=m-1;-1!=o;o+=-1){for(a=o+1,v=l[o],u=a;u<m;u++)f[o][u]=0;if(0!=v){for(y=f[o][o]*v,u=a;u<m;u++){for(_=0,c=a;c<s;c++)_+=f[c][o]*f[c][u];for(d=_/y,c=o;c<s;c++)f[c][u]+=d*f[c][o]}for(u=o;u<s;u++)f[u][o]=f[u][o]/v}else for(u=o;u<s;u++)f[u][o]=0;f[o][o]+=1}for(n*=x,c=m-1;-1!=c;c+=-1)for(var M=0;M<50;M++){var k=!1;for(a=c;-1!=a;a+=-1){if(Math.abs(h[a])<=n){k=!0;break}if(Math.abs(l[a-1])<=n)break}if(!k){i=0,_=1;var T=a-1;for(o=a;o<c+1&&(d=_*h[o],h[o]=i*h[o],!(Math.abs(d)<=n));o++)for(y=g(d,v=l[o]),l[o]=y,i=v/y,_=-d/y,u=0;u<s;u++)w=f[u][T],b=f[u][o],f[u][T]=w*i+b*_,f[u][o]=-w*_+b*i}if(b=l[c],a==c){if(b<0)for(l[c]=-b,u=0;u<m;u++)p[u][c]=-p[u][c];break}if(M>=49)throw"Error: no convergence.";for(x=l[a],v=g(d=(((w=l[c-1])-b)*(w+b)+((v=h[c-1])-(y=h[c]))*(v+y))/(2*y*w),1),d=d<0?((x-b)*(x+b)+y*(w/(d-v)-y))/x:((x-b)*(x+b)+y*(w/(d+v)-y))/x,i=1,_=1,o=a+1;o<c+1;o++){for(v=h[o],w=l[o],y=_*v,v*=i,b=g(d,y),h[o-1]=b,d=x*(i=d/b)+v*(_=y/b),v=-x*_+v*i,y=w*_,w*=i,u=0;u<m;u++)x=p[u][o-1],b=p[u][o],p[u][o-1]=x*i+b*_,p[u][o]=-x*_+b*i;for(b=g(d,y),l[o-1]=b,d=(i=d/b)*v+(_=y/b)*w,x=-_*v+i*w,u=0;u<s;u++)w=f[u][o-1],b=f[u][o],f[u][o-1]=w*i+b*_,f[u][o]=-w*_+b*i}h[a]=0,h[c]=d,l[c]=x}for(o=0;o<l.length;o++)l[o]<n&&(l[o]=0);for(o=0;o<m;o++)for(u=o-1;u>=0;u--)if(l[u]<l[o]){for(i=l[u],l[u]=l[o],l[o]=i,c=0;c<f.length;c++)e=f[c][o],f[c][o]=f[c][u],f[c][u]=e;for(c=0;c<p.length;c++)e=p[c][o],p[c][o]=p[c][u],p[c][u]=e;o=u}return{U:f,S:l,V:p}}},666:r=>{var e=function(r){"use strict";var e,n=Object.prototype,t=n.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function a(r,e,n){return Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),r[e]}try{a({},"")}catch(r){a=function(r,e,n){return r[e]=n}}function f(r,e,n,t){var i=e&&e.prototype instanceof d?e:d,o=Object.create(i.prototype),u=new S(t||[]);return o._invoke=function(r,e,n){var t=m;return function(i,o){if(t===l)throw new Error("Generator is already running");if(t===p){if("throw"===i)throw o;return L()}for(n.method=i,n.arg=o;;){var u=n.delegate;if(u){var c=T(u,n);if(c){if(c===g)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(t===m)throw t=p,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);t=l;var a=s(r,e,n);if("normal"===a.type){if(t=n.done?p:h,a.arg===g)continue;return{value:a.arg,done:n.done}}"throw"===a.type&&(t=p,n.method="throw",n.arg=a.arg)}}}(r,n,u),o}function s(r,e,n){try{return{type:"normal",arg:r.call(e,n)}}catch(r){return{type:"throw",arg:r}}}r.wrap=f;var m="suspendedStart",h="suspendedYield",l="executing",p="completed",g={};function d(){}function v(){}function y(){}var x={};x[o]=function(){return this};var w=Object.getPrototypeOf,b=w&&w(w(P([])));b&&b!==n&&t.call(b,o)&&(x=b);var _=y.prototype=d.prototype=Object.create(x);function M(r){["next","throw","return"].forEach((function(e){a(r,e,(function(r){return this._invoke(e,r)}))}))}function k(r,e){function n(i,o,u,c){var a=s(r[i],r,o);if("throw"!==a.type){var f=a.arg,m=f.value;return m&&"object"==typeof m&&t.call(m,"__await")?e.resolve(m.__await).then((function(r){n("next",r,u,c)}),(function(r){n("throw",r,u,c)})):e.resolve(m).then((function(r){f.value=r,u(f)}),(function(r){return n("throw",r,u,c)}))}c(a.arg)}var i;this._invoke=function(r,t){function o(){return new e((function(e,i){n(r,t,e,i)}))}return i=i?i.then(o,o):o()}}function T(r,n){var t=r.iterator[n.method];if(t===e){if(n.delegate=null,"throw"===n.method){if(r.iterator.return&&(n.method="return",n.arg=e,T(r,n),"throw"===n.method))return g;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return g}var i=s(t,r.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,g;var o=i.arg;return o?o.done?(n[r.resultName]=o.value,n.next=r.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,g):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function j(r){var e={tryLoc:r[0]};1 in r&&(e.catchLoc=r[1]),2 in r&&(e.finallyLoc=r[2],e.afterLoc=r[3]),this.tryEntries.push(e)}function A(r){var e=r.completion||{};e.type="normal",delete e.arg,r.completion=e}function S(r){this.tryEntries=[{tryLoc:"root"}],r.forEach(j,this),this.reset(!0)}function P(r){if(r){var n=r[o];if(n)return n.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var i=-1,u=function n(){for(;++i<r.length;)if(t.call(r,i))return n.value=r[i],n.done=!1,n;return n.value=e,n.done=!0,n};return u.next=u}}return{next:L}}function L(){return{value:e,done:!0}}return v.prototype=_.constructor=y,y.constructor=v,v.displayName=a(y,c,"GeneratorFunction"),r.isGeneratorFunction=function(r){var e="function"==typeof r&&r.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},r.mark=function(r){return Object.setPrototypeOf?Object.setPrototypeOf(r,y):(r.__proto__=y,a(r,c,"GeneratorFunction")),r.prototype=Object.create(_),r},r.awrap=function(r){return{__await:r}},M(k.prototype),k.prototype[u]=function(){return this},r.AsyncIterator=k,r.async=function(e,n,t,i,o){void 0===o&&(o=Promise);var u=new k(f(e,n,t,i),o);return r.isGeneratorFunction(n)?u:u.next().then((function(r){return r.done?r.value:u.next()}))},M(_),a(_,c,"Generator"),_[o]=function(){return this},_.toString=function(){return"[object Generator]"},r.keys=function(r){var e=[];for(var n in r)e.push(n);return e.reverse(),function n(){for(;e.length;){var t=e.pop();if(t in r)return n.value=t,n.done=!1,n}return n.done=!0,n}},r.values=P,S.prototype={constructor:S,reset:function(r){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(A),!r)for(var n in this)"t"===n.charAt(0)&&t.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var r=this.tryEntries[0].completion;if("throw"===r.type)throw r.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function i(t,i){return c.type="throw",c.arg=r,n.next=t,i&&(n.method="next",n.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var u=this.tryEntries[o],c=u.completion;if("root"===u.tryLoc)return i("end");if(u.tryLoc<=this.prev){var a=t.call(u,"catchLoc"),f=t.call(u,"finallyLoc");if(a&&f){if(this.prev<u.catchLoc)return i(u.catchLoc,!0);if(this.prev<u.finallyLoc)return i(u.finallyLoc)}else if(a){if(this.prev<u.catchLoc)return i(u.catchLoc,!0)}else{if(!f)throw new Error("try statement without catch or finally");if(this.prev<u.finallyLoc)return i(u.finallyLoc)}}}},abrupt:function(r,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&t.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===r||"continue"===r)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var u=o?o.completion:{};return u.type=r,u.arg=e,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(u)},complete:function(r,e){if("throw"===r.type)throw r.arg;return"break"===r.type||"continue"===r.type?this.next=r.arg:"return"===r.type?(this.rval=this.arg=r.arg,this.method="return",this.next="end"):"normal"===r.type&&e&&(this.next=e),g},finish:function(r){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===r)return this.complete(n.completion,n.afterLoc),A(n),g}},catch:function(r){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===r){var t=n.completion;if("throw"===t.type){var i=t.arg;A(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(r,n,t){return this.delegate={iterator:P(r),resultName:n,nextLoc:t},"next"===this.method&&(this.arg=e),g}},r}(r.exports);try{regeneratorRuntime=e}catch(r){Function("r","regeneratorRuntime = r")(e)}},477:r=>{"use strict";r.exports=function(r,e,n,t){var i=self||window;try{try{var o;try{o=new i.Blob([r])}catch(e){(o=new(i.BlobBuilder||i.WebKitBlobBuilder||i.MozBlobBuilder||i.MSBlobBuilder)).append(r),o=o.getBlob()}var u=i.URL||i.webkitURL,c=u.createObjectURL(o),a=new i[e](c,n);return u.revokeObjectURL(c),a}catch(t){return new i[e]("data:application/javascript,".concat(encodeURIComponent(r)),n)}}catch(r){if(!t)throw Error("Inline worker is not supported");return new i[e](t,n)}}}},__webpack_module_cache__={};function __webpack_require__(r){var e=__webpack_module_cache__[r];if(void 0!==e)return e.exports;var n=__webpack_module_cache__[r]={exports:{}};return __webpack_modules__[r](n,n.exports,__webpack_require__),n.exports}__webpack_require__.n=r=>{var e=r&&r.__esModule?()=>r.default:()=>r;return __webpack_require__.d(e,{a:e}),e},__webpack_require__.d=(r,e)=>{for(var n in e)__webpack_require__.o(e,n)&&!__webpack_require__.o(r,n)&&Object.defineProperty(r,n,{enumerable:!0,get:e[n]})},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(r){if("object"==typeof window)return window}}(),__webpack_require__.o=(r,e)=>Object.prototype.hasOwnProperty.call(r,e),__webpack_require__.r=r=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})};var __webpack_exports__=__webpack_require__(416);return __webpack_exports__})()}));